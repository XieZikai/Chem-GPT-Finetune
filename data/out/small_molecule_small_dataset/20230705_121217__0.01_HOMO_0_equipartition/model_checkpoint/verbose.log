Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 3 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 3 SMILES are invalid.
Warning: 385 SMILES are invalid.
Total size = 429 | train size = 429 | val size = 42,451 | test size = 429
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.098877
Epoch 1
Loss = 1.1033e+00, PNorm = 34.0560, GNorm = 1.6998, lr_0 = 7.7500e-04
Validation cross_entropy = 1.108043
Epoch 2
Loss = 1.0995e+00, PNorm = 34.0868, GNorm = 1.3829, lr_0 = 9.4019e-04
Validation cross_entropy = 1.066020
Epoch 3
Loss = 1.0569e+00, PNorm = 34.1351, GNorm = 0.4254, lr_0 = 8.3967e-04
Validation cross_entropy = 1.047553
Epoch 4
Loss = 1.0098e+00, PNorm = 34.1943, GNorm = 0.6815, lr_0 = 7.5764e-04
Validation cross_entropy = 0.981107
Epoch 5
Loss = 9.7380e-01, PNorm = 34.2737, GNorm = 3.3055, lr_0 = 6.7664e-04
Validation cross_entropy = 0.971418
Epoch 6
Loss = 9.2800e-01, PNorm = 34.3420, GNorm = 4.7739, lr_0 = 6.1054e-04
Validation cross_entropy = 0.921150
Epoch 7
Validation cross_entropy = 0.928136
Epoch 8
Loss = 8.1193e-01, PNorm = 34.4055, GNorm = 1.2032, lr_0 = 5.4526e-04
Validation cross_entropy = 0.931972
Epoch 9
Loss = 7.9701e-01, PNorm = 34.4648, GNorm = 1.0980, lr_0 = 4.9200e-04
Validation cross_entropy = 0.867686
Epoch 10
Loss = 7.9183e-01, PNorm = 34.5254, GNorm = 3.3478, lr_0 = 4.3940e-04
Validation cross_entropy = 0.865111
Epoch 11
Loss = 7.3827e-01, PNorm = 34.5724, GNorm = 1.0190, lr_0 = 3.9647e-04
Validation cross_entropy = 0.855710
Epoch 12
Loss = 7.7640e-01, PNorm = 34.6194, GNorm = 4.1602, lr_0 = 3.5408e-04
Validation cross_entropy = 0.883271
Epoch 13
Loss = 7.4895e-01, PNorm = 34.6552, GNorm = 2.7232, lr_0 = 3.1950e-04
Validation cross_entropy = 0.866417
Epoch 14
Validation cross_entropy = 0.839584
Epoch 15
Loss = 7.0205e-01, PNorm = 34.6899, GNorm = 0.9734, lr_0 = 2.8534e-04
Validation cross_entropy = 0.842010
Epoch 16
Loss = 7.6276e-01, PNorm = 34.7181, GNorm = 2.0774, lr_0 = 2.5746e-04
Validation cross_entropy = 0.870527
Epoch 17
Loss = 6.6213e-01, PNorm = 34.7478, GNorm = 2.1897, lr_0 = 2.2994e-04
Validation cross_entropy = 0.840250
Epoch 18
Loss = 6.7656e-01, PNorm = 34.7741, GNorm = 2.9036, lr_0 = 2.0747e-04
Validation cross_entropy = 0.850762
Epoch 19
Loss = 6.8300e-01, PNorm = 34.7976, GNorm = 1.9821, lr_0 = 1.8721e-04
Validation cross_entropy = 0.888373
Epoch 20
Loss = 6.7147e-01, PNorm = 34.8189, GNorm = 1.2959, lr_0 = 1.6719e-04
Validation cross_entropy = 0.846700
Epoch 21
Validation cross_entropy = 0.838825
Epoch 22
Loss = 6.1712e-01, PNorm = 34.8406, GNorm = 3.2848, lr_0 = 1.4932e-04
Validation cross_entropy = 0.849622
Epoch 23
Loss = 6.5000e-01, PNorm = 34.8579, GNorm = 3.4646, lr_0 = 1.3473e-04
Validation cross_entropy = 0.856586
Epoch 24
Loss = 6.1163e-01, PNorm = 34.8747, GNorm = 3.6373, lr_0 = 1.2033e-04
Validation cross_entropy = 0.830689
Epoch 25
Loss = 6.1337e-01, PNorm = 34.8883, GNorm = 2.3964, lr_0 = 1.0857e-04
Validation cross_entropy = 0.849471
Epoch 26
Loss = 6.1108e-01, PNorm = 34.9011, GNorm = 2.7960, lr_0 = 1.0000e-04
Validation cross_entropy = 0.840233
Epoch 27
Loss = 5.9761e-01, PNorm = 34.9153, GNorm = 1.6970, lr_0 = 1.0000e-04
Validation cross_entropy = 0.847399
Epoch 28
Validation cross_entropy = 0.825754
Epoch 29
Loss = 6.0329e-01, PNorm = 34.9289, GNorm = 4.4322, lr_0 = 1.0000e-04
Validation cross_entropy = 0.851323
Model 0 best validation cross_entropy = 0.825754 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.588386
Ensemble test cross_entropy = 0.588386
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.588386
Overall test cross_entropy = 0.588386 +/- 0.000000
Elapsed time = 0:15:03
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121217__0.01_HOMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 7 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 7 SMILES are invalid.
Warning: 381 SMILES are invalid.
Total size = 425 | train size = 425 | val size = 42,455 | test size = 425
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.083137
Epoch 1
Loss = 1.0878e+00, PNorm = 34.0558, GNorm = 0.5661, lr_0 = 7.7500e-04
Validation cross_entropy = 1.100919
Epoch 2
Loss = 1.0641e+00, PNorm = 34.0909, GNorm = 1.1471, lr_0 = 9.4019e-04
Validation cross_entropy = 1.055191
Epoch 3
Loss = 1.0538e+00, PNorm = 34.1462, GNorm = 1.9427, lr_0 = 8.3967e-04
Validation cross_entropy = 1.016405
Epoch 4
Loss = 9.8745e-01, PNorm = 34.2080, GNorm = 0.8165, lr_0 = 7.5764e-04
Validation cross_entropy = 0.958022
Epoch 5
Loss = 9.3786e-01, PNorm = 34.2838, GNorm = 1.4153, lr_0 = 6.7664e-04
Validation cross_entropy = 0.913268
Epoch 6
Validation cross_entropy = 0.919963
Epoch 7
Loss = 7.9442e-01, PNorm = 34.3458, GNorm = 2.0290, lr_0 = 6.0430e-04
Validation cross_entropy = 0.931303
Epoch 8
Loss = 8.7543e-01, PNorm = 34.3944, GNorm = 1.8722, lr_0 = 5.4526e-04
Validation cross_entropy = 0.916660
Epoch 9
Loss = 8.3923e-01, PNorm = 34.4420, GNorm = 2.8876, lr_0 = 4.8697e-04
Validation cross_entropy = 0.877827
Epoch 10
Loss = 8.0907e-01, PNorm = 34.4830, GNorm = 1.6771, lr_0 = 4.3940e-04
Validation cross_entropy = 0.912807
Epoch 11
Loss = 7.8708e-01, PNorm = 34.5276, GNorm = 1.1184, lr_0 = 3.9242e-04
Validation cross_entropy = 0.849994
Epoch 12
Loss = 7.7656e-01, PNorm = 34.5654, GNorm = 3.1264, lr_0 = 3.5408e-04
Loss = 5.0589e-01, PNorm = 34.5693, GNorm = 1.0262, lr_0 = 3.5046e-04
Validation cross_entropy = 0.836253
Epoch 13
Validation cross_entropy = 0.836360
Epoch 14
Loss = 8.9108e-01, PNorm = 34.6049, GNorm = 3.6477, lr_0 = 3.1623e-04
Validation cross_entropy = 0.851798
Epoch 15
Loss = 7.0889e-01, PNorm = 34.6418, GNorm = 6.3915, lr_0 = 2.8242e-04
Validation cross_entropy = 0.838264
Epoch 16
Loss = 7.3664e-01, PNorm = 34.6716, GNorm = 1.3828, lr_0 = 2.5483e-04
Validation cross_entropy = 0.815824
Epoch 17
Loss = 7.1360e-01, PNorm = 34.7012, GNorm = 2.4372, lr_0 = 2.2758e-04
Validation cross_entropy = 0.819076
Epoch 18
Loss = 6.9514e-01, PNorm = 34.7285, GNorm = 1.0011, lr_0 = 2.0535e-04
Validation cross_entropy = 0.807520
Epoch 19
Loss = 6.6618e-01, PNorm = 34.7546, GNorm = 1.6567, lr_0 = 1.8340e-04
Validation cross_entropy = 0.814457
Epoch 20
Validation cross_entropy = 0.819073
Epoch 21
Loss = 6.9866e-01, PNorm = 34.7785, GNorm = 6.5622, lr_0 = 1.6379e-04
Validation cross_entropy = 0.816868
Epoch 22
Loss = 6.1095e-01, PNorm = 34.7972, GNorm = 1.3065, lr_0 = 1.4779e-04
Validation cross_entropy = 0.807761
Epoch 23
Loss = 6.8227e-01, PNorm = 34.8160, GNorm = 2.2545, lr_0 = 1.3199e-04
Validation cross_entropy = 0.810504
Epoch 24
Loss = 6.1991e-01, PNorm = 34.8320, GNorm = 1.3863, lr_0 = 1.1909e-04
Validation cross_entropy = 0.807529
Epoch 25
Loss = 6.3197e-01, PNorm = 34.8481, GNorm = 2.0443, lr_0 = 1.0636e-04
Validation cross_entropy = 0.825028
Epoch 26
Validation cross_entropy = 0.869428
Epoch 27
Loss = 6.8582e-01, PNorm = 34.8615, GNorm = 7.3049, lr_0 = 1.0000e-04
Validation cross_entropy = 0.797710
Epoch 28
Loss = 5.9794e-01, PNorm = 34.8726, GNorm = 1.9983, lr_0 = 1.0000e-04
Validation cross_entropy = 0.798284
Epoch 29
Loss = 6.2682e-01, PNorm = 34.8848, GNorm = 3.8935, lr_0 = 1.0000e-04
Validation cross_entropy = 0.806197
Model 0 best validation cross_entropy = 0.797710 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.612125
Ensemble test cross_entropy = 0.612125
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.612125
Overall test cross_entropy = 0.612125 +/- 0.000000
Elapsed time = 0:13:44
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.01_HOMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.01_HOMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.01_HOMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.01_HOMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 2 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 2 SMILES are invalid.
Warning: 386 SMILES are invalid.
Total size = 430 | train size = 430 | val size = 42,450 | test size = 430
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.144582
Epoch 1
Loss = 1.1319e+00, PNorm = 34.0569, GNorm = 1.8047, lr_0 = 7.7500e-04
Validation cross_entropy = 1.053909
Epoch 2
Loss = 1.0270e+00, PNorm = 34.0932, GNorm = 0.8943, lr_0 = 9.4019e-04
Validation cross_entropy = 1.036413
Epoch 3
Loss = 1.0166e+00, PNorm = 34.1526, GNorm = 0.3626, lr_0 = 8.3967e-04
Validation cross_entropy = 0.988544
Epoch 4
Loss = 9.7699e-01, PNorm = 34.2181, GNorm = 2.4480, lr_0 = 7.5764e-04
Validation cross_entropy = 0.959485
Epoch 5
Loss = 9.1844e-01, PNorm = 34.2825, GNorm = 0.8628, lr_0 = 6.8363e-04
Validation cross_entropy = 0.968585
Epoch 6
Loss = 8.9493e-01, PNorm = 34.3433, GNorm = 1.0878, lr_0 = 6.1054e-04
Validation cross_entropy = 0.904348
Epoch 7
Validation cross_entropy = 0.917515
Epoch 8
Loss = 8.1854e-01, PNorm = 34.4007, GNorm = 1.5893, lr_0 = 5.4526e-04
Validation cross_entropy = 0.964278
Epoch 9
Loss = 9.1507e-01, PNorm = 34.4506, GNorm = 5.3534, lr_0 = 4.9200e-04
Validation cross_entropy = 0.890772
Epoch 10
Loss = 8.6681e-01, PNorm = 34.4980, GNorm = 1.4688, lr_0 = 4.4394e-04
Validation cross_entropy = 0.889198
Epoch 11
Loss = 8.3721e-01, PNorm = 34.5431, GNorm = 0.5848, lr_0 = 3.9647e-04
Validation cross_entropy = 0.882437
Epoch 12
Loss = 7.7600e-01, PNorm = 34.5860, GNorm = 1.4548, lr_0 = 3.5774e-04
Validation cross_entropy = 0.861052
Epoch 13
Loss = 7.6808e-01, PNorm = 34.6324, GNorm = 0.9526, lr_0 = 3.1950e-04
Validation cross_entropy = 0.855577
Epoch 14
Validation cross_entropy = 0.857072
Epoch 15
Loss = 6.6508e-01, PNorm = 34.6736, GNorm = 2.0474, lr_0 = 2.8828e-04
Validation cross_entropy = 0.867058
Epoch 16
Loss = 7.1985e-01, PNorm = 34.7118, GNorm = 3.4315, lr_0 = 2.5746e-04
Validation cross_entropy = 0.840155
Epoch 17
Loss = 7.1821e-01, PNorm = 34.7433, GNorm = 1.7591, lr_0 = 2.3231e-04
Validation cross_entropy = 0.855677
Epoch 18
Loss = 6.4885e-01, PNorm = 34.7738, GNorm = 1.0824, lr_0 = 2.0747e-04
Validation cross_entropy = 0.835000
Epoch 19
Loss = 7.0573e-01, PNorm = 34.7992, GNorm = 5.3189, lr_0 = 1.8721e-04
Validation cross_entropy = 0.864219
Epoch 20
Loss = 7.0172e-01, PNorm = 34.8207, GNorm = 0.9565, lr_0 = 1.6892e-04
Loss = 7.1900e-01, PNorm = 34.8226, GNorm = 3.6304, lr_0 = 1.6719e-04
Validation cross_entropy = 0.845322
Epoch 21
Validation cross_entropy = 0.834082
Epoch 22
Loss = 6.6193e-01, PNorm = 34.8423, GNorm = 2.0767, lr_0 = 1.5086e-04
Validation cross_entropy = 0.835880
Epoch 23
Loss = 6.4364e-01, PNorm = 34.8623, GNorm = 2.6718, lr_0 = 1.3473e-04
Validation cross_entropy = 0.824565
Epoch 24
Loss = 6.0157e-01, PNorm = 34.8789, GNorm = 4.9892, lr_0 = 1.2157e-04
Validation cross_entropy = 0.837716
Epoch 25
Loss = 6.4132e-01, PNorm = 34.8934, GNorm = 1.3732, lr_0 = 1.0969e-04
Validation cross_entropy = 0.821782
Epoch 26
Loss = 6.4050e-01, PNorm = 34.9072, GNorm = 3.6292, lr_0 = 1.0000e-04
Validation cross_entropy = 0.821322
Epoch 27
Loss = 6.3764e-01, PNorm = 34.9204, GNorm = 2.5180, lr_0 = 1.0000e-04
Loss = 5.6682e-01, PNorm = 34.9216, GNorm = 2.4410, lr_0 = 1.0000e-04
Validation cross_entropy = 0.827278
Epoch 28
Validation cross_entropy = 0.823243
Epoch 29
Loss = 6.7367e-01, PNorm = 34.9333, GNorm = 4.0157, lr_0 = 1.0000e-04
Validation cross_entropy = 0.826562
Model 0 best validation cross_entropy = 0.821322 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.624597
Ensemble test cross_entropy = 0.624597
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.624597
Overall test cross_entropy = 0.624597 +/- 0.000000
Elapsed time = 0:14:04
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 5 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 5 SMILES are invalid.
Warning: 383 SMILES are invalid.
Total size = 860 | train size = 860 | val size = 42,020 | test size = 860
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1033e+00, PNorm = 34.0527, GNorm = 1.3345, lr_0 = 3.9118e-04
Validation cross_entropy = 1.058608
Epoch 1
Loss = 1.0505e+00, PNorm = 34.0664, GNorm = 1.0823, lr_0 = 6.8235e-04
Loss = 1.0426e+00, PNorm = 34.1008, GNorm = 1.8262, lr_0 = 9.4706e-04
Validation cross_entropy = 1.091169
Epoch 2
Loss = 1.0433e+00, PNorm = 34.1610, GNorm = 0.5121, lr_0 = 9.5740e-04
Loss = 1.0553e+00, PNorm = 34.2216, GNorm = 2.0083, lr_0 = 9.1219e-04
Validation cross_entropy = 0.994927
Epoch 3
Loss = 9.6525e-01, PNorm = 34.2931, GNorm = 0.7823, lr_0 = 8.6492e-04
Validation cross_entropy = 0.929628
Epoch 4
Loss = 9.2594e-01, PNorm = 34.3766, GNorm = 0.8074, lr_0 = 8.2010e-04
Loss = 9.2219e-01, PNorm = 34.4476, GNorm = 1.6398, lr_0 = 7.8137e-04
Validation cross_entropy = 0.887880
Epoch 5
Loss = 8.0509e-01, PNorm = 34.5025, GNorm = 1.7026, lr_0 = 7.4447e-04
Loss = 8.5928e-01, PNorm = 34.5636, GNorm = 0.9808, lr_0 = 7.0932e-04
Validation cross_entropy = 0.850051
Epoch 6
Loss = 7.8227e-01, PNorm = 34.6351, GNorm = 0.8212, lr_0 = 6.7256e-04
Loss = 7.9123e-01, PNorm = 34.6998, GNorm = 0.8840, lr_0 = 6.4080e-04
Loss = 7.2908e-01, PNorm = 34.7052, GNorm = 1.8827, lr_0 = 6.3771e-04
Validation cross_entropy = 0.945550
Epoch 7
Loss = 8.1445e-01, PNorm = 34.7579, GNorm = 2.0206, lr_0 = 6.0759e-04
Validation cross_entropy = 0.824231
Epoch 8
Loss = 7.7228e-01, PNorm = 34.8165, GNorm = 3.0709, lr_0 = 5.7611e-04
Loss = 7.0492e-01, PNorm = 34.8754, GNorm = 0.8807, lr_0 = 5.4890e-04
Validation cross_entropy = 0.817711
Epoch 9
Loss = 6.8636e-01, PNorm = 34.9319, GNorm = 1.1519, lr_0 = 5.2046e-04
Loss = 7.1027e-01, PNorm = 34.9801, GNorm = 3.8097, lr_0 = 4.9588e-04
Validation cross_entropy = 0.814887
Epoch 10
Loss = 6.5017e-01, PNorm = 35.0256, GNorm = 1.0851, lr_0 = 4.7247e-04
Validation cross_entropy = 0.793725
Epoch 11
Loss = 6.2301e-01, PNorm = 35.0708, GNorm = 2.9510, lr_0 = 4.4798e-04
Loss = 7.3873e-01, PNorm = 35.0987, GNorm = 0.9304, lr_0 = 4.2683e-04
Validation cross_entropy = 0.924711
Epoch 12
Loss = 7.5069e-01, PNorm = 35.1348, GNorm = 0.9317, lr_0 = 4.0471e-04
Loss = 6.6558e-01, PNorm = 35.1704, GNorm = 2.7671, lr_0 = 3.8560e-04
Validation cross_entropy = 0.768759
Epoch 13
Loss = 6.3565e-01, PNorm = 35.2097, GNorm = 2.3243, lr_0 = 3.6562e-04
Loss = 6.2743e-01, PNorm = 35.2484, GNorm = 2.5435, lr_0 = 3.4835e-04
Loss = 6.3212e-01, PNorm = 35.2511, GNorm = 2.3923, lr_0 = 3.4667e-04
Validation cross_entropy = 0.777144
Epoch 14
Loss = 6.1245e-01, PNorm = 35.2817, GNorm = 1.9226, lr_0 = 3.3030e-04
Validation cross_entropy = 0.767732
Epoch 15
Loss = 5.8690e-01, PNorm = 35.3081, GNorm = 5.8257, lr_0 = 3.1470e-04
Loss = 5.8152e-01, PNorm = 35.3350, GNorm = 1.1477, lr_0 = 2.9984e-04
Validation cross_entropy = 0.755092
Epoch 16
Loss = 5.7900e-01, PNorm = 35.3648, GNorm = 3.5272, lr_0 = 2.8430e-04
Loss = 5.7173e-01, PNorm = 35.3887, GNorm = 3.8222, lr_0 = 2.7088e-04
Validation cross_entropy = 0.746745
Epoch 17
Loss = 5.2352e-01, PNorm = 35.4176, GNorm = 1.2813, lr_0 = 2.5684e-04
Validation cross_entropy = 0.743195
Epoch 18
Loss = 5.3559e-01, PNorm = 35.4430, GNorm = 1.5283, lr_0 = 2.4353e-04
Loss = 5.5691e-01, PNorm = 35.4647, GNorm = 1.0541, lr_0 = 2.3203e-04
Validation cross_entropy = 0.744548
Epoch 19
Loss = 4.8939e-01, PNorm = 35.4880, GNorm = 4.0159, lr_0 = 2.2001e-04
Loss = 5.6027e-01, PNorm = 35.5098, GNorm = 2.9558, lr_0 = 2.0962e-04
Validation cross_entropy = 0.743770
Epoch 20
Loss = 4.8085e-01, PNorm = 35.5298, GNorm = 2.5787, lr_0 = 1.9972e-04
Loss = 5.6158e-01, PNorm = 35.5476, GNorm = 4.5557, lr_0 = 1.9029e-04
Validation cross_entropy = 0.764401
Epoch 21
Loss = 5.3554e-01, PNorm = 35.5677, GNorm = 1.8764, lr_0 = 1.8043e-04
Validation cross_entropy = 0.761074
Epoch 22
Loss = 5.1860e-01, PNorm = 35.5846, GNorm = 1.1519, lr_0 = 1.7108e-04
Loss = 4.9610e-01, PNorm = 35.5993, GNorm = 3.7750, lr_0 = 1.6300e-04
Validation cross_entropy = 0.754197
Epoch 23
Loss = 4.6828e-01, PNorm = 35.6164, GNorm = 2.3408, lr_0 = 1.5455e-04
Loss = 5.2078e-01, PNorm = 35.6308, GNorm = 1.3130, lr_0 = 1.4725e-04
Validation cross_entropy = 0.737301
Epoch 24
Loss = 5.0055e-01, PNorm = 35.6455, GNorm = 2.5811, lr_0 = 1.3962e-04
Loss = 4.9366e-01, PNorm = 35.6588, GNorm = 9.4425, lr_0 = 1.3303e-04
Validation cross_entropy = 0.743335
Epoch 25
Loss = 4.9884e-01, PNorm = 35.6709, GNorm = 3.0387, lr_0 = 1.2675e-04
Validation cross_entropy = 0.758257
Epoch 26
Loss = 4.2411e-01, PNorm = 35.6828, GNorm = 2.8779, lr_0 = 1.2018e-04
Loss = 5.3385e-01, PNorm = 35.6925, GNorm = 7.7685, lr_0 = 1.1450e-04
Validation cross_entropy = 0.760629
Epoch 27
Loss = 4.8253e-01, PNorm = 35.7033, GNorm = 2.2424, lr_0 = 1.0857e-04
Loss = 4.7110e-01, PNorm = 35.7132, GNorm = 2.2972, lr_0 = 1.0344e-04
Validation cross_entropy = 0.779149
Epoch 28
Loss = 4.9736e-01, PNorm = 35.7244, GNorm = 5.1293, lr_0 = 1.0000e-04
Validation cross_entropy = 0.759281
Epoch 29
Loss = 4.9302e-01, PNorm = 35.7341, GNorm = 4.0105, lr_0 = 1.0000e-04
Loss = 4.7427e-01, PNorm = 35.7428, GNorm = 5.9005, lr_0 = 1.0000e-04
Validation cross_entropy = 0.751321
Model 0 best validation cross_entropy = 0.737301 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.486172
Ensemble test cross_entropy = 0.486172
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.486172
Overall test cross_entropy = 0.486172 +/- 0.000000
Elapsed time = 0:13:56
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 8 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 8 SMILES are invalid.
Warning: 380 SMILES are invalid.
Total size = 857 | train size = 857 | val size = 42,023 | test size = 857
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1395e+00, PNorm = 34.0520, GNorm = 2.6105, lr_0 = 3.9118e-04
Validation cross_entropy = 1.078348
Epoch 1
Loss = 1.0792e+00, PNorm = 34.0618, GNorm = 1.1306, lr_0 = 6.8235e-04
Loss = 1.0629e+00, PNorm = 34.0920, GNorm = 2.1029, lr_0 = 9.4706e-04
Validation cross_entropy = 1.026671
Epoch 2
Loss = 1.0058e+00, PNorm = 34.1554, GNorm = 1.6722, lr_0 = 9.5740e-04
Loss = 9.3853e-01, PNorm = 34.2353, GNorm = 2.2071, lr_0 = 9.1219e-04
Validation cross_entropy = 0.921630
Epoch 3
Loss = 8.9184e-01, PNorm = 34.3149, GNorm = 3.6779, lr_0 = 8.6492e-04
Validation cross_entropy = 0.910449
Epoch 4
Loss = 8.8126e-01, PNorm = 34.3810, GNorm = 2.4516, lr_0 = 8.2010e-04
Loss = 8.6859e-01, PNorm = 34.4308, GNorm = 1.2615, lr_0 = 7.8137e-04
Validation cross_entropy = 1.003954
Epoch 5
Loss = 9.2884e-01, PNorm = 34.4848, GNorm = 4.3017, lr_0 = 7.4088e-04
Loss = 8.6120e-01, PNorm = 34.5289, GNorm = 0.6345, lr_0 = 7.0589e-04
Validation cross_entropy = 0.876902
Epoch 6
Loss = 8.5105e-01, PNorm = 34.5809, GNorm = 2.1020, lr_0 = 6.6931e-04
Validation cross_entropy = 0.838572
Epoch 7
Loss = 7.4629e-01, PNorm = 34.6302, GNorm = 0.9595, lr_0 = 6.3463e-04
Loss = 8.0000e-01, PNorm = 34.6697, GNorm = 1.1170, lr_0 = 6.0466e-04
Validation cross_entropy = 0.838221
Epoch 8
Loss = 8.2689e-01, PNorm = 34.7044, GNorm = 2.5240, lr_0 = 5.7611e-04
Loss = 7.3581e-01, PNorm = 34.7442, GNorm = 1.1619, lr_0 = 5.4890e-04
Validation cross_entropy = 0.809542
Epoch 9
Loss = 7.3205e-01, PNorm = 34.7934, GNorm = 1.1630, lr_0 = 5.2046e-04
Loss = 7.1115e-01, PNorm = 34.8350, GNorm = 1.2470, lr_0 = 4.9588e-04
Validation cross_entropy = 0.826156
Epoch 10
Loss = 7.0311e-01, PNorm = 34.8760, GNorm = 1.7699, lr_0 = 4.7019e-04
Validation cross_entropy = 0.837064
Epoch 11
Loss = 7.0008e-01, PNorm = 34.9195, GNorm = 2.0076, lr_0 = 4.4582e-04
Loss = 7.1607e-01, PNorm = 34.9537, GNorm = 1.1370, lr_0 = 4.2477e-04
Validation cross_entropy = 0.804518
Epoch 12
Loss = 6.8086e-01, PNorm = 34.9966, GNorm = 2.3238, lr_0 = 4.0276e-04
Loss = 6.4881e-01, PNorm = 35.0347, GNorm = 2.3766, lr_0 = 3.8374e-04
Validation cross_entropy = 0.774299
Epoch 13
Loss = 5.9737e-01, PNorm = 35.0687, GNorm = 0.8883, lr_0 = 3.6385e-04
Validation cross_entropy = 0.819791
Epoch 14
Loss = 5.8539e-01, PNorm = 35.1039, GNorm = 1.8803, lr_0 = 3.4500e-04
Loss = 6.7723e-01, PNorm = 35.1361, GNorm = 4.2198, lr_0 = 3.2871e-04
Validation cross_entropy = 0.773313
Epoch 15
Loss = 6.3759e-01, PNorm = 35.1630, GNorm = 6.1740, lr_0 = 3.1318e-04
Loss = 6.7090e-01, PNorm = 35.1875, GNorm = 1.6040, lr_0 = 2.9839e-04
Validation cross_entropy = 0.773336
Epoch 16
Loss = 6.2672e-01, PNorm = 35.2177, GNorm = 3.4077, lr_0 = 2.8293e-04
Loss = 6.0320e-01, PNorm = 35.2427, GNorm = 1.0326, lr_0 = 2.6957e-04
Validation cross_entropy = 0.759893
Epoch 17
Loss = 6.0467e-01, PNorm = 35.2702, GNorm = 1.4340, lr_0 = 2.5560e-04
Validation cross_entropy = 0.777558
Epoch 18
Loss = 4.8207e-01, PNorm = 35.2980, GNorm = 4.3624, lr_0 = 2.4236e-04
Loss = 6.0022e-01, PNorm = 35.3212, GNorm = 2.7669, lr_0 = 2.3091e-04
Validation cross_entropy = 0.759316
Epoch 19
Loss = 5.3874e-01, PNorm = 35.3443, GNorm = 2.3081, lr_0 = 2.1895e-04
Loss = 5.9715e-01, PNorm = 35.3622, GNorm = 1.8631, lr_0 = 2.0861e-04
Validation cross_entropy = 0.753693
Epoch 20
Loss = 5.6347e-01, PNorm = 35.3830, GNorm = 2.7070, lr_0 = 1.9780e-04
Validation cross_entropy = 0.809176
Epoch 21
Loss = 5.8422e-01, PNorm = 35.4015, GNorm = 4.5656, lr_0 = 1.8755e-04
Loss = 5.3026e-01, PNorm = 35.4169, GNorm = 2.2173, lr_0 = 1.7869e-04
Validation cross_entropy = 0.760779
Epoch 22
Loss = 5.3174e-01, PNorm = 35.4333, GNorm = 1.9934, lr_0 = 1.7025e-04
Loss = 5.1392e-01, PNorm = 35.4478, GNorm = 2.9646, lr_0 = 1.6221e-04
Validation cross_entropy = 0.747800
Epoch 23
Loss = 5.0753e-01, PNorm = 35.4639, GNorm = 4.6181, lr_0 = 1.5381e-04
Loss = 5.3303e-01, PNorm = 35.4791, GNorm = 3.4255, lr_0 = 1.4654e-04
Validation cross_entropy = 0.751482
Epoch 24
Loss = 5.5404e-01, PNorm = 35.4940, GNorm = 2.1772, lr_0 = 1.3895e-04
Validation cross_entropy = 0.751311
Epoch 25
Loss = 5.0756e-01, PNorm = 35.5090, GNorm = 1.2876, lr_0 = 1.3175e-04
Loss = 4.9040e-01, PNorm = 35.5221, GNorm = 1.6915, lr_0 = 1.2553e-04
Validation cross_entropy = 0.756352
Epoch 26
Loss = 5.0768e-01, PNorm = 35.5352, GNorm = 5.3324, lr_0 = 1.1902e-04
Loss = 5.1440e-01, PNorm = 35.5462, GNorm = 2.6139, lr_0 = 1.1340e-04
Validation cross_entropy = 0.759564
Epoch 27
Loss = 5.0740e-01, PNorm = 35.5584, GNorm = 5.8265, lr_0 = 1.0753e-04
Validation cross_entropy = 0.753471
Epoch 28
Loss = 4.9845e-01, PNorm = 35.5688, GNorm = 1.3811, lr_0 = 1.0195e-04
Loss = 4.8320e-01, PNorm = 35.5791, GNorm = 3.2526, lr_0 = 1.0000e-04
Validation cross_entropy = 0.761098
Epoch 29
Loss = 5.4312e-01, PNorm = 35.5886, GNorm = 3.1875, lr_0 = 1.0000e-04
Loss = 4.7443e-01, PNorm = 35.5981, GNorm = 2.5774, lr_0 = 1.0000e-04
Validation cross_entropy = 0.764764
Model 0 best validation cross_entropy = 0.747800 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.518487
Ensemble test cross_entropy = 0.518487
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.518487
Overall test cross_entropy = 0.518487 +/- 0.000000
Elapsed time = 0:14:12
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121218__0.02_HOMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 7 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 7 SMILES are invalid.
Warning: 381 SMILES are invalid.
Total size = 858 | train size = 858 | val size = 42,022 | test size = 858
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1017e+00, PNorm = 34.0532, GNorm = 1.3320, lr_0 = 3.9118e-04
Validation cross_entropy = 1.058461
Epoch 1
Loss = 1.0674e+00, PNorm = 34.0654, GNorm = 1.1439, lr_0 = 6.8235e-04
Loss = 1.0502e+00, PNorm = 34.0983, GNorm = 0.6540, lr_0 = 9.4706e-04
Validation cross_entropy = 0.995603
Epoch 2
Loss = 9.6793e-01, PNorm = 34.1679, GNorm = 1.2845, lr_0 = 9.5740e-04
Loss = 1.0258e+00, PNorm = 34.2256, GNorm = 1.5749, lr_0 = 9.1219e-04
Validation cross_entropy = 1.042364
Epoch 3
Loss = 9.9123e-01, PNorm = 34.2821, GNorm = 1.3708, lr_0 = 8.6492e-04
Validation cross_entropy = 0.920284
Epoch 4
Loss = 9.4592e-01, PNorm = 34.3451, GNorm = 1.4798, lr_0 = 8.2010e-04
Loss = 8.9884e-01, PNorm = 34.4067, GNorm = 1.1382, lr_0 = 7.8137e-04
Validation cross_entropy = 0.918151
Epoch 5
Loss = 8.7890e-01, PNorm = 34.4626, GNorm = 1.4501, lr_0 = 7.4088e-04
Loss = 8.5204e-01, PNorm = 34.5108, GNorm = 1.3455, lr_0 = 7.0589e-04
Validation cross_entropy = 0.838977
Epoch 6
Loss = 8.2720e-01, PNorm = 34.5655, GNorm = 0.6910, lr_0 = 6.6931e-04
Loss = 8.1965e-01, PNorm = 34.6126, GNorm = 1.2902, lr_0 = 6.3771e-04
Validation cross_entropy = 0.820402
Epoch 7
Loss = 7.8633e-01, PNorm = 34.6599, GNorm = 3.3875, lr_0 = 6.0759e-04
Validation cross_entropy = 0.793688
Epoch 8
Loss = 7.3707e-01, PNorm = 34.7064, GNorm = 2.1334, lr_0 = 5.7611e-04
Loss = 7.5634e-01, PNorm = 34.7523, GNorm = 3.6127, lr_0 = 5.4890e-04
Validation cross_entropy = 0.790256
Epoch 9
Loss = 7.6613e-01, PNorm = 34.7957, GNorm = 6.6229, lr_0 = 5.2046e-04
Loss = 7.4572e-01, PNorm = 34.8359, GNorm = 6.4584, lr_0 = 4.9588e-04
Validation cross_entropy = 0.816915
Epoch 10
Loss = 7.7026e-01, PNorm = 34.8776, GNorm = 4.0847, lr_0 = 4.7019e-04
Validation cross_entropy = 0.787425
Epoch 11
Loss = 6.5672e-01, PNorm = 34.9167, GNorm = 1.3180, lr_0 = 4.4582e-04
Loss = 7.6595e-01, PNorm = 34.9480, GNorm = 1.4890, lr_0 = 4.2477e-04
Validation cross_entropy = 0.772087
Epoch 12
Loss = 6.4819e-01, PNorm = 34.9848, GNorm = 2.4005, lr_0 = 4.0276e-04
Loss = 6.7016e-01, PNorm = 35.0191, GNorm = 2.4153, lr_0 = 3.8374e-04
Validation cross_entropy = 0.820548
Epoch 13
Loss = 7.9127e-01, PNorm = 35.0492, GNorm = 10.2685, lr_0 = 3.6562e-04
Loss = 6.8661e-01, PNorm = 35.0763, GNorm = 1.6933, lr_0 = 3.4835e-04
Loss = 4.8536e-01, PNorm = 35.0792, GNorm = 2.0897, lr_0 = 3.4667e-04
Validation cross_entropy = 0.849674
Epoch 14
Loss = 6.9719e-01, PNorm = 35.1076, GNorm = 1.5006, lr_0 = 3.3030e-04
Validation cross_entropy = 0.764216
Epoch 15
Loss = 6.6799e-01, PNorm = 35.1399, GNorm = 4.4132, lr_0 = 3.1318e-04
Loss = 6.5415e-01, PNorm = 35.1666, GNorm = 4.0743, lr_0 = 2.9839e-04
Validation cross_entropy = 0.745156
Epoch 16
Loss = 6.2971e-01, PNorm = 35.1895, GNorm = 1.2985, lr_0 = 2.8293e-04
Loss = 6.3292e-01, PNorm = 35.2124, GNorm = 2.0139, lr_0 = 2.6957e-04
Validation cross_entropy = 0.737796
Epoch 17
Loss = 6.1928e-01, PNorm = 35.2379, GNorm = 2.8052, lr_0 = 2.5560e-04
Validation cross_entropy = 0.744137
Epoch 18
Loss = 6.0196e-01, PNorm = 35.2610, GNorm = 1.7415, lr_0 = 2.4236e-04
Loss = 6.0512e-01, PNorm = 35.2811, GNorm = 2.3725, lr_0 = 2.3091e-04
Validation cross_entropy = 0.752093
Epoch 19
Loss = 5.8932e-01, PNorm = 35.3020, GNorm = 3.5519, lr_0 = 2.2001e-04
Loss = 5.9594e-01, PNorm = 35.3217, GNorm = 1.4398, lr_0 = 2.0962e-04
Validation cross_entropy = 0.798114
Epoch 20
Loss = 5.7135e-01, PNorm = 35.3437, GNorm = 1.4460, lr_0 = 1.9876e-04
Loss = 6.5801e-01, PNorm = 35.3605, GNorm = 1.9322, lr_0 = 1.8937e-04
Loss = 7.2671e-01, PNorm = 35.3622, GNorm = 3.9461, lr_0 = 1.8846e-04
Validation cross_entropy = 0.738117
Epoch 21
Loss = 6.0736e-01, PNorm = 35.3783, GNorm = 3.5482, lr_0 = 1.7956e-04
Validation cross_entropy = 0.740700
Epoch 22
Loss = 5.4749e-01, PNorm = 35.3950, GNorm = 2.4308, lr_0 = 1.7025e-04
Loss = 5.6855e-01, PNorm = 35.4117, GNorm = 2.1236, lr_0 = 1.6221e-04
Validation cross_entropy = 0.748432
Epoch 23
Loss = 5.3219e-01, PNorm = 35.4280, GNorm = 1.2242, lr_0 = 1.5381e-04
Loss = 5.9833e-01, PNorm = 35.4411, GNorm = 4.3563, lr_0 = 1.4654e-04
Validation cross_entropy = 0.742622
Epoch 24
Loss = 5.5765e-01, PNorm = 35.4561, GNorm = 1.5105, lr_0 = 1.3895e-04
Validation cross_entropy = 0.739485
Epoch 25
Loss = 4.7405e-01, PNorm = 35.4681, GNorm = 3.0778, lr_0 = 1.3239e-04
Loss = 5.6587e-01, PNorm = 35.4807, GNorm = 3.9886, lr_0 = 1.2614e-04
Validation cross_entropy = 0.746710
Epoch 26
Loss = 4.8806e-01, PNorm = 35.4941, GNorm = 1.1440, lr_0 = 1.1960e-04
Loss = 5.3040e-01, PNorm = 35.5061, GNorm = 3.7550, lr_0 = 1.1395e-04
Validation cross_entropy = 0.746017
Epoch 27
Loss = 5.6091e-01, PNorm = 35.5177, GNorm = 4.5739, lr_0 = 1.0805e-04
Loss = 5.1115e-01, PNorm = 35.5285, GNorm = 1.5873, lr_0 = 1.0294e-04
Loss = 8.5987e-01, PNorm = 35.5294, GNorm = 12.7383, lr_0 = 1.0245e-04
Validation cross_entropy = 0.748301
Epoch 28
Loss = 5.1299e-01, PNorm = 35.5389, GNorm = 2.9014, lr_0 = 1.0000e-04
Validation cross_entropy = 0.747796
Epoch 29
Loss = 5.4377e-01, PNorm = 35.5500, GNorm = 8.0805, lr_0 = 1.0000e-04
Loss = 5.4912e-01, PNorm = 35.5597, GNorm = 3.9418, lr_0 = 1.0000e-04
Validation cross_entropy = 0.742158
Model 0 best validation cross_entropy = 0.737796 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.605962
Ensemble test cross_entropy = 0.605962
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.605962
Overall test cross_entropy = 0.605962 +/- 0.000000
Elapsed time = 0:14:14
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 40 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 40 SMILES are invalid.
Warning: 348 SMILES are invalid.
Total size = 4,286 | train size = 4,286 | val size = 38,594 | test size = 4,286
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1146e+00, PNorm = 34.0521, GNorm = 1.5403, lr_0 = 1.5824e-04
Loss = 1.0990e+00, PNorm = 34.0527, GNorm = 1.5973, lr_0 = 2.1118e-04
Loss = 1.0719e+00, PNorm = 34.0567, GNorm = 0.4783, lr_0 = 2.6412e-04
Loss = 1.0540e+00, PNorm = 34.0642, GNorm = 1.0162, lr_0 = 3.1706e-04
Loss = 1.0489e+00, PNorm = 34.0766, GNorm = 1.6071, lr_0 = 3.7000e-04
Loss = 1.0229e+00, PNorm = 34.0970, GNorm = 2.0000, lr_0 = 4.2294e-04
Loss = 1.0060e+00, PNorm = 34.1214, GNorm = 1.1595, lr_0 = 4.7588e-04
Loss = 9.8972e-01, PNorm = 34.1550, GNorm = 1.0872, lr_0 = 5.2882e-04
Validation cross_entropy = 0.926790
Epoch 1
Loss = 9.0655e-01, PNorm = 34.2051, GNorm = 1.9977, lr_0 = 5.8706e-04
Loss = 9.3582e-01, PNorm = 34.2497, GNorm = 2.9004, lr_0 = 6.4000e-04
Loss = 8.8672e-01, PNorm = 34.2976, GNorm = 2.0256, lr_0 = 6.9294e-04
Loss = 8.6097e-01, PNorm = 34.3511, GNorm = 3.4794, lr_0 = 7.4588e-04
Loss = 8.6737e-01, PNorm = 34.4030, GNorm = 1.8964, lr_0 = 7.9882e-04
Loss = 8.6616e-01, PNorm = 34.4494, GNorm = 0.8798, lr_0 = 8.5176e-04
Loss = 8.6828e-01, PNorm = 34.5004, GNorm = 0.5315, lr_0 = 9.0471e-04
Loss = 8.4528e-01, PNorm = 34.5589, GNorm = 4.6935, lr_0 = 9.5765e-04
Loss = 8.5540e-01, PNorm = 34.6156, GNorm = 0.6695, lr_0 = 9.9807e-04
Validation cross_entropy = 0.916513
Epoch 2
Loss = 8.5150e-01, PNorm = 34.6860, GNorm = 1.1135, lr_0 = 9.8846e-04
Loss = 8.0688e-01, PNorm = 34.7611, GNorm = 2.5558, lr_0 = 9.7894e-04
Loss = 8.0598e-01, PNorm = 34.8326, GNorm = 0.9650, lr_0 = 9.6952e-04
Loss = 8.4404e-01, PNorm = 34.8985, GNorm = 4.0255, lr_0 = 9.6018e-04
Loss = 8.2771e-01, PNorm = 34.9567, GNorm = 3.0607, lr_0 = 9.5094e-04
Loss = 7.5731e-01, PNorm = 35.0152, GNorm = 0.7381, lr_0 = 9.4178e-04
Loss = 7.8246e-01, PNorm = 35.0796, GNorm = 3.5311, lr_0 = 9.3271e-04
Loss = 7.9367e-01, PNorm = 35.1426, GNorm = 1.9564, lr_0 = 9.2373e-04
Validation cross_entropy = 0.745057
Epoch 3
Loss = 6.8866e-01, PNorm = 35.2074, GNorm = 0.9252, lr_0 = 9.1484e-04
Loss = 7.1609e-01, PNorm = 35.2821, GNorm = 1.2557, lr_0 = 9.0603e-04
Loss = 6.9055e-01, PNorm = 35.3539, GNorm = 2.6602, lr_0 = 8.9731e-04
Loss = 7.1417e-01, PNorm = 35.4201, GNorm = 1.8497, lr_0 = 8.8867e-04
Loss = 7.7979e-01, PNorm = 35.4750, GNorm = 0.8510, lr_0 = 8.8011e-04
Loss = 6.8685e-01, PNorm = 35.5296, GNorm = 1.5041, lr_0 = 8.7164e-04
Loss = 7.2903e-01, PNorm = 35.5851, GNorm = 7.4222, lr_0 = 8.6325e-04
Loss = 7.2915e-01, PNorm = 35.6498, GNorm = 1.5022, lr_0 = 8.5493e-04
Loss = 7.3696e-01, PNorm = 35.7021, GNorm = 1.2024, lr_0 = 8.4670e-04
Validation cross_entropy = 0.675711
Epoch 4
Loss = 6.4779e-01, PNorm = 35.7788, GNorm = 2.9994, lr_0 = 8.3774e-04
Loss = 6.8234e-01, PNorm = 35.8431, GNorm = 2.3545, lr_0 = 8.2967e-04
Loss = 6.6979e-01, PNorm = 35.8940, GNorm = 3.7056, lr_0 = 8.2169e-04
Loss = 6.3673e-01, PNorm = 35.9494, GNorm = 3.7437, lr_0 = 8.1377e-04
Loss = 6.1646e-01, PNorm = 35.9922, GNorm = 2.1231, lr_0 = 8.0594e-04
Loss = 6.9294e-01, PNorm = 36.0199, GNorm = 0.8181, lr_0 = 7.9818e-04
Loss = 6.3990e-01, PNorm = 36.0597, GNorm = 3.5301, lr_0 = 7.9050e-04
Loss = 6.4226e-01, PNorm = 36.0931, GNorm = 3.3875, lr_0 = 7.8288e-04
Validation cross_entropy = 0.658305
Epoch 5
Loss = 5.7120e-01, PNorm = 36.1391, GNorm = 1.8975, lr_0 = 7.7535e-04
Loss = 6.2796e-01, PNorm = 36.1928, GNorm = 2.7065, lr_0 = 7.6788e-04
Loss = 5.8026e-01, PNorm = 36.2443, GNorm = 1.4829, lr_0 = 7.6049e-04
Loss = 6.6822e-01, PNorm = 36.2988, GNorm = 4.2975, lr_0 = 7.5317e-04
Loss = 7.2015e-01, PNorm = 36.3268, GNorm = 5.2824, lr_0 = 7.4591e-04
Loss = 6.2848e-01, PNorm = 36.3684, GNorm = 1.2759, lr_0 = 7.3873e-04
Loss = 6.6675e-01, PNorm = 36.4076, GNorm = 3.2685, lr_0 = 7.3162e-04
Loss = 6.5105e-01, PNorm = 36.4407, GNorm = 1.5358, lr_0 = 7.2458e-04
Loss = 6.2712e-01, PNorm = 36.4821, GNorm = 3.3124, lr_0 = 7.1760e-04
Validation cross_entropy = 0.666542
Epoch 6
Loss = 6.1744e-01, PNorm = 36.5241, GNorm = 1.0762, lr_0 = 7.1069e-04
Loss = 6.3973e-01, PNorm = 36.5649, GNorm = 1.7076, lr_0 = 7.0385e-04
Loss = 5.6495e-01, PNorm = 36.6087, GNorm = 1.0407, lr_0 = 6.9707e-04
Loss = 5.8439e-01, PNorm = 36.6530, GNorm = 1.3769, lr_0 = 6.9036e-04
Loss = 5.9387e-01, PNorm = 36.6904, GNorm = 2.6121, lr_0 = 6.8371e-04
Loss = 6.5317e-01, PNorm = 36.7252, GNorm = 2.2211, lr_0 = 6.7713e-04
Loss = 5.9835e-01, PNorm = 36.7658, GNorm = 2.0763, lr_0 = 6.7061e-04
Loss = 5.8047e-01, PNorm = 36.8045, GNorm = 4.5549, lr_0 = 6.6415e-04
Loss = 6.1459e-01, PNorm = 36.8349, GNorm = 1.4012, lr_0 = 6.5776e-04
Validation cross_entropy = 0.653129
Epoch 7
Loss = 5.3860e-01, PNorm = 36.8772, GNorm = 1.4158, lr_0 = 6.5143e-04
Loss = 5.8404e-01, PNorm = 36.9194, GNorm = 1.8542, lr_0 = 6.4515e-04
Loss = 5.8606e-01, PNorm = 36.9569, GNorm = 1.6663, lr_0 = 6.3894e-04
Loss = 6.2569e-01, PNorm = 36.9855, GNorm = 5.3837, lr_0 = 6.3279e-04
Loss = 6.2466e-01, PNorm = 37.0165, GNorm = 2.8301, lr_0 = 6.2670e-04
Loss = 6.1961e-01, PNorm = 37.0538, GNorm = 3.2359, lr_0 = 6.2066e-04
Loss = 5.5757e-01, PNorm = 37.0912, GNorm = 1.5014, lr_0 = 6.1469e-04
Loss = 5.8937e-01, PNorm = 37.1274, GNorm = 1.2289, lr_0 = 6.0877e-04
Validation cross_entropy = 0.619311
Epoch 8
Loss = 5.3281e-01, PNorm = 37.1680, GNorm = 1.4345, lr_0 = 6.0233e-04
Loss = 5.8952e-01, PNorm = 37.2057, GNorm = 1.1944, lr_0 = 5.9653e-04
Loss = 5.7182e-01, PNorm = 37.2408, GNorm = 2.6391, lr_0 = 5.9078e-04
Loss = 5.5922e-01, PNorm = 37.2834, GNorm = 1.1397, lr_0 = 5.8510e-04
Loss = 6.4795e-01, PNorm = 37.3186, GNorm = 2.6380, lr_0 = 5.7946e-04
Loss = 5.5968e-01, PNorm = 37.3494, GNorm = 1.6948, lr_0 = 5.7388e-04
Loss = 6.2022e-01, PNorm = 37.3805, GNorm = 1.6298, lr_0 = 5.6836e-04
Loss = 5.8375e-01, PNorm = 37.4092, GNorm = 1.3706, lr_0 = 5.6289e-04
Loss = 5.3765e-01, PNorm = 37.4451, GNorm = 1.6938, lr_0 = 5.5747e-04
Validation cross_entropy = 0.608906
Epoch 9
Loss = 5.6079e-01, PNorm = 37.4746, GNorm = 1.0381, lr_0 = 5.5210e-04
Loss = 5.1286e-01, PNorm = 37.5087, GNorm = 2.5368, lr_0 = 5.4678e-04
Loss = 5.7987e-01, PNorm = 37.5438, GNorm = 1.8301, lr_0 = 5.4152e-04
Loss = 5.3367e-01, PNorm = 37.5787, GNorm = 1.3192, lr_0 = 5.3630e-04
Loss = 5.6541e-01, PNorm = 37.6092, GNorm = 2.5824, lr_0 = 5.3114e-04
Loss = 5.3454e-01, PNorm = 37.6339, GNorm = 1.3118, lr_0 = 5.2603e-04
Loss = 5.9460e-01, PNorm = 37.6571, GNorm = 1.2181, lr_0 = 5.2096e-04
Loss = 5.6294e-01, PNorm = 37.6790, GNorm = 1.3696, lr_0 = 5.1595e-04
Validation cross_entropy = 0.635417
Epoch 10
Loss = 6.5223e-01, PNorm = 37.7066, GNorm = 1.9531, lr_0 = 5.1098e-04
Loss = 5.2107e-01, PNorm = 37.7378, GNorm = 3.5022, lr_0 = 5.0606e-04
Loss = 5.0903e-01, PNorm = 37.7718, GNorm = 4.1668, lr_0 = 5.0119e-04
Loss = 5.4037e-01, PNorm = 37.8099, GNorm = 2.4777, lr_0 = 4.9636e-04
Loss = 5.7548e-01, PNorm = 37.8516, GNorm = 5.6757, lr_0 = 4.9158e-04
Loss = 5.0842e-01, PNorm = 37.8894, GNorm = 1.5800, lr_0 = 4.8685e-04
Loss = 6.0077e-01, PNorm = 37.9178, GNorm = 2.3755, lr_0 = 4.8216e-04
Loss = 5.6408e-01, PNorm = 37.9376, GNorm = 2.2352, lr_0 = 4.7752e-04
Loss = 5.6561e-01, PNorm = 37.9666, GNorm = 3.6865, lr_0 = 4.7292e-04
Validation cross_entropy = 0.634932
Epoch 11
Loss = 5.6184e-01, PNorm = 37.9945, GNorm = 2.3347, lr_0 = 4.6792e-04
Loss = 5.0786e-01, PNorm = 38.0277, GNorm = 2.6988, lr_0 = 4.6341e-04
Loss = 5.2559e-01, PNorm = 38.0572, GNorm = 2.0795, lr_0 = 4.5895e-04
Loss = 5.4874e-01, PNorm = 38.0814, GNorm = 2.6070, lr_0 = 4.5453e-04
Loss = 5.5267e-01, PNorm = 38.1042, GNorm = 2.1316, lr_0 = 4.5015e-04
Loss = 5.5079e-01, PNorm = 38.1338, GNorm = 3.4730, lr_0 = 4.4582e-04
Loss = 5.5147e-01, PNorm = 38.1604, GNorm = 3.6810, lr_0 = 4.4153e-04
Loss = 5.5787e-01, PNorm = 38.1886, GNorm = 2.6095, lr_0 = 4.3728e-04
Validation cross_entropy = 0.676783
Epoch 12
Loss = 5.9548e-01, PNorm = 38.2134, GNorm = 2.5296, lr_0 = 4.3307e-04
Loss = 5.9809e-01, PNorm = 38.2448, GNorm = 3.6523, lr_0 = 4.2890e-04
Loss = 5.0255e-01, PNorm = 38.2740, GNorm = 2.1233, lr_0 = 4.2477e-04
Loss = 4.9748e-01, PNorm = 38.3021, GNorm = 1.2148, lr_0 = 4.2068e-04
Loss = 4.9784e-01, PNorm = 38.3306, GNorm = 1.4872, lr_0 = 4.1663e-04
Loss = 5.2015e-01, PNorm = 38.3572, GNorm = 1.9141, lr_0 = 4.1262e-04
Loss = 5.1577e-01, PNorm = 38.3825, GNorm = 2.5096, lr_0 = 4.0864e-04
Loss = 5.0501e-01, PNorm = 38.4015, GNorm = 1.0228, lr_0 = 4.0471e-04
Loss = 4.9329e-01, PNorm = 38.4205, GNorm = 2.3405, lr_0 = 4.0081e-04
Validation cross_entropy = 0.609688
Epoch 13
Loss = 4.2262e-01, PNorm = 38.4460, GNorm = 2.1590, lr_0 = 3.9695e-04
Loss = 5.0048e-01, PNorm = 38.4755, GNorm = 2.1694, lr_0 = 3.9313e-04
Loss = 5.2552e-01, PNorm = 38.5031, GNorm = 2.5097, lr_0 = 3.8935e-04
Loss = 4.8597e-01, PNorm = 38.5287, GNorm = 2.1107, lr_0 = 3.8560e-04
Loss = 5.5160e-01, PNorm = 38.5509, GNorm = 2.0911, lr_0 = 3.8189e-04
Loss = 5.2755e-01, PNorm = 38.5671, GNorm = 1.6083, lr_0 = 3.7821e-04
Loss = 5.0547e-01, PNorm = 38.5852, GNorm = 1.4353, lr_0 = 3.7457e-04
Loss = 5.0182e-01, PNorm = 38.6083, GNorm = 2.3000, lr_0 = 3.7096e-04
Loss = 4.5097e-01, PNorm = 38.6299, GNorm = 2.6949, lr_0 = 3.6739e-04
Validation cross_entropy = 0.596885
Epoch 14
Loss = 4.7734e-01, PNorm = 38.6520, GNorm = 2.4537, lr_0 = 3.6385e-04
Loss = 4.8013e-01, PNorm = 38.6750, GNorm = 1.2675, lr_0 = 3.6035e-04
Loss = 5.2954e-01, PNorm = 38.6980, GNorm = 1.5896, lr_0 = 3.5688e-04
Loss = 5.1331e-01, PNorm = 38.7202, GNorm = 1.3128, lr_0 = 3.5344e-04
Loss = 4.8710e-01, PNorm = 38.7430, GNorm = 4.6600, lr_0 = 3.5004e-04
Loss = 4.6945e-01, PNorm = 38.7640, GNorm = 1.4636, lr_0 = 3.4667e-04
Loss = 4.7445e-01, PNorm = 38.7905, GNorm = 1.9054, lr_0 = 3.4333e-04
Loss = 4.9111e-01, PNorm = 38.8166, GNorm = 2.6974, lr_0 = 3.4003e-04
Validation cross_entropy = 0.655787
Epoch 15
Loss = 5.9041e-01, PNorm = 38.8389, GNorm = 4.8393, lr_0 = 3.3643e-04
Loss = 4.8937e-01, PNorm = 38.8601, GNorm = 3.5261, lr_0 = 3.3319e-04
Loss = 4.4052e-01, PNorm = 38.8831, GNorm = 1.7020, lr_0 = 3.2998e-04
Loss = 4.8160e-01, PNorm = 38.9069, GNorm = 3.1133, lr_0 = 3.2680e-04
Loss = 4.6426e-01, PNorm = 38.9288, GNorm = 1.1155, lr_0 = 3.2366e-04
Loss = 4.5773e-01, PNorm = 38.9488, GNorm = 1.9500, lr_0 = 3.2054e-04
Loss = 4.1911e-01, PNorm = 38.9683, GNorm = 1.3970, lr_0 = 3.1745e-04
Loss = 4.5652e-01, PNorm = 38.9885, GNorm = 1.2225, lr_0 = 3.1440e-04
Loss = 5.6449e-01, PNorm = 39.0103, GNorm = 1.7188, lr_0 = 3.1137e-04
Validation cross_entropy = 0.604973
Epoch 16
Loss = 4.5110e-01, PNorm = 39.0299, GNorm = 2.3487, lr_0 = 3.0837e-04
Loss = 4.4270e-01, PNorm = 39.0521, GNorm = 1.3092, lr_0 = 3.0540e-04
Loss = 4.7645e-01, PNorm = 39.0735, GNorm = 4.8072, lr_0 = 3.0246e-04
Loss = 4.9289e-01, PNorm = 39.0944, GNorm = 0.9654, lr_0 = 2.9955e-04
Loss = 4.9110e-01, PNorm = 39.1110, GNorm = 1.3861, lr_0 = 2.9667e-04
Loss = 4.3188e-01, PNorm = 39.1310, GNorm = 1.9035, lr_0 = 2.9381e-04
Loss = 4.2456e-01, PNorm = 39.1489, GNorm = 3.4071, lr_0 = 2.9098e-04
Loss = 4.5762e-01, PNorm = 39.1651, GNorm = 2.5257, lr_0 = 2.8818e-04
Validation cross_entropy = 0.605172
Epoch 17
Loss = 4.8735e-01, PNorm = 39.1813, GNorm = 1.6277, lr_0 = 2.8541e-04
Loss = 4.6823e-01, PNorm = 39.1992, GNorm = 2.2551, lr_0 = 2.8266e-04
Loss = 4.5628e-01, PNorm = 39.2163, GNorm = 0.9839, lr_0 = 2.7994e-04
Loss = 4.3457e-01, PNorm = 39.2341, GNorm = 3.7181, lr_0 = 2.7724e-04
Loss = 4.7167e-01, PNorm = 39.2552, GNorm = 1.8488, lr_0 = 2.7457e-04
Loss = 4.4691e-01, PNorm = 39.2723, GNorm = 2.7886, lr_0 = 2.7193e-04
Loss = 4.2816e-01, PNorm = 39.2902, GNorm = 1.4976, lr_0 = 2.6931e-04
Loss = 4.6376e-01, PNorm = 39.3086, GNorm = 1.6328, lr_0 = 2.6672e-04
Loss = 3.9570e-01, PNorm = 39.3274, GNorm = 1.8390, lr_0 = 2.6415e-04
Validation cross_entropy = 0.603418
Epoch 18
Loss = 4.4589e-01, PNorm = 39.3498, GNorm = 1.5430, lr_0 = 2.6135e-04
Loss = 4.2494e-01, PNorm = 39.3679, GNorm = 2.1422, lr_0 = 2.5884e-04
Loss = 4.1124e-01, PNorm = 39.3860, GNorm = 2.3107, lr_0 = 2.5634e-04
Loss = 4.3204e-01, PNorm = 39.4019, GNorm = 1.8847, lr_0 = 2.5388e-04
Loss = 4.3252e-01, PNorm = 39.4205, GNorm = 1.3563, lr_0 = 2.5143e-04
Loss = 5.0528e-01, PNorm = 39.4380, GNorm = 6.8540, lr_0 = 2.4901e-04
Loss = 4.5550e-01, PNorm = 39.4516, GNorm = 2.4230, lr_0 = 2.4661e-04
Loss = 4.6659e-01, PNorm = 39.4666, GNorm = 3.5432, lr_0 = 2.4424e-04
Validation cross_entropy = 0.600339
Epoch 19
Loss = 3.9982e-01, PNorm = 39.4847, GNorm = 1.4762, lr_0 = 2.4189e-04
Loss = 4.1648e-01, PNorm = 39.5022, GNorm = 1.5771, lr_0 = 2.3956e-04
Loss = 4.1955e-01, PNorm = 39.5181, GNorm = 1.2608, lr_0 = 2.3725e-04
Loss = 4.0707e-01, PNorm = 39.5333, GNorm = 1.4620, lr_0 = 2.3497e-04
Loss = 3.9973e-01, PNorm = 39.5495, GNorm = 3.3463, lr_0 = 2.3271e-04
Loss = 4.2821e-01, PNorm = 39.5607, GNorm = 3.9553, lr_0 = 2.3047e-04
Loss = 4.1786e-01, PNorm = 39.5758, GNorm = 3.5038, lr_0 = 2.2825e-04
Loss = 4.4581e-01, PNorm = 39.5919, GNorm = 2.2298, lr_0 = 2.2605e-04
Loss = 4.5742e-01, PNorm = 39.6094, GNorm = 1.4472, lr_0 = 2.2387e-04
Validation cross_entropy = 0.595573
Epoch 20
Loss = 3.8493e-01, PNorm = 39.6222, GNorm = 1.0986, lr_0 = 2.2172e-04
Loss = 3.6918e-01, PNorm = 39.6401, GNorm = 2.8489, lr_0 = 2.1958e-04
Loss = 4.0352e-01, PNorm = 39.6567, GNorm = 4.8216, lr_0 = 2.1747e-04
Loss = 4.3313e-01, PNorm = 39.6717, GNorm = 2.4578, lr_0 = 2.1537e-04
Loss = 4.3089e-01, PNorm = 39.6844, GNorm = 1.1366, lr_0 = 2.1330e-04
Loss = 3.8633e-01, PNorm = 39.6994, GNorm = 2.1694, lr_0 = 2.1125e-04
Loss = 4.8313e-01, PNorm = 39.7146, GNorm = 2.3072, lr_0 = 2.0921e-04
Loss = 4.5678e-01, PNorm = 39.7298, GNorm = 3.0777, lr_0 = 2.0720e-04
Loss = 4.2632e-01, PNorm = 39.7433, GNorm = 2.7487, lr_0 = 2.0520e-04
Validation cross_entropy = 0.590154
Epoch 21
Loss = 4.3291e-01, PNorm = 39.7557, GNorm = 3.0792, lr_0 = 2.0323e-04
Loss = 4.0094e-01, PNorm = 39.7702, GNorm = 2.4308, lr_0 = 2.0127e-04
Loss = 4.0792e-01, PNorm = 39.7819, GNorm = 3.1550, lr_0 = 1.9933e-04
Loss = 4.1796e-01, PNorm = 39.7952, GNorm = 1.6120, lr_0 = 1.9741e-04
Loss = 3.8071e-01, PNorm = 39.8103, GNorm = 1.0883, lr_0 = 1.9551e-04
Loss = 4.1100e-01, PNorm = 39.8232, GNorm = 1.0604, lr_0 = 1.9363e-04
Loss = 4.2694e-01, PNorm = 39.8382, GNorm = 3.2553, lr_0 = 1.9177e-04
Loss = 4.4557e-01, PNorm = 39.8529, GNorm = 3.1680, lr_0 = 1.8992e-04
Validation cross_entropy = 0.599551
Epoch 22
Loss = 4.2593e-01, PNorm = 39.8680, GNorm = 1.4037, lr_0 = 1.8791e-04
Loss = 3.9488e-01, PNorm = 39.8805, GNorm = 1.8507, lr_0 = 1.8610e-04
Loss = 3.6617e-01, PNorm = 39.8919, GNorm = 1.9084, lr_0 = 1.8431e-04
Loss = 4.2986e-01, PNorm = 39.9032, GNorm = 4.8007, lr_0 = 1.8253e-04
Loss = 4.0096e-01, PNorm = 39.9145, GNorm = 2.4766, lr_0 = 1.8078e-04
Loss = 3.7909e-01, PNorm = 39.9284, GNorm = 2.4695, lr_0 = 1.7904e-04
Loss = 4.3575e-01, PNorm = 39.9402, GNorm = 1.6479, lr_0 = 1.7731e-04
Loss = 4.3350e-01, PNorm = 39.9526, GNorm = 1.7277, lr_0 = 1.7561e-04
Loss = 4.0936e-01, PNorm = 39.9668, GNorm = 2.8920, lr_0 = 1.7391e-04
Validation cross_entropy = 0.596684
Epoch 23
Loss = 4.4069e-01, PNorm = 39.9795, GNorm = 6.3561, lr_0 = 1.7224e-04
Loss = 3.8502e-01, PNorm = 39.9916, GNorm = 1.8085, lr_0 = 1.7058e-04
Loss = 3.9144e-01, PNorm = 40.0036, GNorm = 4.3836, lr_0 = 1.6894e-04
Loss = 4.0681e-01, PNorm = 40.0154, GNorm = 4.2088, lr_0 = 1.6731e-04
Loss = 4.1539e-01, PNorm = 40.0265, GNorm = 3.3288, lr_0 = 1.6570e-04
Loss = 4.2095e-01, PNorm = 40.0367, GNorm = 2.0026, lr_0 = 1.6411e-04
Loss = 3.8904e-01, PNorm = 40.0476, GNorm = 2.0934, lr_0 = 1.6253e-04
Loss = 3.8232e-01, PNorm = 40.0569, GNorm = 1.8485, lr_0 = 1.6096e-04
Validation cross_entropy = 0.588103
Epoch 24
Loss = 3.4511e-01, PNorm = 40.0669, GNorm = 1.6477, lr_0 = 1.5941e-04
Loss = 4.3325e-01, PNorm = 40.0789, GNorm = 5.4907, lr_0 = 1.5788e-04
Loss = 3.6954e-01, PNorm = 40.0905, GNorm = 1.7330, lr_0 = 1.5636e-04
Loss = 3.6347e-01, PNorm = 40.1029, GNorm = 3.4443, lr_0 = 1.5485e-04
Loss = 4.0020e-01, PNorm = 40.1150, GNorm = 3.1103, lr_0 = 1.5336e-04
Loss = 3.7843e-01, PNorm = 40.1239, GNorm = 2.7459, lr_0 = 1.5188e-04
Loss = 4.2709e-01, PNorm = 40.1342, GNorm = 3.4228, lr_0 = 1.5042e-04
Loss = 3.9768e-01, PNorm = 40.1429, GNorm = 3.2179, lr_0 = 1.4897e-04
Loss = 3.6600e-01, PNorm = 40.1527, GNorm = 2.2919, lr_0 = 1.4754e-04
Validation cross_entropy = 0.593767
Epoch 25
Loss = 3.2245e-01, PNorm = 40.1638, GNorm = 2.1880, lr_0 = 1.4612e-04
Loss = 3.7894e-01, PNorm = 40.1758, GNorm = 1.7906, lr_0 = 1.4471e-04
Loss = 3.8954e-01, PNorm = 40.1853, GNorm = 4.7101, lr_0 = 1.4332e-04
Loss = 4.0870e-01, PNorm = 40.1945, GNorm = 1.7591, lr_0 = 1.4194e-04
Loss = 3.8773e-01, PNorm = 40.2045, GNorm = 1.6653, lr_0 = 1.4057e-04
Loss = 3.9752e-01, PNorm = 40.2136, GNorm = 2.3474, lr_0 = 1.3922e-04
Loss = 3.3901e-01, PNorm = 40.2241, GNorm = 2.4862, lr_0 = 1.3788e-04
Loss = 3.7852e-01, PNorm = 40.2330, GNorm = 3.4950, lr_0 = 1.3655e-04
Validation cross_entropy = 0.595498
Epoch 26
Loss = 4.2078e-01, PNorm = 40.2428, GNorm = 2.6849, lr_0 = 1.3511e-04
Loss = 3.6516e-01, PNorm = 40.2523, GNorm = 1.5194, lr_0 = 1.3380e-04
Loss = 3.2850e-01, PNorm = 40.2613, GNorm = 1.4659, lr_0 = 1.3252e-04
Loss = 4.3158e-01, PNorm = 40.2700, GNorm = 3.0033, lr_0 = 1.3124e-04
Loss = 3.8342e-01, PNorm = 40.2791, GNorm = 1.6420, lr_0 = 1.2998e-04
Loss = 3.7792e-01, PNorm = 40.2880, GNorm = 1.8978, lr_0 = 1.2873e-04
Loss = 3.5367e-01, PNorm = 40.2976, GNorm = 4.6929, lr_0 = 1.2749e-04
Loss = 4.2185e-01, PNorm = 40.3061, GNorm = 3.4075, lr_0 = 1.2626e-04
Loss = 3.8709e-01, PNorm = 40.3147, GNorm = 1.9820, lr_0 = 1.2504e-04
Validation cross_entropy = 0.603617
Epoch 27
Loss = 3.7196e-01, PNorm = 40.3226, GNorm = 3.0862, lr_0 = 1.2384e-04
Loss = 3.8880e-01, PNorm = 40.3319, GNorm = 1.9307, lr_0 = 1.2265e-04
Loss = 3.8568e-01, PNorm = 40.3421, GNorm = 3.5429, lr_0 = 1.2147e-04
Loss = 3.4917e-01, PNorm = 40.3505, GNorm = 1.6764, lr_0 = 1.2030e-04
Loss = 3.4266e-01, PNorm = 40.3581, GNorm = 3.7973, lr_0 = 1.1914e-04
Loss = 3.9734e-01, PNorm = 40.3651, GNorm = 4.7486, lr_0 = 1.1799e-04
Loss = 3.9632e-01, PNorm = 40.3711, GNorm = 4.4430, lr_0 = 1.1685e-04
Loss = 3.2813e-01, PNorm = 40.3783, GNorm = 4.8718, lr_0 = 1.1573e-04
Loss = 4.1189e-01, PNorm = 40.3867, GNorm = 4.0367, lr_0 = 1.1462e-04
Validation cross_entropy = 0.596627
Epoch 28
Loss = 3.3221e-01, PNorm = 40.3946, GNorm = 3.2498, lr_0 = 1.1351e-04
Loss = 3.5087e-01, PNorm = 40.4020, GNorm = 3.1113, lr_0 = 1.1242e-04
Loss = 3.8641e-01, PNorm = 40.4102, GNorm = 2.2054, lr_0 = 1.1134e-04
Loss = 3.5644e-01, PNorm = 40.4188, GNorm = 1.4101, lr_0 = 1.1026e-04
Loss = 3.3782e-01, PNorm = 40.4269, GNorm = 1.5005, lr_0 = 1.0920e-04
Loss = 3.5461e-01, PNorm = 40.4340, GNorm = 2.2332, lr_0 = 1.0815e-04
Loss = 3.6607e-01, PNorm = 40.4408, GNorm = 3.1660, lr_0 = 1.0711e-04
Loss = 4.0351e-01, PNorm = 40.4469, GNorm = 4.2973, lr_0 = 1.0608e-04
Validation cross_entropy = 0.605971
Epoch 29
Loss = 3.1456e-01, PNorm = 40.4547, GNorm = 1.8050, lr_0 = 1.0496e-04
Loss = 3.4531e-01, PNorm = 40.4620, GNorm = 2.7415, lr_0 = 1.0395e-04
Loss = 3.1147e-01, PNorm = 40.4690, GNorm = 2.3442, lr_0 = 1.0294e-04
Loss = 3.8146e-01, PNorm = 40.4763, GNorm = 1.9026, lr_0 = 1.0195e-04
Loss = 3.7491e-01, PNorm = 40.4836, GNorm = 2.7137, lr_0 = 1.0097e-04
Loss = 3.2847e-01, PNorm = 40.4912, GNorm = 1.9057, lr_0 = 1.0000e-04
Loss = 3.7724e-01, PNorm = 40.4977, GNorm = 2.6417, lr_0 = 1.0000e-04
Loss = 3.8895e-01, PNorm = 40.5042, GNorm = 2.1284, lr_0 = 1.0000e-04
Loss = 3.5085e-01, PNorm = 40.5101, GNorm = 1.6596, lr_0 = 1.0000e-04
Validation cross_entropy = 0.610806
Model 0 best validation cross_entropy = 0.588103 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.369548
Ensemble test cross_entropy = 0.369548
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.369548
Overall test cross_entropy = 0.369548 +/- 0.000000
Elapsed time = 0:14:10
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 45 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 45 SMILES are invalid.
Warning: 343 SMILES are invalid.
Total size = 4,281 | train size = 4,281 | val size = 38,599 | test size = 4,281
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.0923e+00, PNorm = 34.0523, GNorm = 1.1995, lr_0 = 1.5824e-04
Loss = 1.0782e+00, PNorm = 34.0548, GNorm = 1.0900, lr_0 = 2.1118e-04
Loss = 1.0753e+00, PNorm = 34.0591, GNorm = 1.3781, lr_0 = 2.6412e-04
Loss = 1.0473e+00, PNorm = 34.0682, GNorm = 0.8437, lr_0 = 3.1706e-04
Loss = 1.0414e+00, PNorm = 34.0825, GNorm = 2.4930, lr_0 = 3.7000e-04
Loss = 1.0350e+00, PNorm = 34.1014, GNorm = 1.0611, lr_0 = 4.2294e-04
Loss = 1.0165e+00, PNorm = 34.1255, GNorm = 1.0738, lr_0 = 4.7588e-04
Loss = 9.6006e-01, PNorm = 34.1647, GNorm = 2.2328, lr_0 = 5.2882e-04
Validation cross_entropy = 0.933279
Epoch 1
Loss = 8.7329e-01, PNorm = 34.2179, GNorm = 0.9421, lr_0 = 5.8706e-04
Loss = 9.3517e-01, PNorm = 34.2698, GNorm = 4.3188, lr_0 = 6.4000e-04
Loss = 9.3150e-01, PNorm = 34.3217, GNorm = 1.0527, lr_0 = 6.9294e-04
Loss = 9.1520e-01, PNorm = 34.3734, GNorm = 2.1522, lr_0 = 7.4588e-04
Loss = 8.7001e-01, PNorm = 34.4363, GNorm = 1.4785, lr_0 = 7.9882e-04
Loss = 8.5024e-01, PNorm = 34.4942, GNorm = 1.7634, lr_0 = 8.5176e-04
Loss = 8.6353e-01, PNorm = 34.5435, GNorm = 1.2210, lr_0 = 9.0471e-04
Loss = 8.3691e-01, PNorm = 34.6082, GNorm = 1.0303, lr_0 = 9.5765e-04
Loss = 8.3744e-01, PNorm = 34.6815, GNorm = 1.0642, lr_0 = 9.9807e-04
Validation cross_entropy = 0.787399
Epoch 2
Loss = 7.4525e-01, PNorm = 34.7688, GNorm = 1.4657, lr_0 = 9.8846e-04
Loss = 7.3669e-01, PNorm = 34.8548, GNorm = 4.6147, lr_0 = 9.7894e-04
Loss = 8.4191e-01, PNorm = 34.9130, GNorm = 0.5484, lr_0 = 9.6952e-04
Loss = 7.7180e-01, PNorm = 34.9758, GNorm = 1.1779, lr_0 = 9.6018e-04
Loss = 7.6628e-01, PNorm = 35.0436, GNorm = 2.3155, lr_0 = 9.5094e-04
Loss = 7.3222e-01, PNorm = 35.1250, GNorm = 4.9233, lr_0 = 9.4178e-04
Loss = 7.8026e-01, PNorm = 35.1748, GNorm = 1.0467, lr_0 = 9.3271e-04
Loss = 7.3513e-01, PNorm = 35.2296, GNorm = 1.0963, lr_0 = 9.2373e-04
Validation cross_entropy = 0.751354
Epoch 3
Loss = 6.6817e-01, PNorm = 35.2989, GNorm = 1.8616, lr_0 = 9.1395e-04
Loss = 7.3290e-01, PNorm = 35.3713, GNorm = 1.7685, lr_0 = 9.0515e-04
Loss = 6.9592e-01, PNorm = 35.4233, GNorm = 2.0245, lr_0 = 8.9644e-04
Loss = 7.5148e-01, PNorm = 35.4760, GNorm = 1.8344, lr_0 = 8.8781e-04
Loss = 7.1590e-01, PNorm = 35.5261, GNorm = 3.2264, lr_0 = 8.7926e-04
Loss = 6.5607e-01, PNorm = 35.5750, GNorm = 1.0206, lr_0 = 8.7080e-04
Loss = 6.7926e-01, PNorm = 35.6298, GNorm = 1.0131, lr_0 = 8.6241e-04
Loss = 6.8168e-01, PNorm = 35.6781, GNorm = 1.9307, lr_0 = 8.5411e-04
Loss = 6.8418e-01, PNorm = 35.7291, GNorm = 1.2220, lr_0 = 8.4588e-04
Validation cross_entropy = 0.742951
Epoch 4
Loss = 6.9367e-01, PNorm = 35.7715, GNorm = 3.3136, lr_0 = 8.3774e-04
Loss = 6.0787e-01, PNorm = 35.8189, GNorm = 3.2447, lr_0 = 8.2967e-04
Loss = 6.1296e-01, PNorm = 35.8686, GNorm = 1.7729, lr_0 = 8.2169e-04
Loss = 6.6164e-01, PNorm = 35.9182, GNorm = 3.1258, lr_0 = 8.1377e-04
Loss = 6.7987e-01, PNorm = 35.9636, GNorm = 1.9266, lr_0 = 8.0594e-04
Loss = 6.9860e-01, PNorm = 36.0066, GNorm = 0.8528, lr_0 = 7.9818e-04
Loss = 6.5804e-01, PNorm = 36.0499, GNorm = 0.9214, lr_0 = 7.9050e-04
Loss = 6.4139e-01, PNorm = 36.1001, GNorm = 1.0960, lr_0 = 7.8288e-04
Validation cross_entropy = 0.649890
Epoch 5
Loss = 6.0368e-01, PNorm = 36.1386, GNorm = 1.3490, lr_0 = 7.7535e-04
Loss = 6.1637e-01, PNorm = 36.1769, GNorm = 4.9717, lr_0 = 7.6788e-04
Loss = 6.3913e-01, PNorm = 36.2082, GNorm = 5.7611, lr_0 = 7.6049e-04
Loss = 6.5838e-01, PNorm = 36.2549, GNorm = 0.9160, lr_0 = 7.5317e-04
Loss = 6.3158e-01, PNorm = 36.2941, GNorm = 1.1696, lr_0 = 7.4591e-04
Loss = 5.9779e-01, PNorm = 36.3353, GNorm = 4.2265, lr_0 = 7.3873e-04
Loss = 6.3992e-01, PNorm = 36.3658, GNorm = 1.6882, lr_0 = 7.3162e-04
Loss = 6.2094e-01, PNorm = 36.4017, GNorm = 1.9519, lr_0 = 7.2458e-04
Loss = 6.7251e-01, PNorm = 36.4381, GNorm = 0.7215, lr_0 = 7.1760e-04
Validation cross_entropy = 0.638134
Epoch 6
Loss = 5.9189e-01, PNorm = 36.4738, GNorm = 2.9628, lr_0 = 7.1000e-04
Loss = 5.6331e-01, PNorm = 36.5127, GNorm = 1.8110, lr_0 = 7.0317e-04
Loss = 6.1221e-01, PNorm = 36.5481, GNorm = 2.6217, lr_0 = 6.9640e-04
Loss = 6.1617e-01, PNorm = 36.5863, GNorm = 1.7023, lr_0 = 6.8969e-04
Loss = 6.1312e-01, PNorm = 36.6253, GNorm = 1.8487, lr_0 = 6.8305e-04
Loss = 6.3695e-01, PNorm = 36.6612, GNorm = 3.9517, lr_0 = 6.7648e-04
Loss = 5.8561e-01, PNorm = 36.7035, GNorm = 2.5517, lr_0 = 6.6996e-04
Loss = 6.7944e-01, PNorm = 36.7322, GNorm = 5.1496, lr_0 = 6.6351e-04
Validation cross_entropy = 0.642504
Epoch 7
Loss = 8.6602e-01, PNorm = 36.7721, GNorm = 2.4936, lr_0 = 6.5712e-04
Loss = 5.7677e-01, PNorm = 36.8063, GNorm = 1.4454, lr_0 = 6.5080e-04
Loss = 5.7422e-01, PNorm = 36.8403, GNorm = 2.1916, lr_0 = 6.4453e-04
Loss = 5.9181e-01, PNorm = 36.8836, GNorm = 2.9366, lr_0 = 6.3833e-04
Loss = 5.7167e-01, PNorm = 36.9217, GNorm = 3.2963, lr_0 = 6.3218e-04
Loss = 5.7820e-01, PNorm = 36.9503, GNorm = 3.0942, lr_0 = 6.2609e-04
Loss = 5.6581e-01, PNorm = 36.9849, GNorm = 1.1362, lr_0 = 6.2006e-04
Loss = 5.7412e-01, PNorm = 37.0188, GNorm = 1.2114, lr_0 = 6.1409e-04
Loss = 5.9252e-01, PNorm = 37.0508, GNorm = 3.5011, lr_0 = 6.0818e-04
Validation cross_entropy = 0.618934
Epoch 8
Loss = 6.1731e-01, PNorm = 37.0774, GNorm = 1.4100, lr_0 = 6.0174e-04
Loss = 5.4623e-01, PNorm = 37.1099, GNorm = 1.8486, lr_0 = 5.9595e-04
Loss = 5.9640e-01, PNorm = 37.1484, GNorm = 3.4148, lr_0 = 5.9021e-04
Loss = 6.2304e-01, PNorm = 37.1760, GNorm = 2.5887, lr_0 = 5.8453e-04
Loss = 5.3788e-01, PNorm = 37.2093, GNorm = 0.7900, lr_0 = 5.7890e-04
Loss = 5.6946e-01, PNorm = 37.2425, GNorm = 1.0541, lr_0 = 5.7333e-04
Loss = 6.0837e-01, PNorm = 37.2709, GNorm = 1.5577, lr_0 = 5.6781e-04
Loss = 4.7262e-01, PNorm = 37.3027, GNorm = 0.8012, lr_0 = 5.6234e-04
Loss = 5.3979e-01, PNorm = 37.3417, GNorm = 4.7430, lr_0 = 5.5693e-04
Validation cross_entropy = 0.658699
Epoch 9
Loss = 5.5591e-01, PNorm = 37.3782, GNorm = 1.5287, lr_0 = 5.5156e-04
Loss = 5.5867e-01, PNorm = 37.4153, GNorm = 3.0328, lr_0 = 5.4625e-04
Loss = 5.9447e-01, PNorm = 37.4490, GNorm = 1.1580, lr_0 = 5.4100e-04
Loss = 5.4457e-01, PNorm = 37.4820, GNorm = 2.8211, lr_0 = 5.3579e-04
Loss = 5.7691e-01, PNorm = 37.5116, GNorm = 2.8388, lr_0 = 5.3063e-04
Loss = 5.4492e-01, PNorm = 37.5335, GNorm = 1.6853, lr_0 = 5.2552e-04
Loss = 5.2003e-01, PNorm = 37.5611, GNorm = 1.9607, lr_0 = 5.2046e-04
Loss = 5.5117e-01, PNorm = 37.5908, GNorm = 1.5205, lr_0 = 5.1545e-04
Validation cross_entropy = 0.661185
Epoch 10
Loss = 5.3786e-01, PNorm = 37.6185, GNorm = 2.3665, lr_0 = 5.1049e-04
Loss = 5.2426e-01, PNorm = 37.6521, GNorm = 1.7087, lr_0 = 5.0557e-04
Loss = 5.0921e-01, PNorm = 37.6866, GNorm = 1.8687, lr_0 = 5.0070e-04
Loss = 5.1692e-01, PNorm = 37.7177, GNorm = 2.5345, lr_0 = 4.9588e-04
Loss = 5.7474e-01, PNorm = 37.7432, GNorm = 2.0948, lr_0 = 4.9111e-04
Loss = 5.3270e-01, PNorm = 37.7707, GNorm = 1.4837, lr_0 = 4.8638e-04
Loss = 5.6078e-01, PNorm = 37.8009, GNorm = 2.1495, lr_0 = 4.8170e-04
Loss = 5.3800e-01, PNorm = 37.8269, GNorm = 1.1507, lr_0 = 4.7706e-04
Loss = 5.3940e-01, PNorm = 37.8536, GNorm = 1.1536, lr_0 = 4.7247e-04
Validation cross_entropy = 0.625167
Epoch 11
Loss = 5.6843e-01, PNorm = 37.8859, GNorm = 4.9993, lr_0 = 4.6746e-04
Loss = 5.2364e-01, PNorm = 37.9140, GNorm = 1.2309, lr_0 = 4.6296e-04
Loss = 5.3044e-01, PNorm = 37.9443, GNorm = 1.9078, lr_0 = 4.5851e-04
Loss = 4.8695e-01, PNorm = 37.9742, GNorm = 3.5613, lr_0 = 4.5409e-04
Loss = 5.6169e-01, PNorm = 38.0016, GNorm = 2.0526, lr_0 = 4.4972e-04
Loss = 4.7965e-01, PNorm = 38.0276, GNorm = 1.4377, lr_0 = 4.4539e-04
Loss = 5.1492e-01, PNorm = 38.0573, GNorm = 3.8401, lr_0 = 4.4110e-04
Loss = 5.2623e-01, PNorm = 38.0781, GNorm = 1.3908, lr_0 = 4.3685e-04
Validation cross_entropy = 0.605669
Epoch 12
Loss = 5.0919e-01, PNorm = 38.0979, GNorm = 1.9099, lr_0 = 4.3265e-04
Loss = 5.3529e-01, PNorm = 38.1241, GNorm = 1.3460, lr_0 = 4.2848e-04
Loss = 4.8722e-01, PNorm = 38.1580, GNorm = 3.2767, lr_0 = 4.2436e-04
Loss = 5.7121e-01, PNorm = 38.1850, GNorm = 4.5484, lr_0 = 4.2027e-04
Loss = 4.9650e-01, PNorm = 38.2091, GNorm = 1.0468, lr_0 = 4.1622e-04
Loss = 5.1747e-01, PNorm = 38.2316, GNorm = 1.5881, lr_0 = 4.1222e-04
Loss = 5.2452e-01, PNorm = 38.2565, GNorm = 1.5397, lr_0 = 4.0825e-04
Loss = 5.1150e-01, PNorm = 38.2829, GNorm = 1.5521, lr_0 = 4.0432e-04
Loss = 5.1882e-01, PNorm = 38.3118, GNorm = 2.3512, lr_0 = 4.0042e-04
Validation cross_entropy = 0.589574
Epoch 13
Loss = 4.7993e-01, PNorm = 38.3380, GNorm = 1.2951, lr_0 = 3.9657e-04
Loss = 5.2344e-01, PNorm = 38.3653, GNorm = 2.9211, lr_0 = 3.9275e-04
Loss = 4.5853e-01, PNorm = 38.3883, GNorm = 1.6628, lr_0 = 3.8897e-04
Loss = 4.9778e-01, PNorm = 38.4128, GNorm = 2.0932, lr_0 = 3.8522e-04
Loss = 4.7983e-01, PNorm = 38.4378, GNorm = 1.4395, lr_0 = 3.8152e-04
Loss = 4.7186e-01, PNorm = 38.4641, GNorm = 1.1867, lr_0 = 3.7784e-04
Loss = 5.4940e-01, PNorm = 38.4836, GNorm = 1.3968, lr_0 = 3.7420e-04
Loss = 4.8423e-01, PNorm = 38.5023, GNorm = 1.1352, lr_0 = 3.7060e-04
Validation cross_entropy = 0.627810
Epoch 14
Loss = 5.9854e-01, PNorm = 38.5290, GNorm = 2.6910, lr_0 = 3.6668e-04
Loss = 4.8995e-01, PNorm = 38.5493, GNorm = 3.2392, lr_0 = 3.6315e-04
Loss = 5.2490e-01, PNorm = 38.5741, GNorm = 1.4625, lr_0 = 3.5965e-04
Loss = 4.8237e-01, PNorm = 38.6011, GNorm = 3.4289, lr_0 = 3.5619e-04
Loss = 4.5256e-01, PNorm = 38.6285, GNorm = 2.5828, lr_0 = 3.5276e-04
Loss = 5.3457e-01, PNorm = 38.6553, GNorm = 1.9542, lr_0 = 3.4936e-04
Loss = 4.6528e-01, PNorm = 38.6801, GNorm = 1.3467, lr_0 = 3.4600e-04
Loss = 4.7822e-01, PNorm = 38.7032, GNorm = 1.6921, lr_0 = 3.4267e-04
Loss = 4.4356e-01, PNorm = 38.7229, GNorm = 1.2279, lr_0 = 3.3937e-04
Validation cross_entropy = 0.611935
Epoch 15
Loss = 4.6969e-01, PNorm = 38.7423, GNorm = 2.7642, lr_0 = 3.3610e-04
Loss = 4.4869e-01, PNorm = 38.7685, GNorm = 4.0299, lr_0 = 3.3287e-04
Loss = 4.7439e-01, PNorm = 38.7991, GNorm = 3.7139, lr_0 = 3.2966e-04
Loss = 4.5985e-01, PNorm = 38.8272, GNorm = 2.1269, lr_0 = 3.2649e-04
Loss = 4.7466e-01, PNorm = 38.8516, GNorm = 2.4802, lr_0 = 3.2334e-04
Loss = 4.8673e-01, PNorm = 38.8655, GNorm = 2.2548, lr_0 = 3.2023e-04
Loss = 4.4596e-01, PNorm = 38.8826, GNorm = 2.5467, lr_0 = 3.1715e-04
Loss = 4.8735e-01, PNorm = 38.9044, GNorm = 1.6769, lr_0 = 3.1409e-04
Validation cross_entropy = 0.584802
Epoch 16
Loss = 4.9963e-01, PNorm = 38.9252, GNorm = 2.3271, lr_0 = 3.1077e-04
Loss = 4.8187e-01, PNorm = 38.9475, GNorm = 4.9995, lr_0 = 3.0778e-04
Loss = 4.3794e-01, PNorm = 38.9711, GNorm = 1.2230, lr_0 = 3.0481e-04
Loss = 4.4964e-01, PNorm = 38.9939, GNorm = 2.7642, lr_0 = 3.0188e-04
Loss = 4.6032e-01, PNorm = 39.0110, GNorm = 4.1626, lr_0 = 2.9897e-04
Loss = 4.4890e-01, PNorm = 39.0310, GNorm = 2.7326, lr_0 = 2.9609e-04
Loss = 5.0470e-01, PNorm = 39.0527, GNorm = 4.8222, lr_0 = 2.9324e-04
Loss = 4.2844e-01, PNorm = 39.0736, GNorm = 1.4216, lr_0 = 2.9042e-04
Loss = 4.6222e-01, PNorm = 39.0929, GNorm = 4.5309, lr_0 = 2.8762e-04
Validation cross_entropy = 0.647302
Epoch 17
Loss = 4.0280e-01, PNorm = 39.1143, GNorm = 1.9308, lr_0 = 2.8485e-04
Loss = 5.0921e-01, PNorm = 39.1361, GNorm = 2.6772, lr_0 = 2.8211e-04
Loss = 4.5634e-01, PNorm = 39.1560, GNorm = 1.5986, lr_0 = 2.7939e-04
Loss = 4.6072e-01, PNorm = 39.1757, GNorm = 3.7460, lr_0 = 2.7670e-04
Loss = 4.6067e-01, PNorm = 39.1928, GNorm = 1.4663, lr_0 = 2.7404e-04
Loss = 4.4887e-01, PNorm = 39.2092, GNorm = 1.7317, lr_0 = 2.7140e-04
Loss = 4.4713e-01, PNorm = 39.2292, GNorm = 1.3862, lr_0 = 2.6879e-04
Loss = 4.3756e-01, PNorm = 39.2504, GNorm = 3.9059, lr_0 = 2.6620e-04
Loss = 4.2714e-01, PNorm = 39.2660, GNorm = 3.1451, lr_0 = 2.6364e-04
Validation cross_entropy = 0.591746
Epoch 18
Loss = 3.7492e-01, PNorm = 39.2836, GNorm = 1.6367, lr_0 = 2.6110e-04
Loss = 4.2040e-01, PNorm = 39.3032, GNorm = 1.7019, lr_0 = 2.5859e-04
Loss = 4.7889e-01, PNorm = 39.3214, GNorm = 3.7685, lr_0 = 2.5610e-04
Loss = 4.3050e-01, PNorm = 39.3398, GNorm = 1.6890, lr_0 = 2.5363e-04
Loss = 4.7739e-01, PNorm = 39.3577, GNorm = 1.5171, lr_0 = 2.5119e-04
Loss = 4.7853e-01, PNorm = 39.3733, GNorm = 1.1073, lr_0 = 2.4877e-04
Loss = 4.0067e-01, PNorm = 39.3913, GNorm = 1.7492, lr_0 = 2.4638e-04
Loss = 4.2333e-01, PNorm = 39.4117, GNorm = 2.6994, lr_0 = 2.4400e-04
Validation cross_entropy = 0.619461
Epoch 19
Loss = 4.5184e-01, PNorm = 39.4252, GNorm = 1.4056, lr_0 = 2.4142e-04
Loss = 4.6765e-01, PNorm = 39.4375, GNorm = 3.4178, lr_0 = 2.3910e-04
Loss = 3.9815e-01, PNorm = 39.4536, GNorm = 1.3013, lr_0 = 2.3679e-04
Loss = 4.4468e-01, PNorm = 39.4723, GNorm = 3.0435, lr_0 = 2.3451e-04
Loss = 3.9202e-01, PNorm = 39.4919, GNorm = 3.9239, lr_0 = 2.3226e-04
Loss = 4.1181e-01, PNorm = 39.5087, GNorm = 4.0982, lr_0 = 2.3002e-04
Loss = 4.8226e-01, PNorm = 39.5238, GNorm = 2.1846, lr_0 = 2.2780e-04
Loss = 4.1137e-01, PNorm = 39.5401, GNorm = 1.5429, lr_0 = 2.2561e-04
Loss = 4.1041e-01, PNorm = 39.5573, GNorm = 3.7312, lr_0 = 2.2344e-04
Validation cross_entropy = 0.596441
Epoch 20
Loss = 4.0680e-01, PNorm = 39.5747, GNorm = 2.4263, lr_0 = 2.2129e-04
Loss = 4.3680e-01, PNorm = 39.5911, GNorm = 2.1495, lr_0 = 2.1916e-04
Loss = 4.2262e-01, PNorm = 39.6069, GNorm = 1.7045, lr_0 = 2.1705e-04
Loss = 4.2424e-01, PNorm = 39.6230, GNorm = 5.0444, lr_0 = 2.1496e-04
Loss = 4.5375e-01, PNorm = 39.6355, GNorm = 1.8963, lr_0 = 2.1289e-04
Loss = 4.1894e-01, PNorm = 39.6494, GNorm = 3.0691, lr_0 = 2.1084e-04
Loss = 4.3798e-01, PNorm = 39.6652, GNorm = 2.6864, lr_0 = 2.0881e-04
Loss = 4.1641e-01, PNorm = 39.6825, GNorm = 3.0060, lr_0 = 2.0680e-04
Validation cross_entropy = 0.606142
Epoch 21
Loss = 4.1992e-01, PNorm = 39.6969, GNorm = 3.0017, lr_0 = 2.0481e-04
Loss = 3.8552e-01, PNorm = 39.7114, GNorm = 4.1868, lr_0 = 2.0283e-04
Loss = 4.2664e-01, PNorm = 39.7286, GNorm = 1.6527, lr_0 = 2.0088e-04
Loss = 3.7410e-01, PNorm = 39.7455, GNorm = 3.0666, lr_0 = 1.9895e-04
Loss = 4.7304e-01, PNorm = 39.7581, GNorm = 2.1713, lr_0 = 1.9703e-04
Loss = 3.7277e-01, PNorm = 39.7702, GNorm = 1.4130, lr_0 = 1.9514e-04
Loss = 3.8938e-01, PNorm = 39.7832, GNorm = 2.2266, lr_0 = 1.9326e-04
Loss = 4.1708e-01, PNorm = 39.7956, GNorm = 1.7650, lr_0 = 1.9140e-04
Loss = 3.8482e-01, PNorm = 39.8076, GNorm = 2.2569, lr_0 = 1.8955e-04
Validation cross_entropy = 0.603303
Epoch 22
Loss = 4.2528e-01, PNorm = 39.8213, GNorm = 2.4561, lr_0 = 1.8755e-04
Loss = 3.6175e-01, PNorm = 39.8357, GNorm = 2.2916, lr_0 = 1.8574e-04
Loss = 3.5883e-01, PNorm = 39.8509, GNorm = 1.5109, lr_0 = 1.8395e-04
Loss = 4.2600e-01, PNorm = 39.8652, GNorm = 2.5396, lr_0 = 1.8218e-04
Loss = 3.9872e-01, PNorm = 39.8774, GNorm = 3.7546, lr_0 = 1.8043e-04
Loss = 3.6267e-01, PNorm = 39.8917, GNorm = 2.6501, lr_0 = 1.7869e-04
Loss = 4.0628e-01, PNorm = 39.9031, GNorm = 4.6954, lr_0 = 1.7697e-04
Loss = 4.7988e-01, PNorm = 39.9128, GNorm = 3.1909, lr_0 = 1.7527e-04
Validation cross_entropy = 0.592828
Epoch 23
Loss = 3.9592e-01, PNorm = 39.9229, GNorm = 2.8419, lr_0 = 1.7358e-04
Loss = 4.1007e-01, PNorm = 39.9323, GNorm = 1.3699, lr_0 = 1.7191e-04
Loss = 4.1706e-01, PNorm = 39.9443, GNorm = 2.6485, lr_0 = 1.7025e-04
Loss = 3.5008e-01, PNorm = 39.9573, GNorm = 4.6524, lr_0 = 1.6861e-04
Loss = 3.3822e-01, PNorm = 39.9699, GNorm = 1.8410, lr_0 = 1.6699e-04
Loss = 3.9318e-01, PNorm = 39.9826, GNorm = 3.4889, lr_0 = 1.6538e-04
Loss = 3.6761e-01, PNorm = 39.9949, GNorm = 1.7613, lr_0 = 1.6379e-04
Loss = 3.8678e-01, PNorm = 40.0066, GNorm = 2.0520, lr_0 = 1.6221e-04
Loss = 4.0390e-01, PNorm = 40.0190, GNorm = 1.7798, lr_0 = 1.6065e-04
Validation cross_entropy = 0.619939
Epoch 24
Loss = 3.7621e-01, PNorm = 40.0323, GNorm = 2.2966, lr_0 = 1.5895e-04
Loss = 4.2462e-01, PNorm = 40.0448, GNorm = 2.2913, lr_0 = 1.5742e-04
Loss = 3.5128e-01, PNorm = 40.0563, GNorm = 2.4642, lr_0 = 1.5590e-04
Loss = 3.9550e-01, PNorm = 40.0668, GNorm = 2.2404, lr_0 = 1.5440e-04
Loss = 3.5408e-01, PNorm = 40.0780, GNorm = 2.0917, lr_0 = 1.5292e-04
Loss = 4.0728e-01, PNorm = 40.0889, GNorm = 2.1243, lr_0 = 1.5144e-04
Loss = 3.9498e-01, PNorm = 40.0997, GNorm = 1.6267, lr_0 = 1.4999e-04
Loss = 3.8376e-01, PNorm = 40.1104, GNorm = 1.8791, lr_0 = 1.4854e-04
Loss = 3.7802e-01, PNorm = 40.1192, GNorm = 2.1945, lr_0 = 1.4711e-04
Validation cross_entropy = 0.600832
Epoch 25
Loss = 3.7823e-01, PNorm = 40.1288, GNorm = 6.3235, lr_0 = 1.4570e-04
Loss = 4.1342e-01, PNorm = 40.1387, GNorm = 5.4813, lr_0 = 1.4429e-04
Loss = 3.3100e-01, PNorm = 40.1503, GNorm = 3.0436, lr_0 = 1.4290e-04
Loss = 3.6328e-01, PNorm = 40.1610, GNorm = 4.9503, lr_0 = 1.4153e-04
Loss = 3.4955e-01, PNorm = 40.1718, GNorm = 2.4673, lr_0 = 1.4016e-04
Loss = 3.5246e-01, PNorm = 40.1826, GNorm = 1.9988, lr_0 = 1.3882e-04
Loss = 4.1646e-01, PNorm = 40.1932, GNorm = 2.1445, lr_0 = 1.3748e-04
Loss = 4.0917e-01, PNorm = 40.2026, GNorm = 1.7318, lr_0 = 1.3616e-04
Validation cross_entropy = 0.604208
Epoch 26
Loss = 3.5629e-01, PNorm = 40.2112, GNorm = 3.2360, lr_0 = 1.3484e-04
Loss = 4.3446e-01, PNorm = 40.2201, GNorm = 1.4312, lr_0 = 1.3355e-04
Loss = 3.6862e-01, PNorm = 40.2297, GNorm = 1.8607, lr_0 = 1.3226e-04
Loss = 3.4793e-01, PNorm = 40.2401, GNorm = 1.5176, lr_0 = 1.3099e-04
Loss = 3.5598e-01, PNorm = 40.2506, GNorm = 2.0581, lr_0 = 1.2973e-04
Loss = 3.5000e-01, PNorm = 40.2603, GNorm = 3.3019, lr_0 = 1.2848e-04
Loss = 3.8201e-01, PNorm = 40.2686, GNorm = 2.0545, lr_0 = 1.2724e-04
Loss = 3.9692e-01, PNorm = 40.2764, GNorm = 2.2693, lr_0 = 1.2601e-04
Loss = 3.2001e-01, PNorm = 40.2840, GNorm = 1.5153, lr_0 = 1.2480e-04
Validation cross_entropy = 0.607985
Epoch 27
Loss = 3.7404e-01, PNorm = 40.2938, GNorm = 2.4344, lr_0 = 1.2348e-04
Loss = 3.9591e-01, PNorm = 40.3029, GNorm = 1.8639, lr_0 = 1.2229e-04
Loss = 3.5426e-01, PNorm = 40.3117, GNorm = 2.1352, lr_0 = 1.2111e-04
Loss = 3.4180e-01, PNorm = 40.3210, GNorm = 2.1142, lr_0 = 1.1995e-04
Loss = 3.6823e-01, PNorm = 40.3295, GNorm = 4.1264, lr_0 = 1.1879e-04
Loss = 3.7539e-01, PNorm = 40.3381, GNorm = 5.9582, lr_0 = 1.1765e-04
Loss = 3.8786e-01, PNorm = 40.3462, GNorm = 1.5276, lr_0 = 1.1652e-04
Loss = 3.5139e-01, PNorm = 40.3542, GNorm = 2.4556, lr_0 = 1.1539e-04
Validation cross_entropy = 0.611789
Epoch 28
Loss = 3.6913e-01, PNorm = 40.3625, GNorm = 2.8451, lr_0 = 1.1428e-04
Loss = 4.0054e-01, PNorm = 40.3704, GNorm = 3.2484, lr_0 = 1.1318e-04
Loss = 3.6120e-01, PNorm = 40.3781, GNorm = 1.4194, lr_0 = 1.1209e-04
Loss = 3.3099e-01, PNorm = 40.3859, GNorm = 2.9806, lr_0 = 1.1101e-04
Loss = 3.5488e-01, PNorm = 40.3929, GNorm = 2.7494, lr_0 = 1.0995e-04
Loss = 3.5120e-01, PNorm = 40.4006, GNorm = 4.9742, lr_0 = 1.0889e-04
Loss = 3.4228e-01, PNorm = 40.4082, GNorm = 3.0829, lr_0 = 1.0784e-04
Loss = 3.2324e-01, PNorm = 40.4161, GNorm = 1.5527, lr_0 = 1.0680e-04
Loss = 3.9907e-01, PNorm = 40.4239, GNorm = 3.4538, lr_0 = 1.0577e-04
Validation cross_entropy = 0.618499
Epoch 29
Loss = 3.2928e-01, PNorm = 40.4328, GNorm = 3.8682, lr_0 = 1.0465e-04
Loss = 3.8428e-01, PNorm = 40.4409, GNorm = 5.6565, lr_0 = 1.0364e-04
Loss = 3.5511e-01, PNorm = 40.4477, GNorm = 3.0461, lr_0 = 1.0265e-04
Loss = 3.1753e-01, PNorm = 40.4540, GNorm = 3.1322, lr_0 = 1.0166e-04
Loss = 3.5164e-01, PNorm = 40.4611, GNorm = 3.8185, lr_0 = 1.0068e-04
Loss = 3.6968e-01, PNorm = 40.4697, GNorm = 1.6157, lr_0 = 1.0000e-04
Loss = 3.2366e-01, PNorm = 40.4775, GNorm = 1.6684, lr_0 = 1.0000e-04
Loss = 3.7721e-01, PNorm = 40.4848, GNorm = 2.0344, lr_0 = 1.0000e-04
Validation cross_entropy = 0.602938
Model 0 best validation cross_entropy = 0.584802 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.440200
Ensemble test cross_entropy = 0.440200
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.440200
Overall test cross_entropy = 0.440200 +/- 0.000000
Elapsed time = 0:14:06
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121219__0.1_HOMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 39 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 39 SMILES are invalid.
Warning: 349 SMILES are invalid.
Total size = 4,287 | train size = 4,287 | val size = 38,593 | test size = 4,287
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1097e+00, PNorm = 34.0519, GNorm = 0.6910, lr_0 = 1.5824e-04
Loss = 1.0663e+00, PNorm = 34.0545, GNorm = 1.1446, lr_0 = 2.1118e-04
Loss = 1.0649e+00, PNorm = 34.0593, GNorm = 0.7722, lr_0 = 2.6412e-04
Loss = 1.0389e+00, PNorm = 34.0684, GNorm = 1.1647, lr_0 = 3.1706e-04
Loss = 1.0396e+00, PNorm = 34.0810, GNorm = 0.6936, lr_0 = 3.7000e-04
Loss = 1.0042e+00, PNorm = 34.1032, GNorm = 2.3128, lr_0 = 4.2294e-04
Loss = 9.9473e-01, PNorm = 34.1279, GNorm = 1.7938, lr_0 = 4.7588e-04
Loss = 9.8075e-01, PNorm = 34.1560, GNorm = 2.1031, lr_0 = 5.2882e-04
Validation cross_entropy = 0.932917
Epoch 1
Loss = 8.9780e-01, PNorm = 34.2020, GNorm = 0.8054, lr_0 = 5.8706e-04
Loss = 9.0192e-01, PNorm = 34.2500, GNorm = 2.1675, lr_0 = 6.4000e-04
Loss = 9.0780e-01, PNorm = 34.2958, GNorm = 4.2639, lr_0 = 6.9294e-04
Loss = 8.9973e-01, PNorm = 34.3392, GNorm = 0.7756, lr_0 = 7.4588e-04
Loss = 8.6370e-01, PNorm = 34.3903, GNorm = 1.3497, lr_0 = 7.9882e-04
Loss = 8.5191e-01, PNorm = 34.4401, GNorm = 1.2026, lr_0 = 8.5176e-04
Loss = 8.6973e-01, PNorm = 34.4945, GNorm = 2.5524, lr_0 = 9.0471e-04
Loss = 8.4697e-01, PNorm = 34.5444, GNorm = 0.7576, lr_0 = 9.5765e-04
Loss = 8.4836e-01, PNorm = 34.6109, GNorm = 1.4324, lr_0 = 9.9807e-04
Validation cross_entropy = 0.832143
Epoch 2
Loss = 8.2243e-01, PNorm = 34.6887, GNorm = 3.3787, lr_0 = 9.8846e-04
Loss = 8.4324e-01, PNorm = 34.7509, GNorm = 2.0341, lr_0 = 9.7894e-04
Loss = 7.9790e-01, PNorm = 34.8285, GNorm = 0.6340, lr_0 = 9.6952e-04
Loss = 8.0613e-01, PNorm = 34.8927, GNorm = 0.9039, lr_0 = 9.6018e-04
Loss = 7.0112e-01, PNorm = 34.9690, GNorm = 1.3903, lr_0 = 9.5094e-04
Loss = 7.2213e-01, PNorm = 35.0390, GNorm = 0.7686, lr_0 = 9.4178e-04
Loss = 7.2759e-01, PNorm = 35.1118, GNorm = 2.2468, lr_0 = 9.3271e-04
Loss = 7.3601e-01, PNorm = 35.1798, GNorm = 3.6033, lr_0 = 9.2373e-04
Validation cross_entropy = 0.779276
Epoch 3
Loss = 7.0286e-01, PNorm = 35.2343, GNorm = 1.2107, lr_0 = 9.1484e-04
Loss = 6.6353e-01, PNorm = 35.3064, GNorm = 0.7592, lr_0 = 9.0603e-04
Loss = 6.7902e-01, PNorm = 35.3658, GNorm = 2.3882, lr_0 = 8.9731e-04
Loss = 6.7857e-01, PNorm = 35.4127, GNorm = 1.4866, lr_0 = 8.8867e-04
Loss = 7.2853e-01, PNorm = 35.4685, GNorm = 5.3008, lr_0 = 8.8011e-04
Loss = 6.5714e-01, PNorm = 35.5191, GNorm = 1.1420, lr_0 = 8.7164e-04
Loss = 7.2153e-01, PNorm = 35.5805, GNorm = 1.8407, lr_0 = 8.6325e-04
Loss = 7.3637e-01, PNorm = 35.6334, GNorm = 6.7744, lr_0 = 8.5493e-04
Loss = 7.1108e-01, PNorm = 35.6868, GNorm = 1.3117, lr_0 = 8.4670e-04
Validation cross_entropy = 0.681797
Epoch 4
Loss = 6.9297e-01, PNorm = 35.7470, GNorm = 1.5277, lr_0 = 8.3774e-04
Loss = 6.1971e-01, PNorm = 35.8059, GNorm = 0.9310, lr_0 = 8.2967e-04
Loss = 6.4618e-01, PNorm = 35.8603, GNorm = 1.0158, lr_0 = 8.2169e-04
Loss = 6.5171e-01, PNorm = 35.9129, GNorm = 1.3548, lr_0 = 8.1377e-04
Loss = 6.1890e-01, PNorm = 35.9720, GNorm = 2.3963, lr_0 = 8.0594e-04
Loss = 6.0676e-01, PNorm = 36.0112, GNorm = 2.0875, lr_0 = 7.9818e-04
Loss = 6.5521e-01, PNorm = 36.0567, GNorm = 1.4688, lr_0 = 7.9050e-04
Loss = 6.5267e-01, PNorm = 36.0928, GNorm = 2.7538, lr_0 = 7.8288e-04
Validation cross_entropy = 0.704675
Epoch 5
Loss = 5.5734e-01, PNorm = 36.1332, GNorm = 2.4073, lr_0 = 7.7535e-04
Loss = 6.9186e-01, PNorm = 36.1729, GNorm = 2.3254, lr_0 = 7.6788e-04
Loss = 6.2147e-01, PNorm = 36.2142, GNorm = 1.2975, lr_0 = 7.6049e-04
Loss = 5.8430e-01, PNorm = 36.2636, GNorm = 1.9991, lr_0 = 7.5317e-04
Loss = 6.2708e-01, PNorm = 36.3139, GNorm = 2.1977, lr_0 = 7.4591e-04
Loss = 6.4078e-01, PNorm = 36.3554, GNorm = 4.0904, lr_0 = 7.3873e-04
Loss = 6.3492e-01, PNorm = 36.3844, GNorm = 1.3786, lr_0 = 7.3162e-04
Loss = 6.4373e-01, PNorm = 36.4214, GNorm = 3.5563, lr_0 = 7.2458e-04
Loss = 5.9474e-01, PNorm = 36.4610, GNorm = 0.8946, lr_0 = 7.1760e-04
Validation cross_entropy = 0.652295
Epoch 6
Loss = 5.9233e-01, PNorm = 36.5065, GNorm = 1.4840, lr_0 = 7.1069e-04
Loss = 6.1787e-01, PNorm = 36.5483, GNorm = 1.2697, lr_0 = 7.0385e-04
Loss = 6.0568e-01, PNorm = 36.5932, GNorm = 2.4592, lr_0 = 6.9707e-04
Loss = 5.9192e-01, PNorm = 36.6318, GNorm = 1.0628, lr_0 = 6.9036e-04
Loss = 6.1024e-01, PNorm = 36.6676, GNorm = 3.5755, lr_0 = 6.8371e-04
Loss = 6.0001e-01, PNorm = 36.7051, GNorm = 2.3066, lr_0 = 6.7713e-04
Loss = 5.4966e-01, PNorm = 36.7379, GNorm = 1.6643, lr_0 = 6.7061e-04
Loss = 6.5501e-01, PNorm = 36.7766, GNorm = 4.9137, lr_0 = 6.6415e-04
Loss = 6.4266e-01, PNorm = 36.8128, GNorm = 3.2119, lr_0 = 6.5776e-04
Validation cross_entropy = 0.665346
Epoch 7
Loss = 5.9497e-01, PNorm = 36.8570, GNorm = 1.6211, lr_0 = 6.5143e-04
Loss = 5.8003e-01, PNorm = 36.9031, GNorm = 4.1351, lr_0 = 6.4515e-04
Loss = 5.9110e-01, PNorm = 36.9449, GNorm = 6.4760, lr_0 = 6.3894e-04
Loss = 6.0631e-01, PNorm = 36.9714, GNorm = 2.1953, lr_0 = 6.3279e-04
Loss = 6.1433e-01, PNorm = 37.0001, GNorm = 1.5080, lr_0 = 6.2670e-04
Loss = 5.6127e-01, PNorm = 37.0359, GNorm = 1.0660, lr_0 = 6.2066e-04
Loss = 6.1502e-01, PNorm = 37.0697, GNorm = 2.0000, lr_0 = 6.1469e-04
Loss = 5.7779e-01, PNorm = 37.1121, GNorm = 1.7834, lr_0 = 6.0877e-04
Validation cross_entropy = 0.622375
Epoch 8
Loss = 5.6722e-01, PNorm = 37.1527, GNorm = 3.9552, lr_0 = 6.0233e-04
Loss = 5.8873e-01, PNorm = 37.1871, GNorm = 1.4753, lr_0 = 5.9653e-04
Loss = 6.1237e-01, PNorm = 37.2147, GNorm = 0.8045, lr_0 = 5.9078e-04
Loss = 6.0455e-01, PNorm = 37.2472, GNorm = 1.6978, lr_0 = 5.8510e-04
Loss = 5.8799e-01, PNorm = 37.2764, GNorm = 1.7917, lr_0 = 5.7946e-04
Loss = 5.8653e-01, PNorm = 37.3076, GNorm = 2.9525, lr_0 = 5.7388e-04
Loss = 5.7192e-01, PNorm = 37.3427, GNorm = 1.8614, lr_0 = 5.6836e-04
Loss = 5.1203e-01, PNorm = 37.3744, GNorm = 1.1624, lr_0 = 5.6289e-04
Loss = 5.3279e-01, PNorm = 37.4050, GNorm = 1.1037, lr_0 = 5.5747e-04
Validation cross_entropy = 0.608387
Epoch 9
Loss = 5.4163e-01, PNorm = 37.4401, GNorm = 1.6470, lr_0 = 5.5210e-04
Loss = 5.1729e-01, PNorm = 37.4732, GNorm = 1.8886, lr_0 = 5.4678e-04
Loss = 5.5637e-01, PNorm = 37.5104, GNorm = 1.0700, lr_0 = 5.4152e-04
Loss = 5.5673e-01, PNorm = 37.5415, GNorm = 2.7395, lr_0 = 5.3630e-04
Loss = 5.2035e-01, PNorm = 37.5685, GNorm = 1.5265, lr_0 = 5.3114e-04
Loss = 5.3646e-01, PNorm = 37.5952, GNorm = 2.2182, lr_0 = 5.2603e-04
Loss = 5.2759e-01, PNorm = 37.6234, GNorm = 1.6058, lr_0 = 5.2096e-04
Loss = 5.8869e-01, PNorm = 37.6503, GNorm = 1.8659, lr_0 = 5.1595e-04
Validation cross_entropy = 0.605326
Epoch 10
Loss = 4.5851e-01, PNorm = 37.6790, GNorm = 1.6888, lr_0 = 5.1098e-04
Loss = 5.2240e-01, PNorm = 37.7109, GNorm = 2.2173, lr_0 = 5.0606e-04
Loss = 5.2679e-01, PNorm = 37.7430, GNorm = 2.9591, lr_0 = 5.0119e-04
Loss = 5.2207e-01, PNorm = 37.7705, GNorm = 2.1426, lr_0 = 4.9636e-04
Loss = 5.0409e-01, PNorm = 37.8010, GNorm = 1.6101, lr_0 = 4.9158e-04
Loss = 4.6503e-01, PNorm = 37.8328, GNorm = 1.7004, lr_0 = 4.8685e-04
Loss = 5.3673e-01, PNorm = 37.8618, GNorm = 1.4740, lr_0 = 4.8216e-04
Loss = 5.7925e-01, PNorm = 37.8832, GNorm = 1.6600, lr_0 = 4.7752e-04
Loss = 5.6831e-01, PNorm = 37.9028, GNorm = 1.8066, lr_0 = 4.7292e-04
Validation cross_entropy = 0.601400
Epoch 11
Loss = 4.9071e-01, PNorm = 37.9307, GNorm = 1.8856, lr_0 = 4.6837e-04
Loss = 5.6655e-01, PNorm = 37.9675, GNorm = 4.3776, lr_0 = 4.6386e-04
Loss = 5.4337e-01, PNorm = 37.9984, GNorm = 2.4282, lr_0 = 4.5939e-04
Loss = 5.0246e-01, PNorm = 38.0262, GNorm = 1.4827, lr_0 = 4.5497e-04
Loss = 5.3427e-01, PNorm = 38.0548, GNorm = 4.2265, lr_0 = 4.5059e-04
Loss = 4.9185e-01, PNorm = 38.0815, GNorm = 3.0220, lr_0 = 4.4625e-04
Loss = 5.4825e-01, PNorm = 38.1037, GNorm = 2.0629, lr_0 = 4.4196e-04
Loss = 5.1849e-01, PNorm = 38.1277, GNorm = 1.1320, lr_0 = 4.3770e-04
Validation cross_entropy = 0.606642
Epoch 12
Loss = 5.1479e-01, PNorm = 38.1601, GNorm = 2.0763, lr_0 = 4.3307e-04
Loss = 5.5956e-01, PNorm = 38.1886, GNorm = 4.3134, lr_0 = 4.2890e-04
Loss = 4.8862e-01, PNorm = 38.2176, GNorm = 1.2537, lr_0 = 4.2477e-04
Loss = 4.6825e-01, PNorm = 38.2488, GNorm = 2.1408, lr_0 = 4.2068e-04
Loss = 5.1184e-01, PNorm = 38.2731, GNorm = 1.3725, lr_0 = 4.1663e-04
Loss = 5.3632e-01, PNorm = 38.2975, GNorm = 2.2119, lr_0 = 4.1262e-04
Loss = 4.9176e-01, PNorm = 38.3218, GNorm = 1.7544, lr_0 = 4.0864e-04
Loss = 5.4867e-01, PNorm = 38.3457, GNorm = 3.0005, lr_0 = 4.0471e-04
Loss = 4.7698e-01, PNorm = 38.3693, GNorm = 2.2329, lr_0 = 4.0081e-04
Validation cross_entropy = 0.598489
Epoch 13
Loss = 4.9524e-01, PNorm = 38.3960, GNorm = 3.3129, lr_0 = 3.9695e-04
Loss = 4.7909e-01, PNorm = 38.4277, GNorm = 4.5613, lr_0 = 3.9313e-04
Loss = 4.5487e-01, PNorm = 38.4561, GNorm = 1.4422, lr_0 = 3.8935e-04
Loss = 4.7191e-01, PNorm = 38.4836, GNorm = 1.5147, lr_0 = 3.8560e-04
Loss = 5.2629e-01, PNorm = 38.5108, GNorm = 1.8439, lr_0 = 3.8189e-04
Loss = 4.8109e-01, PNorm = 38.5395, GNorm = 1.7641, lr_0 = 3.7821e-04
Loss = 5.0193e-01, PNorm = 38.5631, GNorm = 2.4037, lr_0 = 3.7457e-04
Loss = 5.2658e-01, PNorm = 38.5825, GNorm = 2.8001, lr_0 = 3.7096e-04
Loss = 4.6414e-01, PNorm = 38.6007, GNorm = 2.2711, lr_0 = 3.6739e-04
Validation cross_entropy = 0.600615
Epoch 14
Loss = 4.9711e-01, PNorm = 38.6228, GNorm = 4.0616, lr_0 = 3.6385e-04
Loss = 5.0025e-01, PNorm = 38.6503, GNorm = 1.3465, lr_0 = 3.6035e-04
Loss = 5.1172e-01, PNorm = 38.6764, GNorm = 2.4080, lr_0 = 3.5688e-04
Loss = 4.7203e-01, PNorm = 38.7015, GNorm = 2.7464, lr_0 = 3.5344e-04
Loss = 4.7532e-01, PNorm = 38.7268, GNorm = 0.9698, lr_0 = 3.5004e-04
Loss = 4.6115e-01, PNorm = 38.7520, GNorm = 2.9428, lr_0 = 3.4667e-04
Loss = 4.7843e-01, PNorm = 38.7724, GNorm = 3.8629, lr_0 = 3.4333e-04
Loss = 4.7741e-01, PNorm = 38.7901, GNorm = 3.4272, lr_0 = 3.4003e-04
Validation cross_entropy = 0.609891
Epoch 15
Loss = 3.9091e-01, PNorm = 38.8054, GNorm = 3.2215, lr_0 = 3.3675e-04
Loss = 4.7852e-01, PNorm = 38.8293, GNorm = 1.1853, lr_0 = 3.3351e-04
Loss = 4.0800e-01, PNorm = 38.8560, GNorm = 1.8188, lr_0 = 3.3030e-04
Loss = 4.8590e-01, PNorm = 38.8795, GNorm = 1.4134, lr_0 = 3.2712e-04
Loss = 4.9519e-01, PNorm = 38.8972, GNorm = 1.3243, lr_0 = 3.2397e-04
Loss = 4.1642e-01, PNorm = 38.9218, GNorm = 3.4972, lr_0 = 3.2085e-04
Loss = 5.0180e-01, PNorm = 38.9446, GNorm = 1.4515, lr_0 = 3.1776e-04
Loss = 4.9656e-01, PNorm = 38.9637, GNorm = 3.6342, lr_0 = 3.1470e-04
Loss = 4.5666e-01, PNorm = 38.9823, GNorm = 1.7793, lr_0 = 3.1167e-04
Validation cross_entropy = 0.583795
Epoch 16
Loss = 4.6502e-01, PNorm = 39.0024, GNorm = 4.1734, lr_0 = 3.0837e-04
Loss = 4.3005e-01, PNorm = 39.0228, GNorm = 1.9043, lr_0 = 3.0540e-04
Loss = 4.1293e-01, PNorm = 39.0480, GNorm = 0.9579, lr_0 = 3.0246e-04
Loss = 4.3060e-01, PNorm = 39.0685, GNorm = 2.3506, lr_0 = 2.9955e-04
Loss = 4.4263e-01, PNorm = 39.0892, GNorm = 2.0321, lr_0 = 2.9667e-04
Loss = 4.6351e-01, PNorm = 39.1110, GNorm = 1.0431, lr_0 = 2.9381e-04
Loss = 4.5066e-01, PNorm = 39.1305, GNorm = 1.7601, lr_0 = 2.9098e-04
Loss = 4.2578e-01, PNorm = 39.1531, GNorm = 1.8912, lr_0 = 2.8818e-04
Validation cross_entropy = 0.593167
Epoch 17
Loss = 4.2556e-01, PNorm = 39.1709, GNorm = 2.1140, lr_0 = 2.8541e-04
Loss = 4.5028e-01, PNorm = 39.1844, GNorm = 2.6602, lr_0 = 2.8266e-04
Loss = 4.6832e-01, PNorm = 39.2040, GNorm = 2.6327, lr_0 = 2.7994e-04
Loss = 4.5314e-01, PNorm = 39.2248, GNorm = 1.5138, lr_0 = 2.7724e-04
Loss = 4.1754e-01, PNorm = 39.2474, GNorm = 1.2188, lr_0 = 2.7457e-04
Loss = 4.2974e-01, PNorm = 39.2678, GNorm = 3.6382, lr_0 = 2.7193e-04
Loss = 4.4319e-01, PNorm = 39.2870, GNorm = 4.6060, lr_0 = 2.6931e-04
Loss = 4.5514e-01, PNorm = 39.3027, GNorm = 2.4920, lr_0 = 2.6672e-04
Loss = 4.1386e-01, PNorm = 39.3179, GNorm = 1.4617, lr_0 = 2.6415e-04
Validation cross_entropy = 0.593814
Epoch 18
Loss = 4.0302e-01, PNorm = 39.3330, GNorm = 1.5332, lr_0 = 2.6161e-04
Loss = 4.6392e-01, PNorm = 39.3525, GNorm = 1.6171, lr_0 = 2.5909e-04
Loss = 4.1114e-01, PNorm = 39.3708, GNorm = 2.6366, lr_0 = 2.5659e-04
Loss = 4.1783e-01, PNorm = 39.3874, GNorm = 1.5680, lr_0 = 2.5412e-04
Loss = 4.6176e-01, PNorm = 39.4047, GNorm = 1.6613, lr_0 = 2.5168e-04
Loss = 3.6291e-01, PNorm = 39.4216, GNorm = 1.3537, lr_0 = 2.4925e-04
Loss = 4.2733e-01, PNorm = 39.4406, GNorm = 1.0267, lr_0 = 2.4685e-04
Loss = 4.2505e-01, PNorm = 39.4580, GNorm = 3.4147, lr_0 = 2.4448e-04
Validation cross_entropy = 0.592594
Epoch 19
Loss = 4.1363e-01, PNorm = 39.4741, GNorm = 1.5602, lr_0 = 2.4212e-04
Loss = 4.2243e-01, PNorm = 39.4894, GNorm = 4.6149, lr_0 = 2.3979e-04
Loss = 4.3392e-01, PNorm = 39.5039, GNorm = 5.4536, lr_0 = 2.3748e-04
Loss = 4.2261e-01, PNorm = 39.5220, GNorm = 2.3442, lr_0 = 2.3520e-04
Loss = 4.1835e-01, PNorm = 39.5380, GNorm = 1.3083, lr_0 = 2.3293e-04
Loss = 4.1831e-01, PNorm = 39.5582, GNorm = 2.5521, lr_0 = 2.3069e-04
Loss = 3.6376e-01, PNorm = 39.5741, GNorm = 2.9632, lr_0 = 2.2847e-04
Loss = 4.0222e-01, PNorm = 39.5871, GNorm = 1.4678, lr_0 = 2.2627e-04
Loss = 4.3650e-01, PNorm = 39.6054, GNorm = 2.2285, lr_0 = 2.2409e-04
Validation cross_entropy = 0.585048
Epoch 20
Loss = 4.0608e-01, PNorm = 39.6226, GNorm = 1.1352, lr_0 = 2.2172e-04
Loss = 4.0786e-01, PNorm = 39.6372, GNorm = 1.2367, lr_0 = 2.1958e-04
Loss = 3.8497e-01, PNorm = 39.6534, GNorm = 1.9937, lr_0 = 2.1747e-04
Loss = 3.7940e-01, PNorm = 39.6709, GNorm = 1.9831, lr_0 = 2.1537e-04
Loss = 4.0615e-01, PNorm = 39.6848, GNorm = 5.4264, lr_0 = 2.1330e-04
Loss = 4.6138e-01, PNorm = 39.6976, GNorm = 4.0676, lr_0 = 2.1125e-04
Loss = 3.9713e-01, PNorm = 39.7108, GNorm = 2.6853, lr_0 = 2.0921e-04
Loss = 4.0078e-01, PNorm = 39.7259, GNorm = 1.9799, lr_0 = 2.0720e-04
Loss = 4.1467e-01, PNorm = 39.7402, GNorm = 2.2471, lr_0 = 2.0520e-04
Validation cross_entropy = 0.593423
Epoch 21
Loss = 3.5264e-01, PNorm = 39.7573, GNorm = 3.3823, lr_0 = 2.0323e-04
Loss = 4.1109e-01, PNorm = 39.7748, GNorm = 1.5847, lr_0 = 2.0127e-04
Loss = 3.9910e-01, PNorm = 39.7898, GNorm = 2.6104, lr_0 = 1.9933e-04
Loss = 4.0734e-01, PNorm = 39.8058, GNorm = 2.1847, lr_0 = 1.9741e-04
Loss = 4.3488e-01, PNorm = 39.8201, GNorm = 2.2470, lr_0 = 1.9551e-04
Loss = 3.3464e-01, PNorm = 39.8322, GNorm = 1.8101, lr_0 = 1.9363e-04
Loss = 3.9445e-01, PNorm = 39.8448, GNorm = 2.3980, lr_0 = 1.9177e-04
Loss = 4.0406e-01, PNorm = 39.8573, GNorm = 1.3093, lr_0 = 1.8992e-04
Validation cross_entropy = 0.592773
Epoch 22
Loss = 3.8106e-01, PNorm = 39.8694, GNorm = 1.2344, lr_0 = 1.8809e-04
Loss = 3.6545e-01, PNorm = 39.8826, GNorm = 1.6877, lr_0 = 1.8628e-04
Loss = 3.7702e-01, PNorm = 39.8953, GNorm = 2.1282, lr_0 = 1.8449e-04
Loss = 4.1574e-01, PNorm = 39.9078, GNorm = 2.8758, lr_0 = 1.8271e-04
Loss = 4.2340e-01, PNorm = 39.9193, GNorm = 2.2958, lr_0 = 1.8095e-04
Loss = 3.7537e-01, PNorm = 39.9307, GNorm = 1.3170, lr_0 = 1.7921e-04
Loss = 3.8867e-01, PNorm = 39.9458, GNorm = 1.8000, lr_0 = 1.7748e-04
Loss = 3.8599e-01, PNorm = 39.9578, GNorm = 1.9566, lr_0 = 1.7578e-04
Loss = 3.7175e-01, PNorm = 39.9697, GNorm = 4.4071, lr_0 = 1.7408e-04
Validation cross_entropy = 0.586915
Epoch 23
Loss = 3.4572e-01, PNorm = 39.9821, GNorm = 1.5288, lr_0 = 1.7241e-04
Loss = 3.2356e-01, PNorm = 39.9952, GNorm = 2.1336, lr_0 = 1.7075e-04
Loss = 3.9427e-01, PNorm = 40.0070, GNorm = 1.7706, lr_0 = 1.6910e-04
Loss = 3.4501e-01, PNorm = 40.0190, GNorm = 1.5218, lr_0 = 1.6747e-04
Loss = 3.9187e-01, PNorm = 40.0307, GNorm = 4.7952, lr_0 = 1.6586e-04
Loss = 4.2199e-01, PNorm = 40.0426, GNorm = 3.1942, lr_0 = 1.6427e-04
Loss = 4.0233e-01, PNorm = 40.0548, GNorm = 1.7109, lr_0 = 1.6268e-04
Loss = 3.8598e-01, PNorm = 40.0647, GNorm = 2.7334, lr_0 = 1.6112e-04
Validation cross_entropy = 0.584552
Epoch 24
Loss = 3.9501e-01, PNorm = 40.0785, GNorm = 2.2273, lr_0 = 1.5941e-04
Loss = 3.7073e-01, PNorm = 40.0908, GNorm = 1.2608, lr_0 = 1.5788e-04
Loss = 3.9926e-01, PNorm = 40.1022, GNorm = 2.0180, lr_0 = 1.5636e-04
Loss = 3.5980e-01, PNorm = 40.1136, GNorm = 3.8348, lr_0 = 1.5485e-04
Loss = 3.6834e-01, PNorm = 40.1231, GNorm = 3.0301, lr_0 = 1.5336e-04
Loss = 3.2620e-01, PNorm = 40.1359, GNorm = 3.6345, lr_0 = 1.5188e-04
Loss = 3.8996e-01, PNorm = 40.1473, GNorm = 1.5730, lr_0 = 1.5042e-04
Loss = 4.0003e-01, PNorm = 40.1587, GNorm = 4.6309, lr_0 = 1.4897e-04
Loss = 4.0981e-01, PNorm = 40.1680, GNorm = 2.8141, lr_0 = 1.4754e-04
Validation cross_entropy = 0.581479
Epoch 25
Loss = 3.6512e-01, PNorm = 40.1774, GNorm = 3.2109, lr_0 = 1.4612e-04
Loss = 3.5505e-01, PNorm = 40.1878, GNorm = 3.2973, lr_0 = 1.4471e-04
Loss = 4.3103e-01, PNorm = 40.1998, GNorm = 4.6400, lr_0 = 1.4332e-04
Loss = 3.4972e-01, PNorm = 40.2103, GNorm = 2.7530, lr_0 = 1.4194e-04
Loss = 3.9011e-01, PNorm = 40.2205, GNorm = 4.1936, lr_0 = 1.4057e-04
Loss = 3.3857e-01, PNorm = 40.2313, GNorm = 3.8176, lr_0 = 1.3922e-04
Loss = 3.4545e-01, PNorm = 40.2409, GNorm = 4.0341, lr_0 = 1.3788e-04
Loss = 3.1657e-01, PNorm = 40.2502, GNorm = 2.2695, lr_0 = 1.3655e-04
Validation cross_entropy = 0.596254
Epoch 26
Loss = 3.4642e-01, PNorm = 40.2595, GNorm = 2.3111, lr_0 = 1.3524e-04
Loss = 3.4093e-01, PNorm = 40.2688, GNorm = 3.9207, lr_0 = 1.3393e-04
Loss = 3.1702e-01, PNorm = 40.2782, GNorm = 1.4683, lr_0 = 1.3264e-04
Loss = 3.2796e-01, PNorm = 40.2876, GNorm = 1.3330, lr_0 = 1.3137e-04
Loss = 3.6763e-01, PNorm = 40.2964, GNorm = 1.8443, lr_0 = 1.3010e-04
Loss = 3.8361e-01, PNorm = 40.3041, GNorm = 1.6627, lr_0 = 1.2885e-04
Loss = 3.4574e-01, PNorm = 40.3118, GNorm = 1.0816, lr_0 = 1.2761e-04
Loss = 3.3377e-01, PNorm = 40.3221, GNorm = 1.7051, lr_0 = 1.2638e-04
Loss = 4.0343e-01, PNorm = 40.3319, GNorm = 2.3780, lr_0 = 1.2516e-04
Validation cross_entropy = 0.586190
Epoch 27
Loss = 3.5773e-01, PNorm = 40.3433, GNorm = 4.8994, lr_0 = 1.2384e-04
Loss = 3.1577e-01, PNorm = 40.3535, GNorm = 3.8570, lr_0 = 1.2265e-04
Loss = 3.4976e-01, PNorm = 40.3632, GNorm = 2.0092, lr_0 = 1.2147e-04
Loss = 3.8105e-01, PNorm = 40.3729, GNorm = 2.5068, lr_0 = 1.2030e-04
Loss = 3.5681e-01, PNorm = 40.3823, GNorm = 2.2837, lr_0 = 1.1914e-04
Loss = 3.4652e-01, PNorm = 40.3901, GNorm = 1.8364, lr_0 = 1.1799e-04
Loss = 3.5486e-01, PNorm = 40.3976, GNorm = 4.0748, lr_0 = 1.1685e-04
Loss = 3.3776e-01, PNorm = 40.4047, GNorm = 2.8291, lr_0 = 1.1573e-04
Loss = 3.4182e-01, PNorm = 40.4120, GNorm = 2.1207, lr_0 = 1.1462e-04
Validation cross_entropy = 0.592173
Epoch 28
Loss = 3.4339e-01, PNorm = 40.4205, GNorm = 1.8225, lr_0 = 1.1351e-04
Loss = 3.8551e-01, PNorm = 40.4296, GNorm = 5.1648, lr_0 = 1.1242e-04
Loss = 3.3887e-01, PNorm = 40.4364, GNorm = 2.5251, lr_0 = 1.1134e-04
Loss = 3.4630e-01, PNorm = 40.4438, GNorm = 2.1701, lr_0 = 1.1026e-04
Loss = 3.1914e-01, PNorm = 40.4517, GNorm = 3.5128, lr_0 = 1.0920e-04
Loss = 3.4505e-01, PNorm = 40.4590, GNorm = 5.8076, lr_0 = 1.0815e-04
Loss = 3.3206e-01, PNorm = 40.4666, GNorm = 2.7440, lr_0 = 1.0711e-04
Loss = 3.4493e-01, PNorm = 40.4746, GNorm = 1.8594, lr_0 = 1.0608e-04
Validation cross_entropy = 0.588992
Epoch 29
Loss = 2.9995e-01, PNorm = 40.4819, GNorm = 1.3192, lr_0 = 1.0506e-04
Loss = 3.0927e-01, PNorm = 40.4892, GNorm = 2.1818, lr_0 = 1.0405e-04
Loss = 3.4339e-01, PNorm = 40.4981, GNorm = 2.7360, lr_0 = 1.0304e-04
Loss = 3.4265e-01, PNorm = 40.5067, GNorm = 2.7998, lr_0 = 1.0205e-04
Loss = 3.4994e-01, PNorm = 40.5133, GNorm = 1.7772, lr_0 = 1.0107e-04
Loss = 3.5393e-01, PNorm = 40.5206, GNorm = 2.4404, lr_0 = 1.0010e-04
Loss = 3.0728e-01, PNorm = 40.5271, GNorm = 1.8297, lr_0 = 1.0000e-04
Loss = 3.2588e-01, PNorm = 40.5341, GNorm = 2.7634, lr_0 = 1.0000e-04
Loss = 3.5499e-01, PNorm = 40.5407, GNorm = 3.2166, lr_0 = 1.0000e-04
Validation cross_entropy = 0.610545
Model 0 best validation cross_entropy = 0.581479 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.347155
Ensemble test cross_entropy = 0.347155
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.347155
Overall test cross_entropy = 0.347155 +/- 0.000000
Elapsed time = 0:15:50
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 4 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 4 SMILES are invalid.
Warning: 384 SMILES are invalid.
Total size = 428 | train size = 428 | val size = 42,452 | test size = 428
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.084757
Epoch 1
Loss = 1.1028e+00, PNorm = 34.0555, GNorm = 1.3365, lr_0 = 7.7500e-04
Validation cross_entropy = 1.043689
Epoch 2
Loss = 1.0534e+00, PNorm = 34.0943, GNorm = 1.2401, lr_0 = 9.4019e-04
Validation cross_entropy = 1.028766
Epoch 3
Loss = 9.7208e-01, PNorm = 34.1564, GNorm = 0.8657, lr_0 = 8.3967e-04
Validation cross_entropy = 0.955307
Epoch 4
Loss = 9.3992e-01, PNorm = 34.2194, GNorm = 0.7236, lr_0 = 7.5764e-04
Validation cross_entropy = 1.158052
Epoch 5
Loss = 9.8299e-01, PNorm = 34.2739, GNorm = 0.6441, lr_0 = 6.7664e-04
Validation cross_entropy = 1.032050
Epoch 6
Validation cross_entropy = 0.995138
Epoch 7
Loss = 1.0138e+00, PNorm = 34.3288, GNorm = 2.1394, lr_0 = 6.0430e-04
Validation cross_entropy = 0.948657
Epoch 8
Loss = 8.4792e-01, PNorm = 34.3780, GNorm = 0.6954, lr_0 = 5.4526e-04
Validation cross_entropy = 0.899028
Epoch 9
Loss = 8.0835e-01, PNorm = 34.4282, GNorm = 2.4790, lr_0 = 4.9200e-04
Validation cross_entropy = 0.879641
Epoch 10
Loss = 7.7095e-01, PNorm = 34.4819, GNorm = 1.4437, lr_0 = 4.3940e-04
Validation cross_entropy = 0.943037
Epoch 11
Loss = 7.8057e-01, PNorm = 34.5251, GNorm = 6.2452, lr_0 = 3.9647e-04
Validation cross_entropy = 0.859095
Epoch 12
Loss = 7.7926e-01, PNorm = 34.5652, GNorm = 3.1030, lr_0 = 3.5408e-04
Validation cross_entropy = 0.845170
Epoch 13
Validation cross_entropy = 0.841650
Epoch 14
Loss = 8.0072e-01, PNorm = 34.6063, GNorm = 3.0914, lr_0 = 3.1623e-04
Validation cross_entropy = 0.833976
Epoch 15
Loss = 7.5085e-01, PNorm = 34.6402, GNorm = 2.5061, lr_0 = 2.8534e-04
Validation cross_entropy = 0.847810
Epoch 16
Loss = 7.2062e-01, PNorm = 34.6760, GNorm = 1.7903, lr_0 = 2.5483e-04
Validation cross_entropy = 0.835787
Epoch 17
Loss = 7.2922e-01, PNorm = 34.7045, GNorm = 3.7888, lr_0 = 2.2994e-04
Validation cross_entropy = 0.843160
Epoch 18
Loss = 6.6507e-01, PNorm = 34.7295, GNorm = 5.5614, lr_0 = 2.0747e-04
Validation cross_entropy = 0.845130
Epoch 19
Loss = 6.9954e-01, PNorm = 34.7544, GNorm = 4.1124, lr_0 = 1.8529e-04
Validation cross_entropy = 0.809877
Epoch 20
Validation cross_entropy = 0.829367
Epoch 21
Loss = 7.8823e-01, PNorm = 34.7770, GNorm = 7.4159, lr_0 = 1.6548e-04
Validation cross_entropy = 0.809812
Epoch 22
Loss = 6.4221e-01, PNorm = 34.7944, GNorm = 0.9464, lr_0 = 1.4932e-04
Validation cross_entropy = 0.838376
Epoch 23
Loss = 6.6702e-01, PNorm = 34.8126, GNorm = 7.9672, lr_0 = 1.3335e-04
Validation cross_entropy = 0.817412
Epoch 24
Loss = 6.5616e-01, PNorm = 34.8269, GNorm = 4.9193, lr_0 = 1.2033e-04
Validation cross_entropy = 0.806250
Epoch 25
Loss = 6.3498e-01, PNorm = 34.8400, GNorm = 2.4923, lr_0 = 1.0857e-04
Validation cross_entropy = 0.812936
Epoch 26
Loss = 6.2278e-01, PNorm = 34.8524, GNorm = 4.7227, lr_0 = 1.0000e-04
Validation cross_entropy = 0.808200
Epoch 27
Validation cross_entropy = 0.836105
Epoch 28
Loss = 5.7155e-01, PNorm = 34.8644, GNorm = 5.0910, lr_0 = 1.0000e-04
Validation cross_entropy = 0.846121
Epoch 29
Loss = 6.2573e-01, PNorm = 34.8755, GNorm = 5.4803, lr_0 = 1.0000e-04
Validation cross_entropy = 0.801864
Model 0 best validation cross_entropy = 0.801864 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.618410
Ensemble test cross_entropy = 0.618410
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.618410
Overall test cross_entropy = 0.618410 +/- 0.000000
Elapsed time = 0:14:47
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 5 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 5 SMILES are invalid.
Warning: 383 SMILES are invalid.
Total size = 427 | train size = 427 | val size = 42,453 | test size = 427
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.096430
Epoch 1
Loss = 1.0922e+00, PNorm = 34.0568, GNorm = 1.5630, lr_0 = 7.7500e-04
Validation cross_entropy = 1.081260
Epoch 2
Loss = 1.0312e+00, PNorm = 34.0930, GNorm = 0.7672, lr_0 = 9.4019e-04
Validation cross_entropy = 1.023046
Epoch 3
Loss = 1.0242e+00, PNorm = 34.1450, GNorm = 1.5711, lr_0 = 8.3967e-04
Validation cross_entropy = 1.043736
Epoch 4
Loss = 9.5826e-01, PNorm = 34.1988, GNorm = 1.4921, lr_0 = 7.5764e-04
Validation cross_entropy = 0.985609
Epoch 5
Loss = 9.1919e-01, PNorm = 34.2642, GNorm = 2.4009, lr_0 = 6.7664e-04
Validation cross_entropy = 1.116815
Epoch 6
Validation cross_entropy = 0.966056
Epoch 7
Loss = 9.5946e-01, PNorm = 34.3178, GNorm = 2.1224, lr_0 = 6.0430e-04
Validation cross_entropy = 0.923699
Epoch 8
Loss = 8.1338e-01, PNorm = 34.3601, GNorm = 1.2967, lr_0 = 5.4526e-04
Validation cross_entropy = 0.905293
Epoch 9
Loss = 7.5959e-01, PNorm = 34.4120, GNorm = 3.8628, lr_0 = 4.8697e-04
Validation cross_entropy = 0.906379
Epoch 10
Loss = 8.1760e-01, PNorm = 34.4526, GNorm = 1.3399, lr_0 = 4.3940e-04
Validation cross_entropy = 0.877862
Epoch 11
Loss = 7.6559e-01, PNorm = 34.4973, GNorm = 1.1968, lr_0 = 3.9242e-04
Validation cross_entropy = 0.881006
Epoch 12
Loss = 7.3833e-01, PNorm = 34.5384, GNorm = 1.1297, lr_0 = 3.5408e-04
Validation cross_entropy = 0.868610
Epoch 13
Validation cross_entropy = 0.899545
Epoch 14
Loss = 8.0487e-01, PNorm = 34.5817, GNorm = 7.1755, lr_0 = 3.1623e-04
Validation cross_entropy = 0.908903
Epoch 15
Loss = 7.5771e-01, PNorm = 34.6103, GNorm = 3.8334, lr_0 = 2.8534e-04
Validation cross_entropy = 0.855815
Epoch 16
Loss = 7.1684e-01, PNorm = 34.6414, GNorm = 2.1875, lr_0 = 2.5483e-04
Validation cross_entropy = 0.869039
Epoch 17
Loss = 6.7909e-01, PNorm = 34.6689, GNorm = 2.9407, lr_0 = 2.2994e-04
Validation cross_entropy = 0.869907
Epoch 18
Loss = 6.5815e-01, PNorm = 34.6961, GNorm = 2.9669, lr_0 = 2.0535e-04
Validation cross_entropy = 0.853316
Epoch 19
Loss = 6.6622e-01, PNorm = 34.7183, GNorm = 3.1345, lr_0 = 1.8529e-04
Loss = 5.6497e-01, PNorm = 34.7205, GNorm = 2.3855, lr_0 = 1.8340e-04
Validation cross_entropy = 0.860593
Epoch 20
Validation cross_entropy = 0.850351
Epoch 21
Loss = 5.6023e-01, PNorm = 34.7413, GNorm = 1.1814, lr_0 = 1.6548e-04
Validation cross_entropy = 0.856489
Epoch 22
Loss = 6.6724e-01, PNorm = 34.7624, GNorm = 2.2397, lr_0 = 1.4779e-04
Validation cross_entropy = 0.849373
Epoch 23
Loss = 6.4481e-01, PNorm = 34.7794, GNorm = 0.8641, lr_0 = 1.3335e-04
Validation cross_entropy = 0.859471
Epoch 24
Loss = 6.3076e-01, PNorm = 34.7961, GNorm = 5.1487, lr_0 = 1.1909e-04
Validation cross_entropy = 0.847900
Epoch 25
Loss = 6.1017e-01, PNorm = 34.8104, GNorm = 0.9294, lr_0 = 1.0746e-04
Validation cross_entropy = 0.850723
Epoch 26
Loss = 5.9392e-01, PNorm = 34.8234, GNorm = 1.0336, lr_0 = 1.0000e-04
Loss = 8.2785e-01, PNorm = 34.8246, GNorm = 3.8722, lr_0 = 1.0000e-04
Validation cross_entropy = 0.854109
Epoch 27
Validation cross_entropy = 0.850746
Epoch 28
Loss = 6.1152e-01, PNorm = 34.8371, GNorm = 4.6234, lr_0 = 1.0000e-04
Validation cross_entropy = 0.844872
Epoch 29
Loss = 5.8566e-01, PNorm = 34.8503, GNorm = 2.1852, lr_0 = 1.0000e-04
Validation cross_entropy = 0.847720
Model 0 best validation cross_entropy = 0.844872 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.589921
Ensemble test cross_entropy = 0.589921
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.589921
Overall test cross_entropy = 0.589921 +/- 0.000000
Elapsed time = 0:15:12
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121220__0.01_LUMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 2 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 2 SMILES are invalid.
Warning: 386 SMILES are invalid.
Total size = 430 | train size = 430 | val size = 42,450 | test size = 430
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Validation cross_entropy = 1.083701
Epoch 1
Loss = 1.0606e+00, PNorm = 34.0584, GNorm = 1.6522, lr_0 = 7.7500e-04
Validation cross_entropy = 1.170559
Epoch 2
Loss = 1.0808e+00, PNorm = 34.0925, GNorm = 2.0686, lr_0 = 9.4019e-04
Validation cross_entropy = 1.043129
Epoch 3
Loss = 9.6676e-01, PNorm = 34.1517, GNorm = 1.0665, lr_0 = 8.3967e-04
Validation cross_entropy = 1.040138
Epoch 4
Loss = 9.4859e-01, PNorm = 34.2066, GNorm = 2.3027, lr_0 = 7.5764e-04
Validation cross_entropy = 0.962113
Epoch 5
Loss = 8.9769e-01, PNorm = 34.2691, GNorm = 2.5230, lr_0 = 6.8363e-04
Validation cross_entropy = 0.942252
Epoch 6
Loss = 8.2785e-01, PNorm = 34.3319, GNorm = 1.3784, lr_0 = 6.1054e-04
Validation cross_entropy = 0.927000
Epoch 7
Validation cross_entropy = 1.059717
Epoch 8
Loss = 8.0129e-01, PNorm = 34.3897, GNorm = 2.7198, lr_0 = 5.4526e-04
Validation cross_entropy = 0.940411
Epoch 9
Loss = 7.0379e-01, PNorm = 34.4332, GNorm = 1.3401, lr_0 = 4.9200e-04
Validation cross_entropy = 0.882221
Epoch 10
Loss = 7.3215e-01, PNorm = 34.4725, GNorm = 1.6688, lr_0 = 4.4394e-04
Validation cross_entropy = 0.864178
Epoch 11
Loss = 7.1109e-01, PNorm = 34.5203, GNorm = 1.8128, lr_0 = 3.9647e-04
Validation cross_entropy = 0.871853
Epoch 12
Loss = 7.0070e-01, PNorm = 34.5572, GNorm = 2.4005, lr_0 = 3.5774e-04
Validation cross_entropy = 0.859843
Epoch 13
Loss = 7.0402e-01, PNorm = 34.5947, GNorm = 9.8204, lr_0 = 3.1950e-04
Validation cross_entropy = 0.852940
Epoch 14
Validation cross_entropy = 0.914791
Epoch 15
Loss = 6.0052e-01, PNorm = 34.6235, GNorm = 2.1270, lr_0 = 2.8828e-04
Validation cross_entropy = 0.856050
Epoch 16
Loss = 6.8336e-01, PNorm = 34.6498, GNorm = 7.3072, lr_0 = 2.5746e-04
Validation cross_entropy = 0.904199
Epoch 17
Loss = 7.0922e-01, PNorm = 34.6702, GNorm = 0.8761, lr_0 = 2.3231e-04
Validation cross_entropy = 0.865567
Epoch 18
Loss = 6.2392e-01, PNorm = 34.6912, GNorm = 3.5450, lr_0 = 2.0747e-04
Validation cross_entropy = 0.847369
Epoch 19
Loss = 6.3430e-01, PNorm = 34.7090, GNorm = 1.8801, lr_0 = 1.8721e-04
Validation cross_entropy = 0.841965
Epoch 20
Loss = 6.3522e-01, PNorm = 34.7280, GNorm = 3.3144, lr_0 = 1.6892e-04
Loss = 6.7961e-01, PNorm = 34.7293, GNorm = 1.8896, lr_0 = 1.6719e-04
Validation cross_entropy = 0.851425
Epoch 21
Validation cross_entropy = 0.864368
Epoch 22
Loss = 6.6837e-01, PNorm = 34.7445, GNorm = 1.6220, lr_0 = 1.5086e-04
Validation cross_entropy = 0.840037
Epoch 23
Loss = 5.9849e-01, PNorm = 34.7598, GNorm = 1.9980, lr_0 = 1.3473e-04
Validation cross_entropy = 0.858123
Epoch 24
Loss = 5.6263e-01, PNorm = 34.7735, GNorm = 3.1700, lr_0 = 1.2157e-04
Validation cross_entropy = 0.848735
Epoch 25
Loss = 6.1298e-01, PNorm = 34.7854, GNorm = 2.9939, lr_0 = 1.0969e-04
Validation cross_entropy = 0.874925
Epoch 26
Loss = 6.1215e-01, PNorm = 34.7958, GNorm = 6.6619, lr_0 = 1.0000e-04
Validation cross_entropy = 0.840903
Epoch 27
Loss = 6.0133e-01, PNorm = 34.8059, GNorm = 4.8171, lr_0 = 1.0000e-04
Loss = 5.3677e-01, PNorm = 34.8068, GNorm = 2.5331, lr_0 = 1.0000e-04
Validation cross_entropy = 0.845033
Epoch 28
Validation cross_entropy = 0.859733
Epoch 29
Loss = 6.7077e-01, PNorm = 34.8178, GNorm = 4.5593, lr_0 = 1.0000e-04
Validation cross_entropy = 0.842144
Model 0 best validation cross_entropy = 0.840037 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.613449
Ensemble test cross_entropy = 0.613449
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.613449
Overall test cross_entropy = 0.613449 +/- 0.000000
Elapsed time = 0:15:16
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 8 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 8 SMILES are invalid.
Warning: 380 SMILES are invalid.
Total size = 857 | train size = 857 | val size = 42,023 | test size = 857
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1335e+00, PNorm = 34.0527, GNorm = 1.5447, lr_0 = 3.9118e-04
Validation cross_entropy = 1.104628
Epoch 1
Loss = 1.1390e+00, PNorm = 34.0624, GNorm = 2.4952, lr_0 = 6.8235e-04
Loss = 1.0994e+00, PNorm = 34.0847, GNorm = 0.8568, lr_0 = 9.4706e-04
Validation cross_entropy = 1.064934
Epoch 2
Loss = 1.0582e+00, PNorm = 34.1313, GNorm = 0.7817, lr_0 = 9.5740e-04
Loss = 1.0179e+00, PNorm = 34.1990, GNorm = 0.7070, lr_0 = 9.1219e-04
Validation cross_entropy = 0.994314
Epoch 3
Loss = 9.6291e-01, PNorm = 34.2759, GNorm = 0.5754, lr_0 = 8.6492e-04
Validation cross_entropy = 0.904386
Epoch 4
Loss = 9.2714e-01, PNorm = 34.3487, GNorm = 2.3836, lr_0 = 8.2010e-04
Loss = 8.8250e-01, PNorm = 34.4081, GNorm = 1.5183, lr_0 = 7.8137e-04
Validation cross_entropy = 0.862847
Epoch 5
Loss = 8.2658e-01, PNorm = 34.4767, GNorm = 0.6111, lr_0 = 7.4088e-04
Loss = 8.9355e-01, PNorm = 34.5231, GNorm = 3.4304, lr_0 = 7.0589e-04
Validation cross_entropy = 0.980228
Epoch 6
Loss = 8.6408e-01, PNorm = 34.5691, GNorm = 2.2095, lr_0 = 6.6931e-04
Validation cross_entropy = 0.841534
Epoch 7
Loss = 9.3147e-01, PNorm = 34.6145, GNorm = 2.3550, lr_0 = 6.3463e-04
Loss = 8.0000e-01, PNorm = 34.6697, GNorm = 1.7650, lr_0 = 6.0466e-04
Validation cross_entropy = 0.834969
Epoch 8
Loss = 7.5635e-01, PNorm = 34.7147, GNorm = 2.5333, lr_0 = 5.7611e-04
Loss = 7.3738e-01, PNorm = 34.7593, GNorm = 1.7119, lr_0 = 5.4890e-04
Validation cross_entropy = 0.851151
Epoch 9
Loss = 7.4074e-01, PNorm = 34.8093, GNorm = 2.5203, lr_0 = 5.2046e-04
Loss = 7.3673e-01, PNorm = 34.8521, GNorm = 2.5898, lr_0 = 4.9588e-04
Validation cross_entropy = 0.802665
Epoch 10
Loss = 7.1851e-01, PNorm = 34.8976, GNorm = 6.7797, lr_0 = 4.7019e-04
Validation cross_entropy = 0.783143
Epoch 11
Loss = 6.6414e-01, PNorm = 34.9400, GNorm = 2.1576, lr_0 = 4.4582e-04
Loss = 7.3942e-01, PNorm = 34.9755, GNorm = 7.3571, lr_0 = 4.2477e-04
Validation cross_entropy = 0.784028
Epoch 12
Loss = 7.8547e-01, PNorm = 35.0148, GNorm = 1.5429, lr_0 = 4.0276e-04
Loss = 7.1473e-01, PNorm = 35.0483, GNorm = 1.3333, lr_0 = 3.8374e-04
Validation cross_entropy = 0.819193
Epoch 13
Loss = 6.7624e-01, PNorm = 35.0876, GNorm = 2.0830, lr_0 = 3.6385e-04
Validation cross_entropy = 0.776715
Epoch 14
Loss = 6.1015e-01, PNorm = 35.1241, GNorm = 0.8822, lr_0 = 3.4500e-04
Loss = 6.8360e-01, PNorm = 35.1569, GNorm = 1.9347, lr_0 = 3.2871e-04
Validation cross_entropy = 0.772875
Epoch 15
Loss = 6.0488e-01, PNorm = 35.1908, GNorm = 6.8491, lr_0 = 3.1318e-04
Loss = 6.3881e-01, PNorm = 35.2196, GNorm = 1.1518, lr_0 = 2.9839e-04
Validation cross_entropy = 0.761236
Epoch 16
Loss = 6.1078e-01, PNorm = 35.2582, GNorm = 2.9209, lr_0 = 2.8293e-04
Loss = 6.2767e-01, PNorm = 35.2900, GNorm = 4.2927, lr_0 = 2.6957e-04
Validation cross_entropy = 0.737421
Epoch 17
Loss = 6.0164e-01, PNorm = 35.3196, GNorm = 1.5226, lr_0 = 2.5560e-04
Validation cross_entropy = 0.744705
Epoch 18
Loss = 6.1086e-01, PNorm = 35.3484, GNorm = 4.8085, lr_0 = 2.4236e-04
Loss = 6.2012e-01, PNorm = 35.3742, GNorm = 2.9724, lr_0 = 2.3091e-04
Validation cross_entropy = 0.741739
Epoch 19
Loss = 5.9872e-01, PNorm = 35.4056, GNorm = 1.5844, lr_0 = 2.1895e-04
Loss = 5.8958e-01, PNorm = 35.4322, GNorm = 7.2891, lr_0 = 2.0861e-04
Validation cross_entropy = 0.736615
Epoch 20
Loss = 5.3650e-01, PNorm = 35.4553, GNorm = 2.7201, lr_0 = 1.9780e-04
Validation cross_entropy = 0.730309
Epoch 21
Loss = 7.0286e-01, PNorm = 35.4771, GNorm = 1.6503, lr_0 = 1.8755e-04
Loss = 5.4923e-01, PNorm = 35.4966, GNorm = 7.6315, lr_0 = 1.7869e-04
Validation cross_entropy = 0.789225
Epoch 22
Loss = 5.4175e-01, PNorm = 35.5136, GNorm = 6.7078, lr_0 = 1.7025e-04
Loss = 6.3093e-01, PNorm = 35.5310, GNorm = 2.6621, lr_0 = 1.6221e-04
Validation cross_entropy = 0.736779
Epoch 23
Loss = 5.9464e-01, PNorm = 35.5479, GNorm = 1.0190, lr_0 = 1.5381e-04
Loss = 5.5167e-01, PNorm = 35.5639, GNorm = 1.1777, lr_0 = 1.4654e-04
Validation cross_entropy = 0.726118
Epoch 24
Loss = 5.4601e-01, PNorm = 35.5809, GNorm = 2.8969, lr_0 = 1.3895e-04
Validation cross_entropy = 0.748292
Epoch 25
Loss = 6.1723e-01, PNorm = 35.5960, GNorm = 3.2744, lr_0 = 1.3175e-04
Loss = 5.4721e-01, PNorm = 35.6089, GNorm = 4.5233, lr_0 = 1.2553e-04
Validation cross_entropy = 0.724950
Epoch 26
Loss = 5.1102e-01, PNorm = 35.6234, GNorm = 3.9288, lr_0 = 1.1902e-04
Loss = 5.2147e-01, PNorm = 35.6352, GNorm = 2.2537, lr_0 = 1.1340e-04
Validation cross_entropy = 0.729214
Epoch 27
Loss = 5.3706e-01, PNorm = 35.6487, GNorm = 7.1597, lr_0 = 1.0753e-04
Validation cross_entropy = 0.723020
Epoch 28
Loss = 4.3324e-01, PNorm = 35.6608, GNorm = 2.4813, lr_0 = 1.0195e-04
Loss = 5.2280e-01, PNorm = 35.6715, GNorm = 2.5484, lr_0 = 1.0000e-04
Validation cross_entropy = 0.731076
Epoch 29
Loss = 5.2911e-01, PNorm = 35.6831, GNorm = 2.6321, lr_0 = 1.0000e-04
Loss = 5.2002e-01, PNorm = 35.6948, GNorm = 2.1775, lr_0 = 1.0000e-04
Validation cross_entropy = 0.732130
Model 0 best validation cross_entropy = 0.723020 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.508704
Ensemble test cross_entropy = 0.508704
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.508704
Overall test cross_entropy = 0.508704 +/- 0.000000
Elapsed time = 0:15:12
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 9 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 9 SMILES are invalid.
Warning: 379 SMILES are invalid.
Total size = 856 | train size = 856 | val size = 42,024 | test size = 856
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.0859e+00, PNorm = 34.0539, GNorm = 1.0422, lr_0 = 3.9118e-04
Validation cross_entropy = 1.074801
Epoch 1
Loss = 1.0814e+00, PNorm = 34.0676, GNorm = 1.3838, lr_0 = 6.8235e-04
Loss = 1.0608e+00, PNorm = 34.1003, GNorm = 1.7944, lr_0 = 9.4706e-04
Validation cross_entropy = 1.023460
Epoch 2
Loss = 9.5518e-01, PNorm = 34.1708, GNorm = 0.7294, lr_0 = 9.5740e-04
Loss = 9.5159e-01, PNorm = 34.2460, GNorm = 3.5785, lr_0 = 9.1219e-04
Validation cross_entropy = 0.937718
Epoch 3
Loss = 9.4147e-01, PNorm = 34.3200, GNorm = 2.5023, lr_0 = 8.6492e-04
Validation cross_entropy = 0.910012
Epoch 4
Loss = 8.9708e-01, PNorm = 34.3843, GNorm = 0.7861, lr_0 = 8.2010e-04
Loss = 8.4353e-01, PNorm = 34.4392, GNorm = 2.3136, lr_0 = 7.8137e-04
Validation cross_entropy = 0.972010
Epoch 5
Loss = 8.9708e-01, PNorm = 34.5028, GNorm = 3.4679, lr_0 = 7.4088e-04
Loss = 8.3884e-01, PNorm = 34.5504, GNorm = 3.9362, lr_0 = 7.0589e-04
Validation cross_entropy = 0.851476
Epoch 6
Loss = 8.2287e-01, PNorm = 34.5955, GNorm = 0.9628, lr_0 = 6.6931e-04
Validation cross_entropy = 0.840701
Epoch 7
Loss = 8.5979e-01, PNorm = 34.6460, GNorm = 1.9833, lr_0 = 6.3463e-04
Loss = 7.7116e-01, PNorm = 34.6909, GNorm = 3.4164, lr_0 = 6.0466e-04
Validation cross_entropy = 0.913219
Epoch 8
Loss = 7.8818e-01, PNorm = 34.7389, GNorm = 1.2370, lr_0 = 5.7333e-04
Loss = 7.4930e-01, PNorm = 34.7860, GNorm = 3.0165, lr_0 = 5.4625e-04
Validation cross_entropy = 0.791348
Epoch 9
Loss = 6.2056e-01, PNorm = 34.8281, GNorm = 3.8868, lr_0 = 5.2046e-04
Loss = 7.5071e-01, PNorm = 34.8739, GNorm = 5.8722, lr_0 = 4.9588e-04
Validation cross_entropy = 0.863576
Epoch 10
Loss = 7.4713e-01, PNorm = 34.9202, GNorm = 2.0005, lr_0 = 4.7019e-04
Validation cross_entropy = 0.771846
Epoch 11
Loss = 6.7505e-01, PNorm = 34.9606, GNorm = 1.2853, lr_0 = 4.4582e-04
Loss = 6.7763e-01, PNorm = 34.9966, GNorm = 1.0273, lr_0 = 4.2477e-04
Validation cross_entropy = 0.915009
Epoch 12
Loss = 7.8859e-01, PNorm = 35.0283, GNorm = 1.1470, lr_0 = 4.0276e-04
Loss = 6.9286e-01, PNorm = 35.0580, GNorm = 0.9844, lr_0 = 3.8374e-04
Validation cross_entropy = 0.848828
Epoch 13
Loss = 6.7546e-01, PNorm = 35.0856, GNorm = 3.4400, lr_0 = 3.6385e-04
Validation cross_entropy = 0.766360
Epoch 14
Loss = 6.3207e-01, PNorm = 35.1172, GNorm = 4.0274, lr_0 = 3.4500e-04
Loss = 6.3340e-01, PNorm = 35.1446, GNorm = 2.1219, lr_0 = 3.2871e-04
Validation cross_entropy = 0.761885
Epoch 15
Loss = 5.8571e-01, PNorm = 35.1763, GNorm = 3.6877, lr_0 = 3.1167e-04
Loss = 6.5658e-01, PNorm = 35.2028, GNorm = 2.3690, lr_0 = 2.9695e-04
Validation cross_entropy = 0.754326
Epoch 16
Loss = 5.9480e-01, PNorm = 35.2277, GNorm = 7.1424, lr_0 = 2.8157e-04
Loss = 6.6984e-01, PNorm = 35.2507, GNorm = 1.4491, lr_0 = 2.6827e-04
Validation cross_entropy = 0.874549
Epoch 17
Loss = 6.3796e-01, PNorm = 35.2705, GNorm = 3.5185, lr_0 = 2.5560e-04
Validation cross_entropy = 0.760068
Epoch 18
Loss = 6.2949e-01, PNorm = 35.2902, GNorm = 1.8289, lr_0 = 2.4236e-04
Loss = 6.4468e-01, PNorm = 35.3102, GNorm = 4.3133, lr_0 = 2.3091e-04
Validation cross_entropy = 0.743520
Epoch 19
Loss = 5.4865e-01, PNorm = 35.3316, GNorm = 4.7785, lr_0 = 2.1895e-04
Loss = 6.2084e-01, PNorm = 35.3519, GNorm = 5.2812, lr_0 = 2.0861e-04
Validation cross_entropy = 0.794549
Epoch 20
Loss = 5.9294e-01, PNorm = 35.3737, GNorm = 4.0673, lr_0 = 1.9780e-04
Validation cross_entropy = 0.747863
Epoch 21
Loss = 6.7934e-01, PNorm = 35.3920, GNorm = 1.6291, lr_0 = 1.8755e-04
Loss = 5.7287e-01, PNorm = 35.4085, GNorm = 1.8014, lr_0 = 1.7869e-04
Validation cross_entropy = 0.773598
Epoch 22
Loss = 5.6904e-01, PNorm = 35.4265, GNorm = 4.9816, lr_0 = 1.6943e-04
Loss = 5.6791e-01, PNorm = 35.4415, GNorm = 3.3413, lr_0 = 1.6143e-04
Validation cross_entropy = 0.751404
Epoch 23
Loss = 5.5329e-01, PNorm = 35.4575, GNorm = 0.9673, lr_0 = 1.5306e-04
Loss = 5.5216e-01, PNorm = 35.4718, GNorm = 4.4324, lr_0 = 1.4584e-04
Loss = 5.1906e-01, PNorm = 35.4730, GNorm = 10.7056, lr_0 = 1.4513e-04
Validation cross_entropy = 0.772386
Epoch 24
Loss = 5.6330e-01, PNorm = 35.4857, GNorm = 1.3921, lr_0 = 1.3828e-04
Validation cross_entropy = 0.747715
Epoch 25
Loss = 4.3648e-01, PNorm = 35.4967, GNorm = 1.3748, lr_0 = 1.3175e-04
Loss = 5.7708e-01, PNorm = 35.5072, GNorm = 2.4434, lr_0 = 1.2553e-04
Validation cross_entropy = 0.748024
Epoch 26
Loss = 5.2279e-01, PNorm = 35.5195, GNorm = 3.8552, lr_0 = 1.1902e-04
Loss = 5.4744e-01, PNorm = 35.5308, GNorm = 5.7451, lr_0 = 1.1340e-04
Validation cross_entropy = 0.761557
Epoch 27
Loss = 5.6963e-01, PNorm = 35.5418, GNorm = 2.1226, lr_0 = 1.0753e-04
Validation cross_entropy = 0.754627
Epoch 28
Loss = 4.8317e-01, PNorm = 35.5521, GNorm = 2.0146, lr_0 = 1.0195e-04
Loss = 5.0425e-01, PNorm = 35.5622, GNorm = 1.6649, lr_0 = 1.0000e-04
Validation cross_entropy = 0.750004
Epoch 29
Loss = 5.3442e-01, PNorm = 35.5713, GNorm = 1.1085, lr_0 = 1.0000e-04
Loss = 5.5071e-01, PNorm = 35.5798, GNorm = 1.6496, lr_0 = 1.0000e-04
Validation cross_entropy = 0.763855
Model 0 best validation cross_entropy = 0.743520 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.575933
Ensemble test cross_entropy = 0.575933
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.575933
Overall test cross_entropy = 0.575933 +/- 0.000000
Elapsed time = 0:14:44
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121221__0.02_LUMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 9 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 9 SMILES are invalid.
Warning: 379 SMILES are invalid.
Total size = 856 | train size = 856 | val size = 42,024 | test size = 856
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1076e+00, PNorm = 34.0533, GNorm = 1.5135, lr_0 = 3.9118e-04
Validation cross_entropy = 1.069838
Epoch 1
Loss = 1.0728e+00, PNorm = 34.0642, GNorm = 1.1252, lr_0 = 6.8235e-04
Loss = 1.0624e+00, PNorm = 34.0936, GNorm = 1.3630, lr_0 = 9.4706e-04
Validation cross_entropy = 1.034076
Epoch 2
Loss = 1.0019e+00, PNorm = 34.1618, GNorm = 1.9224, lr_0 = 9.5740e-04
Loss = 9.7095e-01, PNorm = 34.2344, GNorm = 1.5949, lr_0 = 9.1219e-04
Validation cross_entropy = 1.218593
Epoch 3
Loss = 1.0584e+00, PNorm = 34.2860, GNorm = 1.4036, lr_0 = 8.6492e-04
Validation cross_entropy = 0.943102
Epoch 4
Loss = 9.1047e-01, PNorm = 34.3488, GNorm = 1.3440, lr_0 = 8.2010e-04
Loss = 8.8523e-01, PNorm = 34.4166, GNorm = 1.1723, lr_0 = 7.8137e-04
Validation cross_entropy = 0.943449
Epoch 5
Loss = 8.2372e-01, PNorm = 34.4709, GNorm = 1.6252, lr_0 = 7.4088e-04
Loss = 8.9394e-01, PNorm = 34.5132, GNorm = 2.3473, lr_0 = 7.0589e-04
Validation cross_entropy = 0.854740
Epoch 6
Loss = 8.5646e-01, PNorm = 34.5739, GNorm = 1.6479, lr_0 = 6.6931e-04
Validation cross_entropy = 0.844981
Epoch 7
Loss = 7.0004e-01, PNorm = 34.6188, GNorm = 2.4182, lr_0 = 6.3463e-04
Loss = 7.7989e-01, PNorm = 34.6669, GNorm = 2.9614, lr_0 = 6.0466e-04
Validation cross_entropy = 0.823822
Epoch 8
Loss = 8.1205e-01, PNorm = 34.7145, GNorm = 1.5036, lr_0 = 5.7333e-04
Loss = 7.8206e-01, PNorm = 34.7569, GNorm = 1.0967, lr_0 = 5.4625e-04
Validation cross_entropy = 1.006909
Epoch 9
Loss = 8.2920e-01, PNorm = 34.7971, GNorm = 2.9889, lr_0 = 5.2046e-04
Loss = 7.9754e-01, PNorm = 34.8394, GNorm = 1.3237, lr_0 = 4.9588e-04
Validation cross_entropy = 0.831359
Epoch 10
Loss = 7.5057e-01, PNorm = 34.8875, GNorm = 1.5461, lr_0 = 4.7019e-04
Validation cross_entropy = 0.810177
Epoch 11
Loss = 8.3023e-01, PNorm = 34.9370, GNorm = 2.2158, lr_0 = 4.4582e-04
Loss = 7.5167e-01, PNorm = 34.9687, GNorm = 1.3658, lr_0 = 4.2477e-04
Validation cross_entropy = 0.844089
Epoch 12
Loss = 7.4663e-01, PNorm = 35.0074, GNorm = 1.2153, lr_0 = 4.0276e-04
Loss = 7.3094e-01, PNorm = 35.0429, GNorm = 0.8377, lr_0 = 3.8374e-04
Validation cross_entropy = 0.786632
Epoch 13
Loss = 6.5776e-01, PNorm = 35.0845, GNorm = 0.9953, lr_0 = 3.6385e-04
Validation cross_entropy = 0.785940
Epoch 14
Loss = 6.7040e-01, PNorm = 35.1230, GNorm = 2.7148, lr_0 = 3.4500e-04
Loss = 6.3228e-01, PNorm = 35.1540, GNorm = 0.9533, lr_0 = 3.2871e-04
Validation cross_entropy = 0.780732
Epoch 15
Loss = 5.8566e-01, PNorm = 35.1904, GNorm = 1.8140, lr_0 = 3.1167e-04
Loss = 6.5388e-01, PNorm = 35.2195, GNorm = 1.7660, lr_0 = 2.9695e-04
Validation cross_entropy = 0.766747
Epoch 16
Loss = 6.1361e-01, PNorm = 35.2513, GNorm = 1.4980, lr_0 = 2.8157e-04
Loss = 6.3402e-01, PNorm = 35.2791, GNorm = 1.3174, lr_0 = 2.6827e-04
Validation cross_entropy = 0.768509
Epoch 17
Loss = 6.2187e-01, PNorm = 35.3082, GNorm = 1.4567, lr_0 = 2.5560e-04
Validation cross_entropy = 0.771625
Epoch 18
Loss = 7.1168e-01, PNorm = 35.3359, GNorm = 2.6237, lr_0 = 2.4236e-04
Loss = 5.8285e-01, PNorm = 35.3583, GNorm = 2.0055, lr_0 = 2.3091e-04
Validation cross_entropy = 0.798551
Epoch 19
Loss = 6.0550e-01, PNorm = 35.3822, GNorm = 4.6049, lr_0 = 2.1895e-04
Loss = 6.0329e-01, PNorm = 35.4027, GNorm = 9.2547, lr_0 = 2.0861e-04
Validation cross_entropy = 0.754091
Epoch 20
Loss = 5.8131e-01, PNorm = 35.4252, GNorm = 3.5667, lr_0 = 1.9780e-04
Validation cross_entropy = 0.757576
Epoch 21
Loss = 6.4084e-01, PNorm = 35.4445, GNorm = 3.4442, lr_0 = 1.8755e-04
Loss = 5.5697e-01, PNorm = 35.4644, GNorm = 1.5273, lr_0 = 1.7869e-04
Validation cross_entropy = 0.760819
Epoch 22
Loss = 6.0771e-01, PNorm = 35.4812, GNorm = 2.0615, lr_0 = 1.6943e-04
Loss = 5.5387e-01, PNorm = 35.4976, GNorm = 3.5571, lr_0 = 1.6143e-04
Validation cross_entropy = 0.771696
Epoch 23
Loss = 5.6868e-01, PNorm = 35.5157, GNorm = 5.3142, lr_0 = 1.5306e-04
Loss = 5.5134e-01, PNorm = 35.5292, GNorm = 4.9504, lr_0 = 1.4584e-04
Loss = 3.2468e-01, PNorm = 35.5305, GNorm = 5.2187, lr_0 = 1.4513e-04
Validation cross_entropy = 0.759001
Epoch 24
Loss = 5.4348e-01, PNorm = 35.5446, GNorm = 4.6012, lr_0 = 1.3828e-04
Validation cross_entropy = 0.831868
Epoch 25
Loss = 6.6249e-01, PNorm = 35.5568, GNorm = 7.0302, lr_0 = 1.3175e-04
Loss = 5.5212e-01, PNorm = 35.5665, GNorm = 3.1856, lr_0 = 1.2553e-04
Validation cross_entropy = 0.775310
Epoch 26
Loss = 5.7444e-01, PNorm = 35.5799, GNorm = 3.8882, lr_0 = 1.1902e-04
Loss = 5.2156e-01, PNorm = 35.5896, GNorm = 2.9104, lr_0 = 1.1340e-04
Validation cross_entropy = 0.760363
Epoch 27
Loss = 5.0148e-01, PNorm = 35.6017, GNorm = 0.8236, lr_0 = 1.0753e-04
Validation cross_entropy = 0.783727
Epoch 28
Loss = 6.5300e-01, PNorm = 35.6113, GNorm = 4.9861, lr_0 = 1.0195e-04
Loss = 5.5482e-01, PNorm = 35.6199, GNorm = 2.2384, lr_0 = 1.0000e-04
Validation cross_entropy = 0.784103
Epoch 29
Loss = 5.3958e-01, PNorm = 35.6298, GNorm = 4.8172, lr_0 = 1.0000e-04
Loss = 5.3721e-01, PNorm = 35.6392, GNorm = 3.4010, lr_0 = 1.0000e-04
Validation cross_entropy = 0.774252
Model 0 best validation cross_entropy = 0.754091 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.565534
Ensemble test cross_entropy = 0.565534
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.565534
Overall test cross_entropy = 0.565534 +/- 0.000000
Elapsed time = 0:15:27
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_0_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_0_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_0_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_0_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 26 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 26 SMILES are invalid.
Warning: 362 SMILES are invalid.
Total size = 4,300 | train size = 4,300 | val size = 38,580 | test size = 4,300
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.0968e+00, PNorm = 34.0522, GNorm = 1.2430, lr_0 = 1.5756e-04
Loss = 1.0901e+00, PNorm = 34.0536, GNorm = 0.6233, lr_0 = 2.0988e-04
Loss = 1.0740e+00, PNorm = 34.0581, GNorm = 0.5042, lr_0 = 2.6221e-04
Loss = 1.0426e+00, PNorm = 34.0671, GNorm = 1.4704, lr_0 = 3.1453e-04
Loss = 1.0136e+00, PNorm = 34.0824, GNorm = 1.6692, lr_0 = 3.6686e-04
Loss = 1.0145e+00, PNorm = 34.0998, GNorm = 2.8040, lr_0 = 4.1919e-04
Loss = 9.7470e-01, PNorm = 34.1257, GNorm = 2.1641, lr_0 = 4.7151e-04
Loss = 9.2555e-01, PNorm = 34.1634, GNorm = 4.2841, lr_0 = 5.2384e-04
Validation cross_entropy = 0.960697
Epoch 1
Loss = 9.3072e-01, PNorm = 34.2048, GNorm = 0.8791, lr_0 = 5.7616e-04
Loss = 8.8582e-01, PNorm = 34.2561, GNorm = 1.3515, lr_0 = 6.2849e-04
Loss = 9.2663e-01, PNorm = 34.3011, GNorm = 1.7640, lr_0 = 6.8081e-04
Loss = 8.8180e-01, PNorm = 34.3394, GNorm = 3.8200, lr_0 = 7.3314e-04
Loss = 8.2739e-01, PNorm = 34.3916, GNorm = 2.7314, lr_0 = 7.8547e-04
Loss = 8.6543e-01, PNorm = 34.4400, GNorm = 5.1403, lr_0 = 8.3779e-04
Loss = 8.7716e-01, PNorm = 34.4785, GNorm = 3.1516, lr_0 = 8.9012e-04
Loss = 8.2930e-01, PNorm = 34.5230, GNorm = 1.6192, lr_0 = 9.4244e-04
Loss = 8.3538e-01, PNorm = 34.5809, GNorm = 4.6571, lr_0 = 9.9477e-04
Validation cross_entropy = 0.845427
Epoch 2
Loss = 8.1697e-01, PNorm = 34.6451, GNorm = 3.3864, lr_0 = 9.9143e-04
Loss = 8.0156e-01, PNorm = 34.7016, GNorm = 4.6304, lr_0 = 9.8200e-04
Loss = 7.5703e-01, PNorm = 34.7688, GNorm = 1.0179, lr_0 = 9.7265e-04
Loss = 7.3552e-01, PNorm = 34.8304, GNorm = 1.7651, lr_0 = 9.6339e-04
Loss = 7.3455e-01, PNorm = 34.8953, GNorm = 5.8140, lr_0 = 9.5423e-04
Loss = 7.6141e-01, PNorm = 34.9460, GNorm = 6.2486, lr_0 = 9.4514e-04
Loss = 7.7807e-01, PNorm = 34.9945, GNorm = 5.9929, lr_0 = 9.3615e-04
Loss = 8.2654e-01, PNorm = 35.0369, GNorm = 2.6812, lr_0 = 9.2724e-04
Validation cross_entropy = 0.784909
Epoch 3
Loss = 6.9354e-01, PNorm = 35.0847, GNorm = 0.5414, lr_0 = 9.1842e-04
Loss = 7.3517e-01, PNorm = 35.1440, GNorm = 0.9447, lr_0 = 9.0968e-04
Loss = 7.4220e-01, PNorm = 35.2056, GNorm = 2.7924, lr_0 = 9.0102e-04
Loss = 6.5110e-01, PNorm = 35.2638, GNorm = 1.3063, lr_0 = 8.9244e-04
Loss = 6.7840e-01, PNorm = 35.3102, GNorm = 3.2915, lr_0 = 8.8395e-04
Loss = 7.9173e-01, PNorm = 35.3406, GNorm = 1.5564, lr_0 = 8.7554e-04
Loss = 6.9918e-01, PNorm = 35.3805, GNorm = 6.9632, lr_0 = 8.6721e-04
Loss = 7.1936e-01, PNorm = 35.4215, GNorm = 1.9111, lr_0 = 8.5895e-04
Loss = 7.2254e-01, PNorm = 35.4654, GNorm = 2.7831, lr_0 = 8.5078e-04
Validation cross_entropy = 0.708250
Epoch 4
Loss = 7.2139e-01, PNorm = 35.5153, GNorm = 1.2310, lr_0 = 8.4268e-04
Loss = 6.8910e-01, PNorm = 35.5592, GNorm = 3.3473, lr_0 = 8.3466e-04
Loss = 6.3654e-01, PNorm = 35.6039, GNorm = 4.8526, lr_0 = 8.2672e-04
Loss = 7.1254e-01, PNorm = 35.6491, GNorm = 2.2937, lr_0 = 8.1885e-04
Loss = 6.2940e-01, PNorm = 35.7013, GNorm = 1.0457, lr_0 = 8.1106e-04
Loss = 7.1511e-01, PNorm = 35.7430, GNorm = 1.7631, lr_0 = 8.0334e-04
Loss = 7.0142e-01, PNorm = 35.7696, GNorm = 2.4032, lr_0 = 7.9570e-04
Loss = 6.3357e-01, PNorm = 35.8096, GNorm = 2.2622, lr_0 = 7.8812e-04
Loss = 6.4798e-01, PNorm = 35.8540, GNorm = 1.4253, lr_0 = 7.8062e-04
Validation cross_entropy = 0.675161
Epoch 5
Loss = 6.5514e-01, PNorm = 35.9019, GNorm = 1.9330, lr_0 = 7.7319e-04
Loss = 6.2932e-01, PNorm = 35.9497, GNorm = 1.3898, lr_0 = 7.6584e-04
Loss = 6.3236e-01, PNorm = 35.9887, GNorm = 1.7229, lr_0 = 7.5855e-04
Loss = 7.0263e-01, PNorm = 36.0299, GNorm = 5.5960, lr_0 = 7.5133e-04
Loss = 7.1232e-01, PNorm = 36.0745, GNorm = 4.0331, lr_0 = 7.4418e-04
Loss = 6.9561e-01, PNorm = 36.1205, GNorm = 1.8048, lr_0 = 7.3710e-04
Loss = 6.5950e-01, PNorm = 36.1557, GNorm = 1.6128, lr_0 = 7.3008e-04
Loss = 6.7237e-01, PNorm = 36.1812, GNorm = 3.4125, lr_0 = 7.2313e-04
Validation cross_entropy = 0.763575
Epoch 6
Loss = 7.2214e-01, PNorm = 36.2102, GNorm = 7.2007, lr_0 = 7.1625e-04
Loss = 5.9644e-01, PNorm = 36.2506, GNorm = 4.8597, lr_0 = 7.0944e-04
Loss = 6.4996e-01, PNorm = 36.2870, GNorm = 1.8805, lr_0 = 7.0269e-04
Loss = 6.1928e-01, PNorm = 36.3306, GNorm = 4.1242, lr_0 = 6.9600e-04
Loss = 6.2865e-01, PNorm = 36.3621, GNorm = 3.4265, lr_0 = 6.8937e-04
Loss = 7.2454e-01, PNorm = 36.4023, GNorm = 6.5348, lr_0 = 6.8281e-04
Loss = 6.5206e-01, PNorm = 36.4405, GNorm = 1.3882, lr_0 = 6.7632e-04
Loss = 6.0542e-01, PNorm = 36.4813, GNorm = 4.6957, lr_0 = 6.6988e-04
Loss = 5.9016e-01, PNorm = 36.5183, GNorm = 2.4153, lr_0 = 6.6350e-04
Validation cross_entropy = 0.647335
Epoch 7
Loss = 6.3367e-01, PNorm = 36.5592, GNorm = 3.3449, lr_0 = 6.5719e-04
Loss = 5.9111e-01, PNorm = 36.5969, GNorm = 1.8329, lr_0 = 6.5094e-04
Loss = 6.0310e-01, PNorm = 36.6288, GNorm = 1.3224, lr_0 = 6.4474e-04
Loss = 5.9489e-01, PNorm = 36.6560, GNorm = 3.0718, lr_0 = 6.3861e-04
Loss = 5.7379e-01, PNorm = 36.6934, GNorm = 1.1191, lr_0 = 6.3253e-04
Loss = 6.1131e-01, PNorm = 36.7267, GNorm = 3.1693, lr_0 = 6.2651e-04
Loss = 6.2957e-01, PNorm = 36.7503, GNorm = 0.9426, lr_0 = 6.2055e-04
Loss = 6.0939e-01, PNorm = 36.7795, GNorm = 1.7293, lr_0 = 6.1464e-04
Validation cross_entropy = 0.648139
Epoch 8
Loss = 5.1120e-01, PNorm = 36.8119, GNorm = 3.5438, lr_0 = 6.0879e-04
Loss = 6.0241e-01, PNorm = 36.8493, GNorm = 6.1486, lr_0 = 6.0300e-04
Loss = 5.5585e-01, PNorm = 36.8853, GNorm = 3.2174, lr_0 = 5.9726e-04
Loss = 6.1839e-01, PNorm = 36.9197, GNorm = 1.3129, lr_0 = 5.9158e-04
Loss = 5.5125e-01, PNorm = 36.9588, GNorm = 2.5863, lr_0 = 5.8595e-04
Loss = 5.7536e-01, PNorm = 36.9901, GNorm = 3.2822, lr_0 = 5.8037e-04
Loss = 5.5291e-01, PNorm = 37.0344, GNorm = 3.0853, lr_0 = 5.7485e-04
Loss = 6.2187e-01, PNorm = 37.0571, GNorm = 5.3176, lr_0 = 5.6938e-04
Loss = 6.1479e-01, PNorm = 37.0891, GNorm = 1.7531, lr_0 = 5.6396e-04
Validation cross_entropy = 0.642746
Epoch 9
Loss = 6.2065e-01, PNorm = 37.1140, GNorm = 5.2336, lr_0 = 5.5859e-04
Loss = 6.2403e-01, PNorm = 37.1394, GNorm = 4.6638, lr_0 = 5.5327e-04
Loss = 5.8303e-01, PNorm = 37.1796, GNorm = 1.6379, lr_0 = 5.4801e-04
Loss = 5.7772e-01, PNorm = 37.2097, GNorm = 1.6488, lr_0 = 5.4279e-04
Loss = 5.2770e-01, PNorm = 37.2411, GNorm = 1.3564, lr_0 = 5.3763e-04
Loss = 5.3969e-01, PNorm = 37.2786, GNorm = 0.9790, lr_0 = 5.3251e-04
Loss = 5.9124e-01, PNorm = 37.3150, GNorm = 1.4662, lr_0 = 5.2744e-04
Loss = 5.6610e-01, PNorm = 37.3484, GNorm = 3.0960, lr_0 = 5.2242e-04
Loss = 5.2734e-01, PNorm = 37.3785, GNorm = 1.9797, lr_0 = 5.1745e-04
Validation cross_entropy = 0.675016
Epoch 10
Loss = 5.8106e-01, PNorm = 37.4001, GNorm = 2.0035, lr_0 = 5.1253e-04
Loss = 5.7205e-01, PNorm = 37.4368, GNorm = 2.2895, lr_0 = 5.0765e-04
Loss = 5.0085e-01, PNorm = 37.4726, GNorm = 1.8545, lr_0 = 5.0282e-04
Loss = 5.1234e-01, PNorm = 37.5112, GNorm = 5.7589, lr_0 = 4.9803e-04
Loss = 5.5727e-01, PNorm = 37.5366, GNorm = 3.6275, lr_0 = 4.9329e-04
Loss = 5.7255e-01, PNorm = 37.5658, GNorm = 3.4551, lr_0 = 4.8860e-04
Loss = 5.7303e-01, PNorm = 37.5923, GNorm = 3.8992, lr_0 = 4.8395e-04
Loss = 5.4796e-01, PNorm = 37.6135, GNorm = 8.3949, lr_0 = 4.7934e-04
Validation cross_entropy = 0.621203
Epoch 11
Loss = 4.7451e-01, PNorm = 37.6422, GNorm = 1.8333, lr_0 = 4.7478e-04
Loss = 5.4139e-01, PNorm = 37.6705, GNorm = 3.3888, lr_0 = 4.7026e-04
Loss = 5.4330e-01, PNorm = 37.6989, GNorm = 1.3776, lr_0 = 4.6579e-04
Loss = 5.3837e-01, PNorm = 37.7293, GNorm = 1.5469, lr_0 = 4.6136e-04
Loss = 5.7163e-01, PNorm = 37.7587, GNorm = 4.1452, lr_0 = 4.5697e-04
Loss = 5.4593e-01, PNorm = 37.7900, GNorm = 3.4027, lr_0 = 4.5262e-04
Loss = 5.9848e-01, PNorm = 37.8165, GNorm = 3.6586, lr_0 = 4.4831e-04
Loss = 5.7684e-01, PNorm = 37.8426, GNorm = 1.5043, lr_0 = 4.4404e-04
Loss = 5.7034e-01, PNorm = 37.8679, GNorm = 1.5617, lr_0 = 4.3982e-04
Validation cross_entropy = 0.642254
Epoch 12
Loss = 5.1390e-01, PNorm = 37.9016, GNorm = 4.3379, lr_0 = 4.3563e-04
Loss = 5.0152e-01, PNorm = 37.9301, GNorm = 2.5915, lr_0 = 4.3149e-04
Loss = 5.1181e-01, PNorm = 37.9595, GNorm = 3.2070, lr_0 = 4.2738e-04
Loss = 4.8511e-01, PNorm = 37.9838, GNorm = 1.9691, lr_0 = 4.2331e-04
Loss = 5.5723e-01, PNorm = 38.0107, GNorm = 3.3043, lr_0 = 4.1928e-04
Loss = 5.4146e-01, PNorm = 38.0382, GNorm = 2.1831, lr_0 = 4.1529e-04
Loss = 5.2781e-01, PNorm = 38.0607, GNorm = 3.8130, lr_0 = 4.1134e-04
Loss = 5.0783e-01, PNorm = 38.0844, GNorm = 6.0233, lr_0 = 4.0743e-04
Validation cross_entropy = 0.638698
Epoch 13
Loss = 5.1080e-01, PNorm = 38.1128, GNorm = 1.7301, lr_0 = 4.0355e-04
Loss = 4.8768e-01, PNorm = 38.1375, GNorm = 3.8755, lr_0 = 3.9971e-04
Loss = 5.0511e-01, PNorm = 38.1602, GNorm = 2.1649, lr_0 = 3.9591e-04
Loss = 4.7549e-01, PNorm = 38.1851, GNorm = 1.4401, lr_0 = 3.9214e-04
Loss = 5.4487e-01, PNorm = 38.2135, GNorm = 3.1000, lr_0 = 3.8841e-04
Loss = 4.6484e-01, PNorm = 38.2453, GNorm = 4.3752, lr_0 = 3.8471e-04
Loss = 5.0631e-01, PNorm = 38.2711, GNorm = 5.9208, lr_0 = 3.8105e-04
Loss = 4.7854e-01, PNorm = 38.2955, GNorm = 2.9491, lr_0 = 3.7742e-04
Loss = 5.2838e-01, PNorm = 38.3194, GNorm = 2.6473, lr_0 = 3.7383e-04
Validation cross_entropy = 0.632279
Epoch 14
Loss = 4.5899e-01, PNorm = 38.3353, GNorm = 3.1830, lr_0 = 3.7027e-04
Loss = 4.8404e-01, PNorm = 38.3575, GNorm = 3.3348, lr_0 = 3.6675e-04
Loss = 5.3368e-01, PNorm = 38.3881, GNorm = 3.3381, lr_0 = 3.6326e-04
Loss = 4.3083e-01, PNorm = 38.4125, GNorm = 3.1296, lr_0 = 3.5980e-04
Loss = 4.9958e-01, PNorm = 38.4416, GNorm = 1.7006, lr_0 = 3.5638e-04
Loss = 5.5849e-01, PNorm = 38.4658, GNorm = 1.8599, lr_0 = 3.5299e-04
Loss = 4.9719e-01, PNorm = 38.4895, GNorm = 2.8042, lr_0 = 3.4963e-04
Loss = 4.7167e-01, PNorm = 38.5144, GNorm = 4.0734, lr_0 = 3.4630e-04
Loss = 5.4090e-01, PNorm = 38.5315, GNorm = 4.3984, lr_0 = 3.4300e-04
Validation cross_entropy = 0.613632
Epoch 15
Loss = 4.7416e-01, PNorm = 38.5501, GNorm = 1.3922, lr_0 = 3.3974e-04
Loss = 4.3463e-01, PNorm = 38.5739, GNorm = 1.8275, lr_0 = 3.3651e-04
Loss = 4.9615e-01, PNorm = 38.5946, GNorm = 4.0067, lr_0 = 3.3330e-04
Loss = 4.6317e-01, PNorm = 38.6159, GNorm = 1.4849, lr_0 = 3.3013e-04
Loss = 5.4738e-01, PNorm = 38.6394, GNorm = 2.5812, lr_0 = 3.2699e-04
Loss = 4.8967e-01, PNorm = 38.6623, GNorm = 3.4665, lr_0 = 3.2388e-04
Loss = 4.5489e-01, PNorm = 38.6841, GNorm = 5.9823, lr_0 = 3.2080e-04
Loss = 4.7631e-01, PNorm = 38.7078, GNorm = 2.4714, lr_0 = 3.1774e-04
Validation cross_entropy = 0.612485
Epoch 16
Loss = 4.5943e-01, PNorm = 38.7273, GNorm = 3.8729, lr_0 = 3.1472e-04
Loss = 5.0202e-01, PNorm = 38.7485, GNorm = 1.3356, lr_0 = 3.1172e-04
Loss = 4.8609e-01, PNorm = 38.7753, GNorm = 2.8511, lr_0 = 3.0876e-04
Loss = 4.4649e-01, PNorm = 38.7936, GNorm = 1.5913, lr_0 = 3.0582e-04
Loss = 4.5239e-01, PNorm = 38.8171, GNorm = 2.6419, lr_0 = 3.0291e-04
Loss = 4.7082e-01, PNorm = 38.8441, GNorm = 3.7732, lr_0 = 3.0003e-04
Loss = 5.5193e-01, PNorm = 38.8658, GNorm = 4.0089, lr_0 = 2.9717e-04
Loss = 4.6058e-01, PNorm = 38.8831, GNorm = 3.6736, lr_0 = 2.9434e-04
Loss = 4.1669e-01, PNorm = 38.9012, GNorm = 1.5835, lr_0 = 2.9154e-04
Validation cross_entropy = 0.650354
Epoch 17
Loss = 4.7093e-01, PNorm = 38.9233, GNorm = 5.2583, lr_0 = 2.8877e-04
Loss = 4.8174e-01, PNorm = 38.9455, GNorm = 6.9923, lr_0 = 2.8602e-04
Loss = 4.3937e-01, PNorm = 38.9646, GNorm = 2.7096, lr_0 = 2.8330e-04
Loss = 4.7244e-01, PNorm = 38.9837, GNorm = 1.9885, lr_0 = 2.8060e-04
Loss = 4.7257e-01, PNorm = 39.0022, GNorm = 5.0948, lr_0 = 2.7793e-04
Loss = 4.8747e-01, PNorm = 39.0235, GNorm = 3.3948, lr_0 = 2.7529e-04
Loss = 4.7438e-01, PNorm = 39.0415, GNorm = 2.7865, lr_0 = 2.7267e-04
Loss = 4.5837e-01, PNorm = 39.0618, GNorm = 2.3193, lr_0 = 2.7007e-04
Validation cross_entropy = 0.631339
Epoch 18
Loss = 4.9940e-01, PNorm = 39.0820, GNorm = 4.7054, lr_0 = 2.6750e-04
Loss = 3.9765e-01, PNorm = 39.0993, GNorm = 1.8069, lr_0 = 2.6496e-04
Loss = 4.4968e-01, PNorm = 39.1164, GNorm = 4.0274, lr_0 = 2.6243e-04
Loss = 4.3398e-01, PNorm = 39.1385, GNorm = 2.4230, lr_0 = 2.5994e-04
Loss = 4.6007e-01, PNorm = 39.1548, GNorm = 4.7703, lr_0 = 2.5746e-04
Loss = 4.6573e-01, PNorm = 39.1722, GNorm = 1.8996, lr_0 = 2.5501e-04
Loss = 4.8231e-01, PNorm = 39.1927, GNorm = 1.7065, lr_0 = 2.5259e-04
Loss = 4.6810e-01, PNorm = 39.2140, GNorm = 1.7082, lr_0 = 2.5018e-04
Loss = 4.4835e-01, PNorm = 39.2333, GNorm = 2.3773, lr_0 = 2.4780e-04
Validation cross_entropy = 0.615536
Epoch 19
Loss = 4.4851e-01, PNorm = 39.2477, GNorm = 2.1431, lr_0 = 2.4544e-04
Loss = 4.7185e-01, PNorm = 39.2687, GNorm = 3.3313, lr_0 = 2.4311e-04
Loss = 3.8513e-01, PNorm = 39.2883, GNorm = 2.4620, lr_0 = 2.4079e-04
Loss = 4.3252e-01, PNorm = 39.3074, GNorm = 1.9944, lr_0 = 2.3850e-04
Loss = 4.4236e-01, PNorm = 39.3254, GNorm = 5.1919, lr_0 = 2.3623e-04
Loss = 4.8685e-01, PNorm = 39.3394, GNorm = 1.6953, lr_0 = 2.3398e-04
Loss = 4.1853e-01, PNorm = 39.3540, GNorm = 3.0944, lr_0 = 2.3176e-04
Loss = 3.8506e-01, PNorm = 39.3701, GNorm = 1.4173, lr_0 = 2.2955e-04
Loss = 4.5003e-01, PNorm = 39.3859, GNorm = 3.3478, lr_0 = 2.2737e-04
Validation cross_entropy = 0.646602
Epoch 20
Loss = 4.0943e-01, PNorm = 39.4056, GNorm = 3.6110, lr_0 = 2.2520e-04
Loss = 3.9620e-01, PNorm = 39.4235, GNorm = 2.0739, lr_0 = 2.2306e-04
Loss = 4.0271e-01, PNorm = 39.4410, GNorm = 4.6274, lr_0 = 2.2094e-04
Loss = 4.2549e-01, PNorm = 39.4595, GNorm = 3.3355, lr_0 = 2.1883e-04
Loss = 4.0827e-01, PNorm = 39.4772, GNorm = 3.7130, lr_0 = 2.1675e-04
Loss = 4.0078e-01, PNorm = 39.4963, GNorm = 1.5084, lr_0 = 2.1469e-04
Loss = 4.5714e-01, PNorm = 39.5088, GNorm = 3.1401, lr_0 = 2.1265e-04
Loss = 4.5538e-01, PNorm = 39.5186, GNorm = 2.9281, lr_0 = 2.1062e-04
Validation cross_entropy = 0.631515
Epoch 21
Loss = 3.5222e-01, PNorm = 39.5314, GNorm = 2.5360, lr_0 = 2.0862e-04
Loss = 3.6539e-01, PNorm = 39.5447, GNorm = 2.2903, lr_0 = 2.0663e-04
Loss = 4.1338e-01, PNorm = 39.5580, GNorm = 1.1140, lr_0 = 2.0467e-04
Loss = 4.7069e-01, PNorm = 39.5749, GNorm = 2.3089, lr_0 = 2.0272e-04
Loss = 3.9642e-01, PNorm = 39.5935, GNorm = 2.3649, lr_0 = 2.0079e-04
Loss = 3.9293e-01, PNorm = 39.6082, GNorm = 1.6246, lr_0 = 1.9888e-04
Loss = 4.0078e-01, PNorm = 39.6210, GNorm = 2.4438, lr_0 = 1.9699e-04
Loss = 4.1987e-01, PNorm = 39.6340, GNorm = 3.9701, lr_0 = 1.9511e-04
Loss = 5.1825e-01, PNorm = 39.6447, GNorm = 2.0437, lr_0 = 1.9325e-04
Validation cross_entropy = 0.630103
Epoch 22
Loss = 4.5337e-01, PNorm = 39.6595, GNorm = 5.0914, lr_0 = 1.9142e-04
Loss = 3.7434e-01, PNorm = 39.6760, GNorm = 3.4223, lr_0 = 1.8959e-04
Loss = 3.6958e-01, PNorm = 39.6915, GNorm = 3.4616, lr_0 = 1.8779e-04
Loss = 3.5876e-01, PNorm = 39.7053, GNorm = 1.9203, lr_0 = 1.8600e-04
Loss = 4.2307e-01, PNorm = 39.7201, GNorm = 3.1009, lr_0 = 1.8423e-04
Loss = 3.9714e-01, PNorm = 39.7355, GNorm = 2.8607, lr_0 = 1.8248e-04
Loss = 4.0119e-01, PNorm = 39.7494, GNorm = 4.3737, lr_0 = 1.8074e-04
Loss = 4.3942e-01, PNorm = 39.7606, GNorm = 2.6297, lr_0 = 1.7902e-04
Validation cross_entropy = 0.668611
Epoch 23
Loss = 4.2963e-01, PNorm = 39.7715, GNorm = 1.3324, lr_0 = 1.7732e-04
Loss = 4.1091e-01, PNorm = 39.7857, GNorm = 8.0210, lr_0 = 1.7563e-04
Loss = 4.3438e-01, PNorm = 39.7989, GNorm = 4.3204, lr_0 = 1.7396e-04
Loss = 4.1112e-01, PNorm = 39.8149, GNorm = 1.9327, lr_0 = 1.7230e-04
Loss = 3.9368e-01, PNorm = 39.8263, GNorm = 3.1678, lr_0 = 1.7066e-04
Loss = 3.8687e-01, PNorm = 39.8368, GNorm = 1.5673, lr_0 = 1.6904e-04
Loss = 3.9496e-01, PNorm = 39.8479, GNorm = 3.9485, lr_0 = 1.6743e-04
Loss = 3.6825e-01, PNorm = 39.8617, GNorm = 3.2451, lr_0 = 1.6584e-04
Loss = 3.7119e-01, PNorm = 39.8743, GNorm = 3.4628, lr_0 = 1.6426e-04
Validation cross_entropy = 0.645844
Epoch 24
Loss = 3.2749e-01, PNorm = 39.8853, GNorm = 2.7754, lr_0 = 1.6270e-04
Loss = 3.1872e-01, PNorm = 39.8978, GNorm = 1.4755, lr_0 = 1.6115e-04
Loss = 4.1755e-01, PNorm = 39.9126, GNorm = 2.6734, lr_0 = 1.5961e-04
Loss = 4.0289e-01, PNorm = 39.9244, GNorm = 2.7871, lr_0 = 1.5810e-04
Loss = 3.6761e-01, PNorm = 39.9375, GNorm = 2.1070, lr_0 = 1.5659e-04
Loss = 4.2674e-01, PNorm = 39.9506, GNorm = 7.5899, lr_0 = 1.5510e-04
Loss = 4.3085e-01, PNorm = 39.9621, GNorm = 2.6565, lr_0 = 1.5362e-04
Loss = 3.8163e-01, PNorm = 39.9751, GNorm = 3.2402, lr_0 = 1.5216e-04
Loss = 4.2587e-01, PNorm = 39.9857, GNorm = 2.4166, lr_0 = 1.5071e-04
Validation cross_entropy = 0.630461
Epoch 25
Loss = 4.2884e-01, PNorm = 39.9950, GNorm = 3.2318, lr_0 = 1.4928e-04
Loss = 3.9150e-01, PNorm = 40.0070, GNorm = 3.8445, lr_0 = 1.4786e-04
Loss = 3.8537e-01, PNorm = 40.0188, GNorm = 2.6664, lr_0 = 1.4645e-04
Loss = 3.5988e-01, PNorm = 40.0286, GNorm = 2.5369, lr_0 = 1.4506e-04
Loss = 3.8952e-01, PNorm = 40.0407, GNorm = 2.7544, lr_0 = 1.4368e-04
Loss = 3.6259e-01, PNorm = 40.0519, GNorm = 3.7033, lr_0 = 1.4231e-04
Loss = 3.8099e-01, PNorm = 40.0620, GNorm = 1.5093, lr_0 = 1.4096e-04
Loss = 3.6709e-01, PNorm = 40.0740, GNorm = 1.9469, lr_0 = 1.3962e-04
Validation cross_entropy = 0.625780
Epoch 26
Loss = 3.4213e-01, PNorm = 40.0825, GNorm = 4.7187, lr_0 = 1.3829e-04
Loss = 4.0468e-01, PNorm = 40.0933, GNorm = 5.7855, lr_0 = 1.3697e-04
Loss = 3.6261e-01, PNorm = 40.1042, GNorm = 2.2914, lr_0 = 1.3567e-04
Loss = 3.9109e-01, PNorm = 40.1137, GNorm = 2.6918, lr_0 = 1.3438e-04
Loss = 4.1547e-01, PNorm = 40.1227, GNorm = 6.5113, lr_0 = 1.3310e-04
Loss = 3.5237e-01, PNorm = 40.1320, GNorm = 2.5368, lr_0 = 1.3183e-04
Loss = 3.7078e-01, PNorm = 40.1415, GNorm = 1.5857, lr_0 = 1.3058e-04
Loss = 3.7081e-01, PNorm = 40.1516, GNorm = 5.7813, lr_0 = 1.2933e-04
Loss = 3.7536e-01, PNorm = 40.1601, GNorm = 6.2159, lr_0 = 1.2810e-04
Validation cross_entropy = 0.631653
Epoch 27
Loss = 3.7432e-01, PNorm = 40.1707, GNorm = 6.3018, lr_0 = 1.2688e-04
Loss = 3.6687e-01, PNorm = 40.1797, GNorm = 2.0797, lr_0 = 1.2568e-04
Loss = 3.6003e-01, PNorm = 40.1902, GNorm = 4.5684, lr_0 = 1.2448e-04
Loss = 3.8494e-01, PNorm = 40.1986, GNorm = 2.9202, lr_0 = 1.2330e-04
Loss = 3.8753e-01, PNorm = 40.2050, GNorm = 4.8133, lr_0 = 1.2212e-04
Loss = 3.6464e-01, PNorm = 40.2142, GNorm = 3.5688, lr_0 = 1.2096e-04
Loss = 3.7885e-01, PNorm = 40.2250, GNorm = 2.8186, lr_0 = 1.1981e-04
Loss = 3.8581e-01, PNorm = 40.2336, GNorm = 6.2540, lr_0 = 1.1867e-04
Validation cross_entropy = 0.664177
Epoch 28
Loss = 3.7061e-01, PNorm = 40.2419, GNorm = 5.3553, lr_0 = 1.1754e-04
Loss = 3.4936e-01, PNorm = 40.2520, GNorm = 7.3483, lr_0 = 1.1642e-04
Loss = 3.7901e-01, PNorm = 40.2613, GNorm = 2.4430, lr_0 = 1.1531e-04
Loss = 3.7613e-01, PNorm = 40.2704, GNorm = 2.5864, lr_0 = 1.1422e-04
Loss = 3.6806e-01, PNorm = 40.2802, GNorm = 2.1064, lr_0 = 1.1313e-04
Loss = 3.6714e-01, PNorm = 40.2896, GNorm = 3.5751, lr_0 = 1.1205e-04
Loss = 3.7250e-01, PNorm = 40.2976, GNorm = 2.1830, lr_0 = 1.1099e-04
Loss = 3.8400e-01, PNorm = 40.3046, GNorm = 6.2686, lr_0 = 1.0993e-04
Loss = 3.3978e-01, PNorm = 40.3126, GNorm = 2.0409, lr_0 = 1.0888e-04
Validation cross_entropy = 0.651373
Epoch 29
Loss = 4.2608e-01, PNorm = 40.3194, GNorm = 1.9682, lr_0 = 1.0785e-04
Loss = 3.5641e-01, PNorm = 40.3273, GNorm = 1.7502, lr_0 = 1.0682e-04
Loss = 3.3669e-01, PNorm = 40.3343, GNorm = 3.3122, lr_0 = 1.0580e-04
Loss = 3.5623e-01, PNorm = 40.3423, GNorm = 3.4391, lr_0 = 1.0480e-04
Loss = 3.4721e-01, PNorm = 40.3520, GNorm = 3.2938, lr_0 = 1.0380e-04
Loss = 3.9719e-01, PNorm = 40.3606, GNorm = 3.0676, lr_0 = 1.0281e-04
Loss = 3.5586e-01, PNorm = 40.3681, GNorm = 2.9386, lr_0 = 1.0183e-04
Loss = 3.0807e-01, PNorm = 40.3758, GNorm = 2.3614, lr_0 = 1.0086e-04
Loss = 3.6623e-01, PNorm = 40.3829, GNorm = 2.4781, lr_0 = 1.0000e-04
Validation cross_entropy = 0.645692
Model 0 best validation cross_entropy = 0.612485 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.447180
Ensemble test cross_entropy = 0.447180
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.447180
Overall test cross_entropy = 0.447180 +/- 0.000000
Elapsed time = 0:15:26
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_1_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_1_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_1_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121222__0.1_LUMO_1_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 45 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 45 SMILES are invalid.
Warning: 343 SMILES are invalid.
Total size = 4,281 | train size = 4,281 | val size = 38,599 | test size = 4,281
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.1145e+00, PNorm = 34.0522, GNorm = 2.2705, lr_0 = 1.5824e-04
Loss = 1.0875e+00, PNorm = 34.0536, GNorm = 0.6032, lr_0 = 2.1118e-04
Loss = 1.0889e+00, PNorm = 34.0575, GNorm = 1.8587, lr_0 = 2.6412e-04
Loss = 1.0764e+00, PNorm = 34.0637, GNorm = 0.9115, lr_0 = 3.1706e-04
Loss = 1.0584e+00, PNorm = 34.0747, GNorm = 1.3346, lr_0 = 3.7000e-04
Loss = 1.0256e+00, PNorm = 34.0912, GNorm = 1.6482, lr_0 = 4.2294e-04
Loss = 1.0107e+00, PNorm = 34.1147, GNorm = 2.0727, lr_0 = 4.7588e-04
Loss = 9.8235e-01, PNorm = 34.1493, GNorm = 1.0234, lr_0 = 5.2882e-04
Validation cross_entropy = 0.993066
Epoch 1
Loss = 9.6349e-01, PNorm = 34.1926, GNorm = 2.0583, lr_0 = 5.8706e-04
Loss = 8.9312e-01, PNorm = 34.2396, GNorm = 4.9556, lr_0 = 6.4000e-04
Loss = 8.7672e-01, PNorm = 34.2883, GNorm = 2.9131, lr_0 = 6.9294e-04
Loss = 8.6465e-01, PNorm = 34.3437, GNorm = 6.4204, lr_0 = 7.4588e-04
Loss = 8.9924e-01, PNorm = 34.3889, GNorm = 6.4494, lr_0 = 7.9882e-04
Loss = 8.8651e-01, PNorm = 34.4335, GNorm = 3.8320, lr_0 = 8.5176e-04
Loss = 9.1641e-01, PNorm = 34.4838, GNorm = 1.4500, lr_0 = 9.0471e-04
Loss = 8.4832e-01, PNorm = 34.5460, GNorm = 0.7871, lr_0 = 9.5765e-04
Loss = 7.8277e-01, PNorm = 34.6007, GNorm = 2.2317, lr_0 = 9.9807e-04
Validation cross_entropy = 0.882074
Epoch 2
Loss = 8.1024e-01, PNorm = 34.6554, GNorm = 1.0960, lr_0 = 9.8846e-04
Loss = 8.2905e-01, PNorm = 34.7166, GNorm = 3.3026, lr_0 = 9.7894e-04
Loss = 8.0042e-01, PNorm = 34.7698, GNorm = 0.7087, lr_0 = 9.6952e-04
Loss = 8.2326e-01, PNorm = 34.8260, GNorm = 3.3161, lr_0 = 9.6018e-04
Loss = 8.1326e-01, PNorm = 34.8858, GNorm = 2.0789, lr_0 = 9.5094e-04
Loss = 7.7529e-01, PNorm = 34.9529, GNorm = 1.1529, lr_0 = 9.4178e-04
Loss = 7.7218e-01, PNorm = 35.0111, GNorm = 1.4218, lr_0 = 9.3271e-04
Loss = 7.1678e-01, PNorm = 35.0613, GNorm = 4.3235, lr_0 = 9.2373e-04
Validation cross_entropy = 0.755659
Epoch 3
Loss = 7.8547e-01, PNorm = 35.1034, GNorm = 3.5026, lr_0 = 9.1395e-04
Loss = 8.3757e-01, PNorm = 35.1512, GNorm = 3.9055, lr_0 = 9.0515e-04
Loss = 7.5880e-01, PNorm = 35.2012, GNorm = 0.8417, lr_0 = 8.9644e-04
Loss = 7.7236e-01, PNorm = 35.2497, GNorm = 3.2772, lr_0 = 8.8781e-04
Loss = 6.7779e-01, PNorm = 35.3011, GNorm = 1.8650, lr_0 = 8.7926e-04
Loss = 7.6406e-01, PNorm = 35.3604, GNorm = 4.5487, lr_0 = 8.7080e-04
Loss = 7.3701e-01, PNorm = 35.4220, GNorm = 1.6670, lr_0 = 8.6241e-04
Loss = 7.2261e-01, PNorm = 35.4713, GNorm = 2.3986, lr_0 = 8.5411e-04
Loss = 7.2693e-01, PNorm = 35.5171, GNorm = 1.3455, lr_0 = 8.4588e-04
Validation cross_entropy = 0.714464
Epoch 4
Loss = 6.8542e-01, PNorm = 35.5662, GNorm = 4.1460, lr_0 = 8.3774e-04
Loss = 6.9925e-01, PNorm = 35.6350, GNorm = 1.9360, lr_0 = 8.2967e-04
Loss = 7.3802e-01, PNorm = 35.6883, GNorm = 5.6138, lr_0 = 8.2169e-04
Loss = 7.1109e-01, PNorm = 35.7306, GNorm = 3.7724, lr_0 = 8.1377e-04
Loss = 7.7429e-01, PNorm = 35.7693, GNorm = 1.8222, lr_0 = 8.0594e-04
Loss = 7.1854e-01, PNorm = 35.8206, GNorm = 2.3977, lr_0 = 7.9818e-04
Loss = 6.9349e-01, PNorm = 35.8699, GNorm = 3.0348, lr_0 = 7.9050e-04
Loss = 6.5771e-01, PNorm = 35.9205, GNorm = 1.4775, lr_0 = 7.8288e-04
Validation cross_entropy = 0.683948
Epoch 5
Loss = 5.2356e-01, PNorm = 35.9643, GNorm = 0.8999, lr_0 = 7.7535e-04
Loss = 7.0413e-01, PNorm = 36.0026, GNorm = 2.1015, lr_0 = 7.6788e-04
Loss = 7.5115e-01, PNorm = 36.0483, GNorm = 2.3038, lr_0 = 7.6049e-04
Loss = 6.8357e-01, PNorm = 36.1042, GNorm = 1.1202, lr_0 = 7.5317e-04
Loss = 6.9365e-01, PNorm = 36.1520, GNorm = 2.0906, lr_0 = 7.4591e-04
Loss = 7.2388e-01, PNorm = 36.2025, GNorm = 3.7164, lr_0 = 7.3873e-04
Loss = 7.0151e-01, PNorm = 36.2549, GNorm = 2.6091, lr_0 = 7.3162e-04
Loss = 6.9319e-01, PNorm = 36.3006, GNorm = 1.8215, lr_0 = 7.2458e-04
Loss = 6.8894e-01, PNorm = 36.3412, GNorm = 3.8633, lr_0 = 7.1760e-04
Validation cross_entropy = 0.693004
Epoch 6
Loss = 6.7931e-01, PNorm = 36.3850, GNorm = 1.0320, lr_0 = 7.1000e-04
Loss = 6.3773e-01, PNorm = 36.4179, GNorm = 1.1021, lr_0 = 7.0317e-04
Loss = 7.3681e-01, PNorm = 36.4517, GNorm = 2.5069, lr_0 = 6.9640e-04
Loss = 6.2437e-01, PNorm = 36.5051, GNorm = 0.9241, lr_0 = 6.8969e-04
Loss = 6.2205e-01, PNorm = 36.5523, GNorm = 0.9728, lr_0 = 6.8305e-04
Loss = 6.6368e-01, PNorm = 36.5892, GNorm = 1.8864, lr_0 = 6.7648e-04
Loss = 6.9007e-01, PNorm = 36.6276, GNorm = 4.6230, lr_0 = 6.6996e-04
Loss = 6.4272e-01, PNorm = 36.6775, GNorm = 3.3301, lr_0 = 6.6351e-04
Validation cross_entropy = 0.664144
Epoch 7
Loss = 6.0370e-01, PNorm = 36.7236, GNorm = 2.8016, lr_0 = 6.5712e-04
Loss = 6.1935e-01, PNorm = 36.7568, GNorm = 6.2454, lr_0 = 6.5080e-04
Loss = 6.0959e-01, PNorm = 36.8002, GNorm = 1.3059, lr_0 = 6.4453e-04
Loss = 6.5057e-01, PNorm = 36.8357, GNorm = 1.5429, lr_0 = 6.3833e-04
Loss = 6.4799e-01, PNorm = 36.8683, GNorm = 2.4777, lr_0 = 6.3218e-04
Loss = 6.0198e-01, PNorm = 36.9064, GNorm = 3.3678, lr_0 = 6.2609e-04
Loss = 6.7097e-01, PNorm = 36.9359, GNorm = 3.8585, lr_0 = 6.2006e-04
Loss = 5.7039e-01, PNorm = 36.9752, GNorm = 3.0937, lr_0 = 6.1409e-04
Loss = 6.4324e-01, PNorm = 37.0113, GNorm = 1.6610, lr_0 = 6.0818e-04
Validation cross_entropy = 0.634925
Epoch 8
Loss = 5.6726e-01, PNorm = 37.0587, GNorm = 1.6360, lr_0 = 6.0174e-04
Loss = 6.0544e-01, PNorm = 37.1030, GNorm = 1.6102, lr_0 = 5.9595e-04
Loss = 6.0977e-01, PNorm = 37.1475, GNorm = 1.8502, lr_0 = 5.9021e-04
Loss = 6.0487e-01, PNorm = 37.1828, GNorm = 5.0376, lr_0 = 5.8453e-04
Loss = 6.0738e-01, PNorm = 37.2298, GNorm = 1.1532, lr_0 = 5.7890e-04
Loss = 6.3414e-01, PNorm = 37.2559, GNorm = 1.9813, lr_0 = 5.7333e-04
Loss = 5.8918e-01, PNorm = 37.2907, GNorm = 3.7448, lr_0 = 5.6781e-04
Loss = 6.1819e-01, PNorm = 37.3238, GNorm = 2.0418, lr_0 = 5.6234e-04
Loss = 6.1524e-01, PNorm = 37.3584, GNorm = 5.5201, lr_0 = 5.5693e-04
Validation cross_entropy = 0.702915
Epoch 9
Loss = 5.8064e-01, PNorm = 37.4018, GNorm = 1.1193, lr_0 = 5.5156e-04
Loss = 5.5338e-01, PNorm = 37.4436, GNorm = 3.1338, lr_0 = 5.4625e-04
Loss = 5.5177e-01, PNorm = 37.4814, GNorm = 1.2535, lr_0 = 5.4100e-04
Loss = 5.5001e-01, PNorm = 37.5166, GNorm = 1.5134, lr_0 = 5.3579e-04
Loss = 6.5484e-01, PNorm = 37.5478, GNorm = 2.0503, lr_0 = 5.3063e-04
Loss = 5.9457e-01, PNorm = 37.5858, GNorm = 3.3572, lr_0 = 5.2552e-04
Loss = 5.9829e-01, PNorm = 37.6190, GNorm = 3.8430, lr_0 = 5.2046e-04
Loss = 6.2608e-01, PNorm = 37.6457, GNorm = 2.0433, lr_0 = 5.1545e-04
Validation cross_entropy = 0.619258
Epoch 10
Loss = 5.1898e-01, PNorm = 37.6764, GNorm = 1.7042, lr_0 = 5.1049e-04
Loss = 5.4912e-01, PNorm = 37.7085, GNorm = 1.6528, lr_0 = 5.0557e-04
Loss = 5.3789e-01, PNorm = 37.7456, GNorm = 1.3267, lr_0 = 5.0070e-04
Loss = 5.9062e-01, PNorm = 37.7817, GNorm = 2.3253, lr_0 = 4.9588e-04
Loss = 5.4335e-01, PNorm = 37.8196, GNorm = 1.5915, lr_0 = 4.9111e-04
Loss = 6.0113e-01, PNorm = 37.8530, GNorm = 1.9825, lr_0 = 4.8638e-04
Loss = 6.3874e-01, PNorm = 37.8880, GNorm = 3.2239, lr_0 = 4.8170e-04
Loss = 5.5957e-01, PNorm = 37.9226, GNorm = 4.8429, lr_0 = 4.7706e-04
Loss = 6.1958e-01, PNorm = 37.9539, GNorm = 1.5873, lr_0 = 4.7247e-04
Validation cross_entropy = 0.615373
Epoch 11
Loss = 5.5204e-01, PNorm = 37.9910, GNorm = 3.7121, lr_0 = 4.6746e-04
Loss = 5.2869e-01, PNorm = 38.0313, GNorm = 1.9728, lr_0 = 4.6296e-04
Loss = 5.3163e-01, PNorm = 38.0687, GNorm = 4.3342, lr_0 = 4.5851e-04
Loss = 5.3068e-01, PNorm = 38.1027, GNorm = 2.5691, lr_0 = 4.5409e-04
Loss = 6.0042e-01, PNorm = 38.1231, GNorm = 2.0228, lr_0 = 4.4972e-04
Loss = 5.4254e-01, PNorm = 38.1505, GNorm = 2.2188, lr_0 = 4.4539e-04
Loss = 5.5884e-01, PNorm = 38.1763, GNorm = 1.3679, lr_0 = 4.4110e-04
Loss = 5.0374e-01, PNorm = 38.2096, GNorm = 5.6703, lr_0 = 4.3685e-04
Validation cross_entropy = 0.605502
Epoch 12
Loss = 5.2693e-01, PNorm = 38.2394, GNorm = 1.7614, lr_0 = 4.3265e-04
Loss = 5.5087e-01, PNorm = 38.2703, GNorm = 1.3151, lr_0 = 4.2848e-04
Loss = 5.2399e-01, PNorm = 38.2984, GNorm = 1.4247, lr_0 = 4.2436e-04
Loss = 5.5369e-01, PNorm = 38.3361, GNorm = 1.2685, lr_0 = 4.2027e-04
Loss = 5.2685e-01, PNorm = 38.3681, GNorm = 1.4532, lr_0 = 4.1622e-04
Loss = 5.2752e-01, PNorm = 38.4006, GNorm = 1.3643, lr_0 = 4.1222e-04
Loss = 5.7469e-01, PNorm = 38.4263, GNorm = 4.5004, lr_0 = 4.0825e-04
Loss = 5.3043e-01, PNorm = 38.4493, GNorm = 2.3652, lr_0 = 4.0432e-04
Loss = 4.8468e-01, PNorm = 38.4721, GNorm = 2.3436, lr_0 = 4.0042e-04
Validation cross_entropy = 0.607647
Epoch 13
Loss = 5.0942e-01, PNorm = 38.5026, GNorm = 2.1787, lr_0 = 3.9657e-04
Loss = 4.9315e-01, PNorm = 38.5324, GNorm = 1.5504, lr_0 = 3.9275e-04
Loss = 5.2090e-01, PNorm = 38.5628, GNorm = 2.1118, lr_0 = 3.8897e-04
Loss = 5.5767e-01, PNorm = 38.5991, GNorm = 2.0286, lr_0 = 3.8522e-04
Loss = 5.5060e-01, PNorm = 38.6205, GNorm = 2.7528, lr_0 = 3.8152e-04
Loss = 5.0842e-01, PNorm = 38.6429, GNorm = 1.8899, lr_0 = 3.7784e-04
Loss = 5.1997e-01, PNorm = 38.6669, GNorm = 3.0721, lr_0 = 3.7420e-04
Loss = 4.9933e-01, PNorm = 38.6916, GNorm = 3.0395, lr_0 = 3.7060e-04
Validation cross_entropy = 0.620694
Epoch 14
Loss = 4.6364e-01, PNorm = 38.7180, GNorm = 1.8958, lr_0 = 3.6668e-04
Loss = 5.2696e-01, PNorm = 38.7446, GNorm = 3.7265, lr_0 = 3.6315e-04
Loss = 5.0763e-01, PNorm = 38.7743, GNorm = 2.1926, lr_0 = 3.5965e-04
Loss = 5.2380e-01, PNorm = 38.7966, GNorm = 1.4809, lr_0 = 3.5619e-04
Loss = 4.8423e-01, PNorm = 38.8209, GNorm = 3.3110, lr_0 = 3.5276e-04
Loss = 4.9266e-01, PNorm = 38.8508, GNorm = 2.1500, lr_0 = 3.4936e-04
Loss = 4.8755e-01, PNorm = 38.8738, GNorm = 4.4071, lr_0 = 3.4600e-04
Loss = 4.6481e-01, PNorm = 38.8945, GNorm = 2.0706, lr_0 = 3.4267e-04
Loss = 5.3531e-01, PNorm = 38.9201, GNorm = 3.3085, lr_0 = 3.3937e-04
Validation cross_entropy = 0.611115
Epoch 15
Loss = 4.4104e-01, PNorm = 38.9405, GNorm = 1.5157, lr_0 = 3.3610e-04
Loss = 4.9586e-01, PNorm = 38.9606, GNorm = 5.2124, lr_0 = 3.3287e-04
Loss = 4.5488e-01, PNorm = 38.9846, GNorm = 3.0978, lr_0 = 3.2966e-04
Loss = 4.8009e-01, PNorm = 39.0089, GNorm = 3.5655, lr_0 = 3.2649e-04
Loss = 5.4903e-01, PNorm = 39.0366, GNorm = 1.6751, lr_0 = 3.2334e-04
Loss = 4.6377e-01, PNorm = 39.0623, GNorm = 3.1355, lr_0 = 3.2023e-04
Loss = 4.7546e-01, PNorm = 39.0839, GNorm = 2.3390, lr_0 = 3.1715e-04
Loss = 4.7761e-01, PNorm = 39.1056, GNorm = 2.3439, lr_0 = 3.1409e-04
Validation cross_entropy = 0.599664
Epoch 16
Loss = 5.0548e-01, PNorm = 39.1303, GNorm = 2.2048, lr_0 = 3.1077e-04
Loss = 4.7754e-01, PNorm = 39.1470, GNorm = 2.7369, lr_0 = 3.0778e-04
Loss = 4.7733e-01, PNorm = 39.1691, GNorm = 1.5583, lr_0 = 3.0481e-04
Loss = 4.1826e-01, PNorm = 39.1895, GNorm = 3.8113, lr_0 = 3.0188e-04
Loss = 5.0879e-01, PNorm = 39.2143, GNorm = 2.6139, lr_0 = 2.9897e-04
Loss = 4.9149e-01, PNorm = 39.2368, GNorm = 2.7558, lr_0 = 2.9609e-04
Loss = 5.2230e-01, PNorm = 39.2554, GNorm = 4.5955, lr_0 = 2.9324e-04
Loss = 4.6432e-01, PNorm = 39.2773, GNorm = 3.9559, lr_0 = 2.9042e-04
Loss = 5.1403e-01, PNorm = 39.3005, GNorm = 2.0045, lr_0 = 2.8762e-04
Validation cross_entropy = 0.591947
Epoch 17
Loss = 4.3507e-01, PNorm = 39.3223, GNorm = 1.5671, lr_0 = 2.8485e-04
Loss = 5.1907e-01, PNorm = 39.3441, GNorm = 3.5844, lr_0 = 2.8211e-04
Loss = 4.4570e-01, PNorm = 39.3638, GNorm = 3.5021, lr_0 = 2.7939e-04
Loss = 4.6393e-01, PNorm = 39.3885, GNorm = 1.9008, lr_0 = 2.7670e-04
Loss = 4.0372e-01, PNorm = 39.4097, GNorm = 4.1197, lr_0 = 2.7404e-04
Loss = 4.8852e-01, PNorm = 39.4322, GNorm = 4.0442, lr_0 = 2.7140e-04
Loss = 4.3420e-01, PNorm = 39.4533, GNorm = 4.1203, lr_0 = 2.6879e-04
Loss = 4.2864e-01, PNorm = 39.4718, GNorm = 4.3214, lr_0 = 2.6620e-04
Loss = 5.0803e-01, PNorm = 39.4886, GNorm = 7.2887, lr_0 = 2.6364e-04
Validation cross_entropy = 0.606540
Epoch 18
Loss = 4.3933e-01, PNorm = 39.5069, GNorm = 2.1736, lr_0 = 2.6110e-04
Loss = 4.2537e-01, PNorm = 39.5266, GNorm = 1.6315, lr_0 = 2.5859e-04
Loss = 4.0681e-01, PNorm = 39.5478, GNorm = 2.6804, lr_0 = 2.5610e-04
Loss = 4.3715e-01, PNorm = 39.5686, GNorm = 1.9560, lr_0 = 2.5363e-04
Loss = 4.2399e-01, PNorm = 39.5878, GNorm = 2.0715, lr_0 = 2.5119e-04
Loss = 4.9817e-01, PNorm = 39.6038, GNorm = 3.4861, lr_0 = 2.4877e-04
Loss = 4.4415e-01, PNorm = 39.6238, GNorm = 3.1719, lr_0 = 2.4638e-04
Loss = 4.7398e-01, PNorm = 39.6393, GNorm = 3.9587, lr_0 = 2.4400e-04
Validation cross_entropy = 0.597167
Epoch 19
Loss = 4.2329e-01, PNorm = 39.6577, GNorm = 1.7680, lr_0 = 2.4142e-04
Loss = 4.2602e-01, PNorm = 39.6782, GNorm = 3.9199, lr_0 = 2.3910e-04
Loss = 4.5710e-01, PNorm = 39.6963, GNorm = 2.0162, lr_0 = 2.3679e-04
Loss = 4.5386e-01, PNorm = 39.7131, GNorm = 2.5092, lr_0 = 2.3451e-04
Loss = 4.4029e-01, PNorm = 39.7318, GNorm = 3.8150, lr_0 = 2.3226e-04
Loss = 4.3267e-01, PNorm = 39.7493, GNorm = 2.8919, lr_0 = 2.3002e-04
Loss = 4.4680e-01, PNorm = 39.7674, GNorm = 3.3728, lr_0 = 2.2780e-04
Loss = 4.4023e-01, PNorm = 39.7855, GNorm = 2.3352, lr_0 = 2.2561e-04
Loss = 4.1546e-01, PNorm = 39.8006, GNorm = 1.9009, lr_0 = 2.2344e-04
Validation cross_entropy = 0.630356
Epoch 20
Loss = 4.7952e-01, PNorm = 39.8156, GNorm = 7.1552, lr_0 = 2.2129e-04
Loss = 4.4582e-01, PNorm = 39.8344, GNorm = 4.5043, lr_0 = 2.1916e-04
Loss = 4.2406e-01, PNorm = 39.8492, GNorm = 5.6995, lr_0 = 2.1705e-04
Loss = 3.9684e-01, PNorm = 39.8670, GNorm = 2.0175, lr_0 = 2.1496e-04
Loss = 4.1141e-01, PNorm = 39.8833, GNorm = 1.7879, lr_0 = 2.1289e-04
Loss = 4.3267e-01, PNorm = 39.8992, GNorm = 3.7253, lr_0 = 2.1084e-04
Loss = 4.4304e-01, PNorm = 39.9161, GNorm = 2.0633, lr_0 = 2.0881e-04
Loss = 4.3261e-01, PNorm = 39.9346, GNorm = 2.8785, lr_0 = 2.0680e-04
Validation cross_entropy = 0.593684
Epoch 21
Loss = 3.6232e-01, PNorm = 39.9467, GNorm = 1.6021, lr_0 = 2.0481e-04
Loss = 4.1216e-01, PNorm = 39.9625, GNorm = 2.8257, lr_0 = 2.0283e-04
Loss = 4.6070e-01, PNorm = 39.9781, GNorm = 1.8199, lr_0 = 2.0088e-04
Loss = 3.3098e-01, PNorm = 39.9925, GNorm = 2.9236, lr_0 = 1.9895e-04
Loss = 4.2355e-01, PNorm = 40.0078, GNorm = 1.5960, lr_0 = 1.9703e-04
Loss = 4.3573e-01, PNorm = 40.0232, GNorm = 2.3204, lr_0 = 1.9514e-04
Loss = 4.3723e-01, PNorm = 40.0385, GNorm = 3.6717, lr_0 = 1.9326e-04
Loss = 4.3876e-01, PNorm = 40.0521, GNorm = 2.0955, lr_0 = 1.9140e-04
Loss = 3.7526e-01, PNorm = 40.0649, GNorm = 3.0550, lr_0 = 1.8955e-04
Validation cross_entropy = 0.599400
Epoch 22
Loss = 4.3734e-01, PNorm = 40.0797, GNorm = 1.6689, lr_0 = 1.8755e-04
Loss = 4.5228e-01, PNorm = 40.0968, GNorm = 2.1334, lr_0 = 1.8574e-04
Loss = 4.1876e-01, PNorm = 40.1110, GNorm = 5.4501, lr_0 = 1.8395e-04
Loss = 4.1405e-01, PNorm = 40.1226, GNorm = 5.2301, lr_0 = 1.8218e-04
Loss = 4.1250e-01, PNorm = 40.1331, GNorm = 2.4086, lr_0 = 1.8043e-04
Loss = 4.0520e-01, PNorm = 40.1476, GNorm = 2.5463, lr_0 = 1.7869e-04
Loss = 4.2537e-01, PNorm = 40.1598, GNorm = 2.9692, lr_0 = 1.7697e-04
Loss = 3.9438e-01, PNorm = 40.1727, GNorm = 2.3568, lr_0 = 1.7527e-04
Validation cross_entropy = 0.604206
Epoch 23
Loss = 4.0078e-01, PNorm = 40.1829, GNorm = 2.8345, lr_0 = 1.7358e-04
Loss = 3.9435e-01, PNorm = 40.1981, GNorm = 1.5984, lr_0 = 1.7191e-04
Loss = 4.4592e-01, PNorm = 40.2138, GNorm = 2.3279, lr_0 = 1.7025e-04
Loss = 3.9257e-01, PNorm = 40.2242, GNorm = 1.4596, lr_0 = 1.6861e-04
Loss = 4.0649e-01, PNorm = 40.2365, GNorm = 4.0617, lr_0 = 1.6699e-04
Loss = 4.2962e-01, PNorm = 40.2492, GNorm = 2.1505, lr_0 = 1.6538e-04
Loss = 3.6178e-01, PNorm = 40.2603, GNorm = 1.9091, lr_0 = 1.6379e-04
Loss = 3.9153e-01, PNorm = 40.2721, GNorm = 2.8144, lr_0 = 1.6221e-04
Loss = 3.9398e-01, PNorm = 40.2833, GNorm = 3.4217, lr_0 = 1.6065e-04
Validation cross_entropy = 0.591576
Epoch 24
Loss = 2.7080e-01, PNorm = 40.2952, GNorm = 2.0252, lr_0 = 1.5895e-04
Loss = 4.3382e-01, PNorm = 40.3082, GNorm = 2.6559, lr_0 = 1.5742e-04
Loss = 3.5834e-01, PNorm = 40.3202, GNorm = 2.6567, lr_0 = 1.5590e-04
Loss = 3.9633e-01, PNorm = 40.3317, GNorm = 3.0876, lr_0 = 1.5440e-04
Loss = 3.7370e-01, PNorm = 40.3431, GNorm = 2.5784, lr_0 = 1.5292e-04
Loss = 4.2275e-01, PNorm = 40.3539, GNorm = 3.2723, lr_0 = 1.5144e-04
Loss = 3.9530e-01, PNorm = 40.3657, GNorm = 2.5790, lr_0 = 1.4999e-04
Loss = 3.7168e-01, PNorm = 40.3767, GNorm = 2.0929, lr_0 = 1.4854e-04
Loss = 3.9148e-01, PNorm = 40.3861, GNorm = 3.3546, lr_0 = 1.4711e-04
Validation cross_entropy = 0.607162
Epoch 25
Loss = 3.2784e-01, PNorm = 40.3966, GNorm = 3.9025, lr_0 = 1.4570e-04
Loss = 3.7324e-01, PNorm = 40.4078, GNorm = 2.4749, lr_0 = 1.4429e-04
Loss = 3.9047e-01, PNorm = 40.4201, GNorm = 4.0388, lr_0 = 1.4290e-04
Loss = 4.0428e-01, PNorm = 40.4309, GNorm = 3.3243, lr_0 = 1.4153e-04
Loss = 3.7084e-01, PNorm = 40.4406, GNorm = 2.5629, lr_0 = 1.4016e-04
Loss = 3.7302e-01, PNorm = 40.4532, GNorm = 3.6480, lr_0 = 1.3882e-04
Loss = 4.0487e-01, PNorm = 40.4637, GNorm = 2.2738, lr_0 = 1.3748e-04
Loss = 4.0366e-01, PNorm = 40.4729, GNorm = 3.3949, lr_0 = 1.3616e-04
Validation cross_entropy = 0.599257
Epoch 26
Loss = 3.8570e-01, PNorm = 40.4820, GNorm = 2.4538, lr_0 = 1.3484e-04
Loss = 3.6709e-01, PNorm = 40.4912, GNorm = 4.2039, lr_0 = 1.3355e-04
Loss = 3.8549e-01, PNorm = 40.4999, GNorm = 2.4937, lr_0 = 1.3226e-04
Loss = 3.6330e-01, PNorm = 40.5086, GNorm = 3.1244, lr_0 = 1.3099e-04
Loss = 3.6176e-01, PNorm = 40.5194, GNorm = 2.3672, lr_0 = 1.2973e-04
Loss = 4.0973e-01, PNorm = 40.5300, GNorm = 3.1154, lr_0 = 1.2848e-04
Loss = 3.8285e-01, PNorm = 40.5419, GNorm = 2.8880, lr_0 = 1.2724e-04
Loss = 3.5713e-01, PNorm = 40.5509, GNorm = 3.8403, lr_0 = 1.2601e-04
Loss = 3.6259e-01, PNorm = 40.5578, GNorm = 2.5911, lr_0 = 1.2480e-04
Validation cross_entropy = 0.597301
Epoch 27
Loss = 3.6185e-01, PNorm = 40.5684, GNorm = 3.0186, lr_0 = 1.2348e-04
Loss = 3.4913e-01, PNorm = 40.5785, GNorm = 3.1792, lr_0 = 1.2229e-04
Loss = 3.2487e-01, PNorm = 40.5859, GNorm = 2.8231, lr_0 = 1.2111e-04
Loss = 3.4772e-01, PNorm = 40.5951, GNorm = 2.6718, lr_0 = 1.1995e-04
Loss = 3.9985e-01, PNorm = 40.6046, GNorm = 4.9939, lr_0 = 1.1879e-04
Loss = 4.0859e-01, PNorm = 40.6128, GNorm = 6.0671, lr_0 = 1.1765e-04
Loss = 3.8949e-01, PNorm = 40.6202, GNorm = 3.0828, lr_0 = 1.1652e-04
Loss = 3.8298e-01, PNorm = 40.6279, GNorm = 3.4373, lr_0 = 1.1539e-04
Validation cross_entropy = 0.597808
Epoch 28
Loss = 3.3332e-01, PNorm = 40.6364, GNorm = 2.4754, lr_0 = 1.1428e-04
Loss = 3.6944e-01, PNorm = 40.6446, GNorm = 4.0822, lr_0 = 1.1318e-04
Loss = 3.3409e-01, PNorm = 40.6538, GNorm = 1.6146, lr_0 = 1.1209e-04
Loss = 3.6355e-01, PNorm = 40.6633, GNorm = 2.7825, lr_0 = 1.1101e-04
Loss = 3.6266e-01, PNorm = 40.6714, GNorm = 2.6732, lr_0 = 1.0995e-04
Loss = 3.7555e-01, PNorm = 40.6787, GNorm = 1.9037, lr_0 = 1.0889e-04
Loss = 3.4694e-01, PNorm = 40.6864, GNorm = 4.0962, lr_0 = 1.0784e-04
Loss = 3.5517e-01, PNorm = 40.6927, GNorm = 5.7700, lr_0 = 1.0680e-04
Loss = 3.9520e-01, PNorm = 40.7006, GNorm = 3.6999, lr_0 = 1.0577e-04
Validation cross_entropy = 0.600321
Epoch 29
Loss = 3.5732e-01, PNorm = 40.7086, GNorm = 3.6646, lr_0 = 1.0465e-04
Loss = 3.6638e-01, PNorm = 40.7176, GNorm = 4.8250, lr_0 = 1.0364e-04
Loss = 3.5643e-01, PNorm = 40.7261, GNorm = 3.6050, lr_0 = 1.0265e-04
Loss = 3.7203e-01, PNorm = 40.7337, GNorm = 2.0222, lr_0 = 1.0166e-04
Loss = 3.3016e-01, PNorm = 40.7405, GNorm = 2.8711, lr_0 = 1.0068e-04
Loss = 3.5141e-01, PNorm = 40.7478, GNorm = 1.7049, lr_0 = 1.0000e-04
Loss = 3.3775e-01, PNorm = 40.7553, GNorm = 4.5134, lr_0 = 1.0000e-04
Loss = 3.3799e-01, PNorm = 40.7616, GNorm = 4.8646, lr_0 = 1.0000e-04
Validation cross_entropy = 0.644962
Model 0 best validation cross_entropy = 0.591576 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.376514
Ensemble test cross_entropy = 0.376514
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.376514
Overall test cross_entropy = 0.376514 +/- 0.000000
Elapsed time = 0:15:27
Command line
python C:\Users\darkn\PycharmProjects\ChemGPT\chemprop_experiement.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121223__0.1_LUMO_2_equipartition/train.csv',
 'data_weights_path': None,
 'dataset_type': 'multiclass',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'cross_entropy',
 'metrics': ['cross_entropy'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121223__0.1_LUMO_2_equipartition/model_checkpoint',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121223__0.1_LUMO_2_equipartition/train.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': 'out/new_data_gpt/small_molecule_small_dataset/20230705_121223__0.1_LUMO_2_equipartition/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['target'],
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Warning: 55 SMILES are invalid.
Number of tasks = 1
Fold 0
Splitting data with seed 0
Warning: 55 SMILES are invalid.
Warning: 333 SMILES are invalid.
Total size = 4,271 | train size = 4,271 | val size = 38,609 | test size = 4,271
Building model 0
MoleculeModel(
  (multiclass_softmax): Softmax(dim=2)
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 355,803
Moving model to cuda
Epoch 0
Loss = 1.0968e+00, PNorm = 34.0521, GNorm = 0.8543, lr_0 = 1.5824e-04
Loss = 1.0873e+00, PNorm = 34.0543, GNorm = 1.9947, lr_0 = 2.1118e-04
Loss = 1.0737e+00, PNorm = 34.0596, GNorm = 2.2866, lr_0 = 2.6412e-04
Loss = 1.0323e+00, PNorm = 34.0698, GNorm = 1.3907, lr_0 = 3.1706e-04
Loss = 1.0193e+00, PNorm = 34.0853, GNorm = 4.2901, lr_0 = 3.7000e-04
Loss = 9.9169e-01, PNorm = 34.1046, GNorm = 1.4417, lr_0 = 4.2294e-04
Loss = 9.8247e-01, PNorm = 34.1291, GNorm = 1.8332, lr_0 = 4.7588e-04
Loss = 9.5435e-01, PNorm = 34.1621, GNorm = 1.6740, lr_0 = 5.2882e-04
Validation cross_entropy = 0.962391
Epoch 1
Loss = 9.3050e-01, PNorm = 34.2000, GNorm = 1.6393, lr_0 = 5.8706e-04
Loss = 9.1848e-01, PNorm = 34.2433, GNorm = 2.4903, lr_0 = 6.4000e-04
Loss = 9.0231e-01, PNorm = 34.2881, GNorm = 1.0490, lr_0 = 6.9294e-04
Loss = 8.9780e-01, PNorm = 34.3395, GNorm = 2.9428, lr_0 = 7.4588e-04
Loss = 9.3522e-01, PNorm = 34.3788, GNorm = 1.5733, lr_0 = 7.9882e-04
Loss = 8.1829e-01, PNorm = 34.4318, GNorm = 1.2844, lr_0 = 8.5176e-04
Loss = 8.9221e-01, PNorm = 34.4953, GNorm = 4.7048, lr_0 = 9.0471e-04
Loss = 8.4135e-01, PNorm = 34.5634, GNorm = 4.5890, lr_0 = 9.5765e-04
Loss = 8.5662e-01, PNorm = 34.6156, GNorm = 1.8483, lr_0 = 9.9807e-04
Loss = 9.3791e-01, PNorm = 34.6210, GNorm = 6.9966, lr_0 = 9.9710e-04
Validation cross_entropy = 0.823798
Epoch 2
Loss = 8.0057e-01, PNorm = 34.6851, GNorm = 4.2648, lr_0 = 9.8750e-04
Loss = 7.7898e-01, PNorm = 34.7549, GNorm = 1.4021, lr_0 = 9.7799e-04
Loss = 8.9740e-01, PNorm = 34.7980, GNorm = 2.9191, lr_0 = 9.6858e-04
Loss = 7.6322e-01, PNorm = 34.8599, GNorm = 1.8229, lr_0 = 9.5925e-04
Loss = 7.9497e-01, PNorm = 34.9143, GNorm = 0.9016, lr_0 = 9.5002e-04
Loss = 7.7904e-01, PNorm = 34.9704, GNorm = 3.7362, lr_0 = 9.4087e-04
Loss = 7.4136e-01, PNorm = 35.0256, GNorm = 4.2311, lr_0 = 9.3181e-04
Loss = 7.8438e-01, PNorm = 35.0685, GNorm = 2.4252, lr_0 = 9.2284e-04
Validation cross_entropy = 0.767460
Epoch 3
Loss = 6.8754e-01, PNorm = 35.1251, GNorm = 1.0132, lr_0 = 9.1395e-04
Loss = 7.3811e-01, PNorm = 35.1753, GNorm = 1.7091, lr_0 = 9.0515e-04
Loss = 7.1301e-01, PNorm = 35.2312, GNorm = 2.8171, lr_0 = 8.9644e-04
Loss = 7.2423e-01, PNorm = 35.2771, GNorm = 2.4492, lr_0 = 8.8781e-04
Loss = 7.8252e-01, PNorm = 35.3114, GNorm = 0.9731, lr_0 = 8.7926e-04
Loss = 7.3036e-01, PNorm = 35.3604, GNorm = 1.5401, lr_0 = 8.7080e-04
Loss = 7.3310e-01, PNorm = 35.4101, GNorm = 1.6930, lr_0 = 8.6241e-04
Loss = 6.8017e-01, PNorm = 35.4728, GNorm = 0.8161, lr_0 = 8.5411e-04
Loss = 7.4783e-01, PNorm = 35.5290, GNorm = 3.1217, lr_0 = 8.4588e-04
Validation cross_entropy = 0.698690
Epoch 4
Loss = 7.0820e-01, PNorm = 35.5814, GNorm = 1.7294, lr_0 = 8.3693e-04
Loss = 7.1161e-01, PNorm = 35.6234, GNorm = 1.7872, lr_0 = 8.2887e-04
Loss = 6.9200e-01, PNorm = 35.6630, GNorm = 3.5172, lr_0 = 8.2089e-04
Loss = 6.8865e-01, PNorm = 35.7109, GNorm = 2.2650, lr_0 = 8.1299e-04
Loss = 6.9460e-01, PNorm = 35.7529, GNorm = 1.5664, lr_0 = 8.0516e-04
Loss = 6.9079e-01, PNorm = 35.7936, GNorm = 3.5518, lr_0 = 7.9741e-04
Loss = 6.3407e-01, PNorm = 35.8318, GNorm = 0.8152, lr_0 = 7.8973e-04
Loss = 6.3417e-01, PNorm = 35.8770, GNorm = 1.1186, lr_0 = 7.8213e-04
Validation cross_entropy = 0.670002
Epoch 5
Loss = 5.8315e-01, PNorm = 35.9312, GNorm = 4.8960, lr_0 = 7.7460e-04
Loss = 7.5425e-01, PNorm = 35.9776, GNorm = 2.8516, lr_0 = 7.6714e-04
Loss = 6.5194e-01, PNorm = 36.0152, GNorm = 3.9380, lr_0 = 7.5975e-04
Loss = 6.4628e-01, PNorm = 36.0564, GNorm = 1.3217, lr_0 = 7.5244e-04
Loss = 7.0685e-01, PNorm = 36.0953, GNorm = 4.6665, lr_0 = 7.4519e-04
Loss = 6.5296e-01, PNorm = 36.1263, GNorm = 0.8182, lr_0 = 7.3802e-04
Loss = 6.4972e-01, PNorm = 36.1600, GNorm = 1.3480, lr_0 = 7.3091e-04
Loss = 6.6438e-01, PNorm = 36.1993, GNorm = 4.2530, lr_0 = 7.2388e-04
Loss = 6.3290e-01, PNorm = 36.2458, GNorm = 3.3785, lr_0 = 7.1691e-04
Validation cross_entropy = 0.676053
Epoch 6
Loss = 5.9452e-01, PNorm = 36.3016, GNorm = 2.1660, lr_0 = 7.0932e-04
Loss = 6.6472e-01, PNorm = 36.3463, GNorm = 4.2982, lr_0 = 7.0249e-04
Loss = 6.1846e-01, PNorm = 36.3907, GNorm = 1.1142, lr_0 = 6.9572e-04
Loss = 5.9219e-01, PNorm = 36.4401, GNorm = 2.5499, lr_0 = 6.8903e-04
Loss = 6.4049e-01, PNorm = 36.4729, GNorm = 4.7036, lr_0 = 6.8239e-04
Loss = 7.0452e-01, PNorm = 36.5033, GNorm = 4.7640, lr_0 = 6.7582e-04
Loss = 6.4026e-01, PNorm = 36.5458, GNorm = 0.9208, lr_0 = 6.6931e-04
Loss = 6.5192e-01, PNorm = 36.5777, GNorm = 2.9242, lr_0 = 6.6287e-04
Validation cross_entropy = 0.684467
Epoch 7
Loss = 6.6567e-01, PNorm = 36.6176, GNorm = 1.9865, lr_0 = 6.5585e-04
Loss = 6.1182e-01, PNorm = 36.6559, GNorm = 1.8529, lr_0 = 6.4954e-04
Loss = 6.3064e-01, PNorm = 36.6948, GNorm = 2.5673, lr_0 = 6.4328e-04
Loss = 6.8515e-01, PNorm = 36.7362, GNorm = 2.4560, lr_0 = 6.3709e-04
Loss = 6.1310e-01, PNorm = 36.7781, GNorm = 1.0142, lr_0 = 6.3096e-04
Loss = 6.4670e-01, PNorm = 36.8153, GNorm = 3.1819, lr_0 = 6.2488e-04
Loss = 6.4045e-01, PNorm = 36.8526, GNorm = 3.8233, lr_0 = 6.1887e-04
Loss = 5.9065e-01, PNorm = 36.8917, GNorm = 6.6213, lr_0 = 6.1291e-04
Loss = 6.2191e-01, PNorm = 36.9232, GNorm = 1.5960, lr_0 = 6.0701e-04
Validation cross_entropy = 0.637184
Epoch 8
Loss = 6.3001e-01, PNorm = 36.9620, GNorm = 2.4082, lr_0 = 6.0116e-04
Loss = 5.7446e-01, PNorm = 37.0009, GNorm = 2.4402, lr_0 = 5.9537e-04
Loss = 5.9340e-01, PNorm = 37.0333, GNorm = 1.4687, lr_0 = 5.8964e-04
Loss = 6.0959e-01, PNorm = 37.0626, GNorm = 3.4815, lr_0 = 5.8396e-04
Loss = 5.8067e-01, PNorm = 37.0949, GNorm = 1.1275, lr_0 = 5.7834e-04
Loss = 5.9780e-01, PNorm = 37.1302, GNorm = 2.4885, lr_0 = 5.7277e-04
Loss = 5.3991e-01, PNorm = 37.1567, GNorm = 1.2565, lr_0 = 5.6726e-04
Loss = 5.9000e-01, PNorm = 37.1772, GNorm = 3.8794, lr_0 = 5.6180e-04
Validation cross_entropy = 0.638795
Epoch 9
Loss = 5.6940e-01, PNorm = 37.2115, GNorm = 1.7274, lr_0 = 5.5585e-04
Loss = 5.8541e-01, PNorm = 37.2427, GNorm = 1.6788, lr_0 = 5.5050e-04
Loss = 5.7795e-01, PNorm = 37.2782, GNorm = 2.2417, lr_0 = 5.4520e-04
Loss = 5.4546e-01, PNorm = 37.3139, GNorm = 4.3781, lr_0 = 5.3995e-04
Loss = 5.2884e-01, PNorm = 37.3474, GNorm = 2.3542, lr_0 = 5.3475e-04
Loss = 5.2436e-01, PNorm = 37.3785, GNorm = 5.7250, lr_0 = 5.2960e-04
Loss = 5.8899e-01, PNorm = 37.4164, GNorm = 7.2576, lr_0 = 5.2450e-04
Loss = 6.4942e-01, PNorm = 37.4462, GNorm = 4.1701, lr_0 = 5.1945e-04
Loss = 5.7356e-01, PNorm = 37.4797, GNorm = 3.9639, lr_0 = 5.1445e-04
Validation cross_entropy = 0.605350
Epoch 10
Loss = 5.3244e-01, PNorm = 37.5149, GNorm = 3.3213, lr_0 = 5.0950e-04
Loss = 5.7473e-01, PNorm = 37.5432, GNorm = 1.2095, lr_0 = 5.0459e-04
Loss = 5.7719e-01, PNorm = 37.5803, GNorm = 1.6229, lr_0 = 4.9973e-04
Loss = 5.4271e-01, PNorm = 37.6196, GNorm = 2.5587, lr_0 = 4.9492e-04
Loss = 5.6243e-01, PNorm = 37.6487, GNorm = 3.6265, lr_0 = 4.9016e-04
Loss = 5.5004e-01, PNorm = 37.6849, GNorm = 2.6787, lr_0 = 4.8544e-04
Loss = 4.7786e-01, PNorm = 37.7198, GNorm = 1.5169, lr_0 = 4.8076e-04
Loss = 5.6751e-01, PNorm = 37.7479, GNorm = 1.6970, lr_0 = 4.7614e-04
Validation cross_entropy = 0.632449
Epoch 11
Loss = 4.9246e-01, PNorm = 37.7815, GNorm = 1.5893, lr_0 = 4.7110e-04
Loss = 5.5182e-01, PNorm = 37.8135, GNorm = 2.2155, lr_0 = 4.6656e-04
Loss = 5.1471e-01, PNorm = 37.8492, GNorm = 2.8120, lr_0 = 4.6207e-04
Loss = 6.3472e-01, PNorm = 37.8793, GNorm = 2.7174, lr_0 = 4.5762e-04
Loss = 5.5921e-01, PNorm = 37.9078, GNorm = 1.1250, lr_0 = 4.5321e-04
Loss = 5.0170e-01, PNorm = 37.9406, GNorm = 3.4121, lr_0 = 4.4885e-04
Loss = 5.7029e-01, PNorm = 37.9708, GNorm = 5.5415, lr_0 = 4.4453e-04
Loss = 5.3569e-01, PNorm = 37.9955, GNorm = 4.3150, lr_0 = 4.4025e-04
Loss = 5.5549e-01, PNorm = 38.0208, GNorm = 3.1312, lr_0 = 4.3601e-04
Validation cross_entropy = 0.602758
Epoch 12
Loss = 5.3615e-01, PNorm = 38.0490, GNorm = 4.4256, lr_0 = 4.3181e-04
Loss = 5.0349e-01, PNorm = 38.0819, GNorm = 3.1093, lr_0 = 4.2765e-04
Loss = 5.3783e-01, PNorm = 38.1114, GNorm = 5.5078, lr_0 = 4.2354e-04
Loss = 5.4900e-01, PNorm = 38.1374, GNorm = 7.2331, lr_0 = 4.1946e-04
Loss = 5.1735e-01, PNorm = 38.1712, GNorm = 2.4511, lr_0 = 4.1542e-04
Loss = 4.9100e-01, PNorm = 38.2002, GNorm = 1.6666, lr_0 = 4.1142e-04
Loss = 5.3934e-01, PNorm = 38.2302, GNorm = 3.4255, lr_0 = 4.0746e-04
Loss = 5.1868e-01, PNorm = 38.2612, GNorm = 2.2760, lr_0 = 4.0354e-04
Loss = 5.0145e-01, PNorm = 38.2829, GNorm = 1.4515, lr_0 = 3.9965e-04
Loss = 5.8980e-01, PNorm = 38.2849, GNorm = 5.4509, lr_0 = 3.9926e-04
Validation cross_entropy = 0.601118
Epoch 13
Loss = 5.4554e-01, PNorm = 38.3087, GNorm = 5.7427, lr_0 = 3.9542e-04
Loss = 4.7340e-01, PNorm = 38.3386, GNorm = 3.1337, lr_0 = 3.9161e-04
Loss = 4.9274e-01, PNorm = 38.3617, GNorm = 1.3235, lr_0 = 3.8784e-04
Loss = 5.1808e-01, PNorm = 38.3816, GNorm = 1.4822, lr_0 = 3.8411e-04
Loss = 5.5578e-01, PNorm = 38.4093, GNorm = 2.6011, lr_0 = 3.8041e-04
Loss = 4.7226e-01, PNorm = 38.4365, GNorm = 1.8503, lr_0 = 3.7675e-04
Loss = 4.9777e-01, PNorm = 38.4593, GNorm = 1.5340, lr_0 = 3.7312e-04
Loss = 4.8338e-01, PNorm = 38.4876, GNorm = 1.2382, lr_0 = 3.6953e-04
Validation cross_entropy = 0.650205
Epoch 14
Loss = 4.7202e-01, PNorm = 38.5200, GNorm = 3.0961, lr_0 = 3.6562e-04
Loss = 4.5992e-01, PNorm = 38.5489, GNorm = 1.9872, lr_0 = 3.6210e-04
Loss = 4.6188e-01, PNorm = 38.5776, GNorm = 2.2163, lr_0 = 3.5861e-04
Loss = 4.5786e-01, PNorm = 38.6064, GNorm = 5.1213, lr_0 = 3.5516e-04
Loss = 5.1137e-01, PNorm = 38.6313, GNorm = 1.3703, lr_0 = 3.5174e-04
Loss = 4.7678e-01, PNorm = 38.6564, GNorm = 2.0693, lr_0 = 3.4835e-04
Loss = 5.3762e-01, PNorm = 38.6815, GNorm = 3.4640, lr_0 = 3.4500e-04
Loss = 5.2401e-01, PNorm = 38.6979, GNorm = 1.5831, lr_0 = 3.4168e-04
Loss = 4.7064e-01, PNorm = 38.7198, GNorm = 2.1062, lr_0 = 3.3839e-04
Validation cross_entropy = 0.598074
Epoch 15
Loss = 4.4249e-01, PNorm = 38.7467, GNorm = 1.7810, lr_0 = 3.3513e-04
Loss = 4.6866e-01, PNorm = 38.7741, GNorm = 1.9451, lr_0 = 3.3190e-04
Loss = 4.7569e-01, PNorm = 38.8004, GNorm = 2.5369, lr_0 = 3.2871e-04
Loss = 5.0733e-01, PNorm = 38.8231, GNorm = 1.7743, lr_0 = 3.2554e-04
Loss = 4.8597e-01, PNorm = 38.8507, GNorm = 1.8028, lr_0 = 3.2241e-04
Loss = 4.2767e-01, PNorm = 38.8734, GNorm = 1.6836, lr_0 = 3.1930e-04
Loss = 4.5986e-01, PNorm = 38.9004, GNorm = 1.7388, lr_0 = 3.1623e-04
Loss = 5.0568e-01, PNorm = 38.9222, GNorm = 2.5336, lr_0 = 3.1318e-04
Validation cross_entropy = 0.593465
Epoch 16
Loss = 4.7019e-01, PNorm = 38.9404, GNorm = 3.5660, lr_0 = 3.0987e-04
Loss = 4.2471e-01, PNorm = 38.9600, GNorm = 1.2270, lr_0 = 3.0688e-04
Loss = 4.7324e-01, PNorm = 38.9829, GNorm = 4.2964, lr_0 = 3.0393e-04
Loss = 4.8726e-01, PNorm = 39.0064, GNorm = 2.3447, lr_0 = 3.0100e-04
Loss = 5.0182e-01, PNorm = 39.0281, GNorm = 1.6802, lr_0 = 2.9811e-04
Loss = 4.4919e-01, PNorm = 39.0525, GNorm = 6.4579, lr_0 = 2.9524e-04
Loss = 4.6156e-01, PNorm = 39.0773, GNorm = 9.2026, lr_0 = 2.9239e-04
Loss = 4.4793e-01, PNorm = 39.0982, GNorm = 2.9122, lr_0 = 2.8958e-04
Loss = 5.1349e-01, PNorm = 39.1179, GNorm = 2.8211, lr_0 = 2.8679e-04
Validation cross_entropy = 0.634609
Epoch 17
Loss = 5.0853e-01, PNorm = 39.1383, GNorm = 2.4195, lr_0 = 2.8403e-04
Loss = 4.3039e-01, PNorm = 39.1594, GNorm = 2.5606, lr_0 = 2.8129e-04
Loss = 4.7079e-01, PNorm = 39.1777, GNorm = 2.2103, lr_0 = 2.7859e-04
Loss = 4.3455e-01, PNorm = 39.1974, GNorm = 3.0134, lr_0 = 2.7590e-04
Loss = 4.3942e-01, PNorm = 39.2214, GNorm = 5.4909, lr_0 = 2.7325e-04
Loss = 4.8412e-01, PNorm = 39.2430, GNorm = 7.3831, lr_0 = 2.7062e-04
Loss = 4.2759e-01, PNorm = 39.2651, GNorm = 2.7460, lr_0 = 2.6801e-04
Loss = 4.6559e-01, PNorm = 39.2828, GNorm = 1.5558, lr_0 = 2.6543e-04
Validation cross_entropy = 0.593454
Epoch 18
Loss = 3.8804e-01, PNorm = 39.3030, GNorm = 4.4376, lr_0 = 2.6262e-04
Loss = 4.3052e-01, PNorm = 39.3241, GNorm = 5.6239, lr_0 = 2.6009e-04
Loss = 4.0328e-01, PNorm = 39.3446, GNorm = 1.3578, lr_0 = 2.5759e-04
Loss = 4.0048e-01, PNorm = 39.3645, GNorm = 3.4147, lr_0 = 2.5511e-04
Loss = 4.3489e-01, PNorm = 39.3828, GNorm = 2.1637, lr_0 = 2.5265e-04
Loss = 4.7516e-01, PNorm = 39.3993, GNorm = 3.1123, lr_0 = 2.5022e-04
Loss = 4.3832e-01, PNorm = 39.4153, GNorm = 2.8566, lr_0 = 2.4781e-04
Loss = 4.2893e-01, PNorm = 39.4340, GNorm = 1.9407, lr_0 = 2.4542e-04
Loss = 4.3716e-01, PNorm = 39.4529, GNorm = 2.0863, lr_0 = 2.4306e-04
Validation cross_entropy = 0.610056
Epoch 19
Loss = 4.3985e-01, PNorm = 39.4721, GNorm = 3.8767, lr_0 = 2.4049e-04
Loss = 4.2776e-01, PNorm = 39.4926, GNorm = 2.4384, lr_0 = 2.3817e-04
Loss = 4.4795e-01, PNorm = 39.5118, GNorm = 3.2030, lr_0 = 2.3588e-04
Loss = 4.0213e-01, PNorm = 39.5303, GNorm = 3.3087, lr_0 = 2.3361e-04
Loss = 3.9888e-01, PNorm = 39.5473, GNorm = 2.6252, lr_0 = 2.3136e-04
Loss = 4.3910e-01, PNorm = 39.5619, GNorm = 5.5545, lr_0 = 2.2913e-04
Loss = 3.9862e-01, PNorm = 39.5773, GNorm = 2.5968, lr_0 = 2.2693e-04
Loss = 4.1611e-01, PNorm = 39.5936, GNorm = 2.8006, lr_0 = 2.2474e-04
Validation cross_entropy = 0.635116
Epoch 20
Loss = 4.1916e-01, PNorm = 39.6105, GNorm = 1.5392, lr_0 = 2.2258e-04
Loss = 3.8780e-01, PNorm = 39.6278, GNorm = 1.7275, lr_0 = 2.2043e-04
Loss = 4.3425e-01, PNorm = 39.6456, GNorm = 2.7056, lr_0 = 2.1831e-04
Loss = 4.2806e-01, PNorm = 39.6616, GNorm = 1.6972, lr_0 = 2.1621e-04
Loss = 4.3786e-01, PNorm = 39.6772, GNorm = 5.9197, lr_0 = 2.1413e-04
Loss = 3.8751e-01, PNorm = 39.6933, GNorm = 2.2624, lr_0 = 2.1207e-04
Loss = 4.0695e-01, PNorm = 39.7075, GNorm = 4.1197, lr_0 = 2.1002e-04
Loss = 4.2120e-01, PNorm = 39.7236, GNorm = 1.5995, lr_0 = 2.0800e-04
Loss = 4.2913e-01, PNorm = 39.7426, GNorm = 2.1975, lr_0 = 2.0600e-04
Validation cross_entropy = 0.592681
Epoch 21
Loss = 4.0254e-01, PNorm = 39.7607, GNorm = 3.4510, lr_0 = 2.0382e-04
Loss = 3.7442e-01, PNorm = 39.7746, GNorm = 1.8107, lr_0 = 2.0186e-04
Loss = 3.9633e-01, PNorm = 39.7915, GNorm = 3.0551, lr_0 = 1.9991e-04
Loss = 4.0561e-01, PNorm = 39.8071, GNorm = 3.2076, lr_0 = 1.9799e-04
Loss = 3.9321e-01, PNorm = 39.8220, GNorm = 2.0912, lr_0 = 1.9608e-04
Loss = 3.7917e-01, PNorm = 39.8358, GNorm = 6.7036, lr_0 = 1.9419e-04
Loss = 4.5964e-01, PNorm = 39.8531, GNorm = 3.2862, lr_0 = 1.9232e-04
Loss = 4.0403e-01, PNorm = 39.8688, GNorm = 1.2948, lr_0 = 1.9047e-04
Validation cross_entropy = 0.602940
Epoch 22
Loss = 3.0787e-01, PNorm = 39.8842, GNorm = 1.6404, lr_0 = 1.8864e-04
Loss = 3.8763e-01, PNorm = 39.8987, GNorm = 6.7887, lr_0 = 1.8682e-04
Loss = 4.0193e-01, PNorm = 39.9115, GNorm = 2.7585, lr_0 = 1.8502e-04
Loss = 4.0621e-01, PNorm = 39.9245, GNorm = 2.9749, lr_0 = 1.8324e-04
Loss = 3.5564e-01, PNorm = 39.9387, GNorm = 2.6964, lr_0 = 1.8148e-04
Loss = 4.0098e-01, PNorm = 39.9539, GNorm = 1.4969, lr_0 = 1.7973e-04
Loss = 4.4587e-01, PNorm = 39.9661, GNorm = 2.6340, lr_0 = 1.7800e-04
Loss = 4.1266e-01, PNorm = 39.9807, GNorm = 2.4236, lr_0 = 1.7629e-04
Loss = 3.6298e-01, PNorm = 39.9956, GNorm = 2.6627, lr_0 = 1.7459e-04
Validation cross_entropy = 0.602112
Epoch 23
Loss = 3.9940e-01, PNorm = 40.0119, GNorm = 2.1388, lr_0 = 1.7274e-04
Loss = 3.8082e-01, PNorm = 40.0265, GNorm = 4.0052, lr_0 = 1.7108e-04
Loss = 4.1270e-01, PNorm = 40.0398, GNorm = 2.2817, lr_0 = 1.6943e-04
Loss = 3.8900e-01, PNorm = 40.0541, GNorm = 2.2425, lr_0 = 1.6780e-04
Loss = 4.1114e-01, PNorm = 40.0667, GNorm = 4.3621, lr_0 = 1.6618e-04
Loss = 3.2868e-01, PNorm = 40.0785, GNorm = 2.2507, lr_0 = 1.6458e-04
Loss = 3.6364e-01, PNorm = 40.0905, GNorm = 2.6556, lr_0 = 1.6300e-04
Loss = 3.6878e-01, PNorm = 40.1000, GNorm = 1.7492, lr_0 = 1.6143e-04
Loss = 3.4539e-01, PNorm = 40.1104, GNorm = 2.9589, lr_0 = 1.5988e-04
Validation cross_entropy = 0.625840
Epoch 24
Loss = 3.5917e-01, PNorm = 40.1227, GNorm = 1.7170, lr_0 = 1.5834e-04
Loss = 3.4789e-01, PNorm = 40.1346, GNorm = 2.6777, lr_0 = 1.5681e-04
Loss = 4.2195e-01, PNorm = 40.1455, GNorm = 6.2047, lr_0 = 1.5530e-04
Loss = 3.4142e-01, PNorm = 40.1572, GNorm = 1.3926, lr_0 = 1.5381e-04
Loss = 3.9455e-01, PNorm = 40.1714, GNorm = 4.0753, lr_0 = 1.5233e-04
Loss = 3.6686e-01, PNorm = 40.1846, GNorm = 3.3470, lr_0 = 1.5086e-04
Loss = 3.6619e-01, PNorm = 40.1954, GNorm = 2.4641, lr_0 = 1.4941e-04
Loss = 3.7535e-01, PNorm = 40.2069, GNorm = 4.9461, lr_0 = 1.4797e-04
Validation cross_entropy = 0.609544
Epoch 25
Loss = 3.7118e-01, PNorm = 40.2201, GNorm = 1.9730, lr_0 = 1.4640e-04
Loss = 3.5681e-01, PNorm = 40.2303, GNorm = 4.1050, lr_0 = 1.4499e-04
Loss = 3.8281e-01, PNorm = 40.2402, GNorm = 3.1664, lr_0 = 1.4360e-04
Loss = 3.7968e-01, PNorm = 40.2514, GNorm = 2.4631, lr_0 = 1.4221e-04
Loss = 3.4435e-01, PNorm = 40.2637, GNorm = 2.5921, lr_0 = 1.4084e-04
Loss = 3.5174e-01, PNorm = 40.2745, GNorm = 8.6450, lr_0 = 1.3949e-04
Loss = 3.9056e-01, PNorm = 40.2843, GNorm = 4.4809, lr_0 = 1.3815e-04
Loss = 4.3364e-01, PNorm = 40.2939, GNorm = 3.1269, lr_0 = 1.3682e-04
Loss = 3.2374e-01, PNorm = 40.3036, GNorm = 9.5978, lr_0 = 1.3550e-04
Loss = 3.5556e-01, PNorm = 40.3046, GNorm = 3.4347, lr_0 = 1.3537e-04
Validation cross_entropy = 0.618551
Epoch 26
Loss = 3.6749e-01, PNorm = 40.3136, GNorm = 5.8814, lr_0 = 1.3406e-04
Loss = 3.8379e-01, PNorm = 40.3232, GNorm = 3.1841, lr_0 = 1.3277e-04
Loss = 3.5343e-01, PNorm = 40.3331, GNorm = 2.9348, lr_0 = 1.3149e-04
Loss = 3.5180e-01, PNorm = 40.3437, GNorm = 2.5718, lr_0 = 1.3023e-04
Loss = 3.6783e-01, PNorm = 40.3556, GNorm = 5.7399, lr_0 = 1.2897e-04
Loss = 3.4019e-01, PNorm = 40.3655, GNorm = 2.4555, lr_0 = 1.2773e-04
Loss = 3.7531e-01, PNorm = 40.3747, GNorm = 2.8270, lr_0 = 1.2650e-04
Loss = 3.7763e-01, PNorm = 40.3827, GNorm = 2.0805, lr_0 = 1.2529e-04
Validation cross_entropy = 0.635721
Epoch 27
Loss = 3.4527e-01, PNorm = 40.3913, GNorm = 2.1900, lr_0 = 1.2408e-04
Loss = 3.8120e-01, PNorm = 40.4007, GNorm = 3.7045, lr_0 = 1.2288e-04
Loss = 3.4883e-01, PNorm = 40.4105, GNorm = 3.2158, lr_0 = 1.2170e-04
Loss = 3.6321e-01, PNorm = 40.4212, GNorm = 1.5915, lr_0 = 1.2053e-04
Loss = 3.4816e-01, PNorm = 40.4310, GNorm = 2.0180, lr_0 = 1.1937e-04
Loss = 3.5541e-01, PNorm = 40.4401, GNorm = 2.6436, lr_0 = 1.1822e-04
Loss = 3.6763e-01, PNorm = 40.4487, GNorm = 3.8888, lr_0 = 1.1708e-04
Loss = 3.1319e-01, PNorm = 40.4576, GNorm = 3.9232, lr_0 = 1.1595e-04
Loss = 3.5461e-01, PNorm = 40.4658, GNorm = 4.1234, lr_0 = 1.1484e-04
Validation cross_entropy = 0.626846
Epoch 28
Loss = 3.3056e-01, PNorm = 40.4743, GNorm = 2.2155, lr_0 = 1.1362e-04
Loss = 3.5090e-01, PNorm = 40.4823, GNorm = 5.2140, lr_0 = 1.1253e-04
Loss = 3.1722e-01, PNorm = 40.4901, GNorm = 4.6394, lr_0 = 1.1144e-04
Loss = 3.6139e-01, PNorm = 40.4988, GNorm = 2.9858, lr_0 = 1.1037e-04
Loss = 3.1573e-01, PNorm = 40.5080, GNorm = 3.8211, lr_0 = 1.0931e-04
Loss = 3.4500e-01, PNorm = 40.5174, GNorm = 3.5570, lr_0 = 1.0826e-04
Loss = 3.4399e-01, PNorm = 40.5254, GNorm = 2.9196, lr_0 = 1.0721e-04
Loss = 3.3373e-01, PNorm = 40.5334, GNorm = 3.6371, lr_0 = 1.0618e-04
Validation cross_entropy = 0.616409
Epoch 29
Loss = 3.8445e-01, PNorm = 40.5413, GNorm = 3.6762, lr_0 = 1.0516e-04
Loss = 3.4382e-01, PNorm = 40.5487, GNorm = 2.1598, lr_0 = 1.0415e-04
Loss = 3.5977e-01, PNorm = 40.5565, GNorm = 3.2579, lr_0 = 1.0314e-04
Loss = 3.6743e-01, PNorm = 40.5634, GNorm = 6.8256, lr_0 = 1.0215e-04
Loss = 3.2173e-01, PNorm = 40.5707, GNorm = 2.0621, lr_0 = 1.0117e-04
Loss = 3.2780e-01, PNorm = 40.5786, GNorm = 3.9084, lr_0 = 1.0019e-04
Loss = 3.2029e-01, PNorm = 40.5873, GNorm = 2.0172, lr_0 = 1.0000e-04
Loss = 3.3800e-01, PNorm = 40.5946, GNorm = 3.9225, lr_0 = 1.0000e-04
Loss = 3.2150e-01, PNorm = 40.6024, GNorm = 4.3010, lr_0 = 1.0000e-04
Validation cross_entropy = 0.623353
Model 0 best validation cross_entropy = 0.592681 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test cross_entropy = 0.388563
Ensemble test cross_entropy = 0.388563
1-fold cross validation
	Seed 0 ==> test cross_entropy = 0.388563
Overall test cross_entropy = 0.388563 +/- 0.000000
Elapsed time = 0:14:53
